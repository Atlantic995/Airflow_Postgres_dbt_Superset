[0m13:26:45.975917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e181b5d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e181c76b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e18203cb00>]}


============================== 13:26:46.002165 | 908e3b5f-cfa6-41d9-bd10-9060c6ad6fd4 ==============================
[0m13:26:46.002165 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:26:46.004618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:26:46.175838 [info ] [MainThread]: dbt version: 1.9.0
[0m13:26:46.176944 [info ] [MainThread]: python version: 3.12.4
[0m13:26:46.178491 [info ] [MainThread]: python path: /usr/local/bin/python
[0m13:26:46.180291 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m13:26:46.181690 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m13:26:46.183870 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m13:26:46.185831 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m13:26:46.724154 [info ] [MainThread]: Configuration:
[0m13:26:46.726318 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m13:26:46.740219 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:26:46.742189 [info ] [MainThread]: Required dependencies:
[0m13:26:46.744160 [debug] [MainThread]: Executing "git --help"
[0m13:26:46.818223 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:26:46.820256 [debug] [MainThread]: STDERR: "b''"
[0m13:26:46.822082 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:26:46.825118 [info ] [MainThread]: Connection test skipped since no profile was found
[0m13:26:46.835783 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:26:46.837689 [info ] [MainThread]: dbt looked for a profiles.yml file in /root/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m13:26:46.847738 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 1.0826875, "process_in_blocks": "39464", "process_kernel_time": 1.870072, "process_mem_max_rss": "88148", "process_out_blocks": "1480", "process_user_time": 5.09566}
[0m13:26:46.849952 [debug] [MainThread]: Command `dbt debug` failed at 13:26:46.849468 after 1.09 seconds
[0m13:26:46.851612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e18197f6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e18190ee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78e18205fa10>]}
[0m13:26:46.859930 [debug] [MainThread]: Flushing usage events
[0m13:26:47.729491 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:31:10.845299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdacd56ab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdacdad75c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdacd569c70>]}


============================== 13:31:10.861223 | 77c90a32-82ef-4cbb-a340-3a05763a3108 ==============================
[0m13:31:10.861223 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:31:10.863208 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:31:10.917578 [info ] [MainThread]: dbt version: 1.9.0
[0m13:31:10.918792 [info ] [MainThread]: python version: 3.12.4
[0m13:31:10.920348 [info ] [MainThread]: python path: /usr/local/bin/python
[0m13:31:10.922871 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m13:31:10.925591 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m13:31:10.928097 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m13:31:10.929459 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m13:31:11.337357 [info ] [MainThread]: Configuration:
[0m13:31:11.339509 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m13:31:11.341296 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:31:11.342894 [info ] [MainThread]: Required dependencies:
[0m13:31:11.349696 [debug] [MainThread]: Executing "git --help"
[0m13:31:11.384926 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:31:11.392883 [debug] [MainThread]: STDERR: "b''"
[0m13:31:11.394855 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:31:11.396991 [info ] [MainThread]: Connection test skipped since no profile was found
[0m13:31:11.405375 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:31:11.418245 [info ] [MainThread]: dbt looked for a profiles.yml file in /root/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m13:31:11.429741 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.94188416, "process_in_blocks": "7592", "process_kernel_time": 1.373911, "process_mem_max_rss": "87320", "process_out_blocks": "16", "process_user_time": 4.039822}
[0m13:31:11.436327 [debug] [MainThread]: Command `dbt debug` failed at 13:31:11.435525 after 0.95 seconds
[0m13:31:11.438474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdacd2b8c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdacd0ab110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cdacedff110>]}
[0m13:31:11.441146 [debug] [MainThread]: Flushing usage events
[0m13:31:12.263855 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:31:44.500091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b954a855df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b954aa92b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b954a857cb0>]}


============================== 13:31:44.518807 | 9f526d1b-84b5-4a51-beac-03e1023ca98d ==============================
[0m13:31:44.518807 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:31:44.520698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:31:44.643677 [info ] [MainThread]: dbt version: 1.9.0
[0m13:31:44.646225 [info ] [MainThread]: python version: 3.12.4
[0m13:31:44.648788 [info ] [MainThread]: python path: /usr/local/bin/python
[0m13:31:44.650964 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m13:31:44.661881 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m13:31:44.665431 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m13:31:44.667697 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m13:31:45.911284 [info ] [MainThread]: Configuration:
[0m13:31:45.925933 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m13:31:45.931601 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:31:45.943567 [info ] [MainThread]: Required dependencies:
[0m13:31:45.945797 [debug] [MainThread]: Executing "git --help"
[0m13:31:45.971350 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:31:45.974209 [debug] [MainThread]: STDERR: "b''"
[0m13:31:45.977590 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:31:45.989159 [info ] [MainThread]: Connection test skipped since no profile was found
[0m13:31:45.991438 [info ] [MainThread]: [31m1 check failed:[0m
[0m13:31:45.994181 [info ] [MainThread]: dbt looked for a profiles.yml file in /root/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m13:31:46.011195 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 1.6416962, "process_in_blocks": "56", "process_kernel_time": 1.028793, "process_mem_max_rss": "88276", "process_out_blocks": "1472", "process_user_time": 5.087023}
[0m13:31:46.014360 [debug] [MainThread]: Command `dbt debug` failed at 13:31:46.013498 after 1.65 seconds
[0m13:31:46.017956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b954b824680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b954c20f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b954a200590>]}
[0m13:31:46.021069 [debug] [MainThread]: Flushing usage events
[0m13:31:46.917043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:33:46.008372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f796538a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f796538a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f797229a60>]}


============================== 13:33:46.024553 | 3854942d-e056-435f-9c16-441fc972fa71 ==============================
[0m13:33:46.024553 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:33:46.026041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init my_project', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:33:46.133734 [warn ] [MainThread]: [ConfigFolderDirectory]: Unable to parse logging event dictionary. Failed to parse dir field: expected string or bytes-like object, got 'PosixPath'.. Dictionary: {'dir': PosixPath('/root/.dbt')}
[0m13:33:46.134824 [info ] [MainThread]: Creating dbt configuration folder at 
[0m13:33:46.142752 [info ] [MainThread]: Setting up your profile.
[0m13:34:30.796625 [info ] [MainThread]: Profile my_project written to /root/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m13:34:30.800251 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 49.304108, "process_in_blocks": "9968", "process_kernel_time": 0.977145, "process_mem_max_rss": "92144", "process_out_blocks": "1488", "process_user_time": 3.042056}
[0m13:34:30.802385 [debug] [MainThread]: Command `dbt init` succeeded at 13:34:30.801990 after 49.31 seconds
[0m13:34:30.803884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f796f1ce00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f796277a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78f796754ef0>]}
[0m13:34:30.805376 [debug] [MainThread]: Flushing usage events
[0m13:34:31.624831 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:49:47.313600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21ba925970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21ba7ad520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21bc245cd0>]}


============================== 13:49:47.392772 | 82cd6a51-4c57-4291-84db-fb3ad6492c8e ==============================
[0m13:49:47.392772 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:49:47.400986 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:49:47.661792 [info ] [MainThread]: dbt version: 1.9.0
[0m13:49:47.663710 [info ] [MainThread]: python version: 3.12.4
[0m13:49:47.665270 [info ] [MainThread]: python path: /usr/local/bin/python
[0m13:49:47.666790 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.31
[0m13:49:48.429578 [info ] [MainThread]: Using profiles dir at /root/.dbt
[0m13:49:48.433024 [info ] [MainThread]: Using profiles.yml file at /root/.dbt/profiles.yml
[0m13:49:48.436492 [info ] [MainThread]: Using dbt_project.yml file at /usr/app/dbt_project.yml
[0m13:49:48.464689 [info ] [MainThread]: adapter type: postgres
[0m13:49:48.467169 [info ] [MainThread]: adapter version: 1.9.0
[0m13:49:50.497045 [info ] [MainThread]: Configuration:
[0m13:49:50.505049 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:49:50.508925 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:49:50.516471 [info ] [MainThread]: Required dependencies:
[0m13:49:50.524261 [debug] [MainThread]: Executing "git --help"
[0m13:49:50.740417 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:49:50.743615 [debug] [MainThread]: STDERR: "b''"
[0m13:49:50.745425 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:49:50.747401 [info ] [MainThread]: Connection:
[0m13:49:50.754543 [info ] [MainThread]:   host: db
[0m13:49:50.760466 [info ] [MainThread]:   port: 5432
[0m13:49:50.762503 [info ] [MainThread]:   user: db_user
[0m13:49:50.770800 [info ] [MainThread]:   database: db
[0m13:49:50.780069 [info ] [MainThread]:   schema: dev
[0m13:49:50.782499 [info ] [MainThread]:   connect_timeout: 10
[0m13:49:50.784629 [info ] [MainThread]:   role: None
[0m13:49:50.799210 [info ] [MainThread]:   search_path: None
[0m13:49:50.801777 [info ] [MainThread]:   keepalives_idle: 0
[0m13:49:50.816519 [info ] [MainThread]:   sslmode: None
[0m13:49:50.819161 [info ] [MainThread]:   sslcert: None
[0m13:49:50.821683 [info ] [MainThread]:   sslkey: None
[0m13:49:50.825346 [info ] [MainThread]:   sslrootcert: None
[0m13:49:50.833691 [info ] [MainThread]:   application_name: dbt
[0m13:49:50.837560 [info ] [MainThread]:   retries: 1
[0m13:49:50.841737 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:49:51.373465 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m13:49:52.714825 [debug] [MainThread]: Using postgres connection "debug"
[0m13:49:52.716466 [debug] [MainThread]: On debug: select 1 as id
[0m13:49:52.717218 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:49:53.304079 [debug] [MainThread]: SQL status: SELECT 1 in 0.586 seconds
[0m13:49:53.310453 [debug] [MainThread]: On debug: Close
[0m13:49:53.313085 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:49:53.324667 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:49:53.691903 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 6.6079206, "process_in_blocks": "13720", "process_kernel_time": 7.122574, "process_mem_max_rss": "101160", "process_out_blocks": "1520", "process_user_time": 8.76412}
[0m13:49:53.694787 [debug] [MainThread]: Command `dbt debug` succeeded at 13:49:53.694114 after 6.61 seconds
[0m13:49:53.706274 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:49:53.709701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21bb0d4320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21b8acb6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21bab02f00>]}
[0m13:49:53.714438 [debug] [MainThread]: Flushing usage events
[0m13:49:54.659396 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:50:52.013686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755d12d0e810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755d141c0380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755d12d0fc80>]}


============================== 13:50:52.055609 | 08830f67-0053-4a20-91d8-826fd1b40fce ==============================
[0m13:50:52.055609 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:50:52.057173 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:50:52.796223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08830f67-0053-4a20-91d8-826fd1b40fce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755d1240d460>]}
[0m13:50:52.965110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08830f67-0053-4a20-91d8-826fd1b40fce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755d1218be00>]}
[0m13:50:52.966957 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:50:53.337304 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:50:53.339982 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:50:53.342393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '08830f67-0053-4a20-91d8-826fd1b40fce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755d1098db20>]}
[0m13:50:57.234388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08830f67-0053-4a20-91d8-826fd1b40fce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755d0b345ca0>]}
[0m13:50:57.506712 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:50:57.522963 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:50:57.722675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08830f67-0053-4a20-91d8-826fd1b40fce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755d0b3a4500>]}
[0m13:50:57.723862 [info ] [MainThread]: Found 2 models, 4 data tests, 429 macros
[0m13:50:57.724925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08830f67-0053-4a20-91d8-826fd1b40fce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755d10566150>]}
[0m13:50:57.731118 [info ] [MainThread]: 
[0m13:50:57.732395 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:50:57.736001 [info ] [MainThread]: 
[0m13:50:57.743060 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:50:57.771352 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:50:58.864554 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:50:58.867167 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:50:58.869768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:59.121181 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.251 seconds
[0m13:50:59.124891 [debug] [ThreadPool]: On list_db: Close
[0m13:50:59.130252 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev'
[0m13:50:59.157884 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:50:59.159157 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m13:50:59.160622 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:50:59.217362 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m13:50:59.219249 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:50:59.220618 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:50:59.284795 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.062 seconds
[0m13:50:59.288185 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m13:50:59.290570 [debug] [ThreadPool]: On list_db_dev: Close
[0m13:50:59.430292 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:59.431480 [debug] [MainThread]: On master: BEGIN
[0m13:50:59.432388 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:50:59.451744 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m13:50:59.453381 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:59.456422 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:50:59.551611 [debug] [MainThread]: SQL status: SELECT 0 in 0.093 seconds
[0m13:50:59.557513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08830f67-0053-4a20-91d8-826fd1b40fce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755d0a6afc20>]}
[0m13:50:59.559148 [debug] [MainThread]: On master: ROLLBACK
[0m13:50:59.560931 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:59.562086 [debug] [MainThread]: On master: BEGIN
[0m13:50:59.564033 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:50:59.565810 [debug] [MainThread]: On master: COMMIT
[0m13:50:59.566780 [debug] [MainThread]: Using postgres connection "master"
[0m13:50:59.567547 [debug] [MainThread]: On master: COMMIT
[0m13:50:59.569080 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:50:59.569933 [debug] [MainThread]: On master: Close
[0m13:50:59.580406 [debug] [Thread-1 (]: Began running node model.my_project.my_first_dbt_model
[0m13:50:59.582794 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m13:50:59.586010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.my_first_dbt_model)
[0m13:50:59.589569 [debug] [Thread-1 (]: Began compiling node model.my_project.my_first_dbt_model
[0m13:50:59.622154 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.my_first_dbt_model"
[0m13:50:59.636748 [debug] [Thread-1 (]: Began executing node model.my_project.my_first_dbt_model
[0m13:50:59.768358 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.my_first_dbt_model"
[0m13:50:59.781114 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m13:50:59.782693 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: BEGIN
[0m13:50:59.784099 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:50:59.822271 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m13:50:59.823967 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m13:50:59.826032 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */

  
    

  create  table "db"."dev"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m13:50:59.898270 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.071 seconds
[0m13:50:59.915153 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m13:50:59.916082 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */
alter table "db"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m13:50:59.919280 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:50:59.955858 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: COMMIT
[0m13:50:59.956858 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m13:50:59.957715 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: COMMIT
[0m13:50:59.975954 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m13:51:00.008454 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."my_first_dbt_model__dbt_backup"
[0m13:51:00.031101 [debug] [Thread-1 (]: Using postgres connection "model.my_project.my_first_dbt_model"
[0m13:51:00.032609 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_first_dbt_model"} */
drop table if exists "db"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m13:51:00.035079 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m13:51:00.043543 [debug] [Thread-1 (]: On model.my_project.my_first_dbt_model: Close
[0m13:51:00.050989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08830f67-0053-4a20-91d8-826fd1b40fce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755d1413a540>]}
[0m13:51:00.053707 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.46s]
[0m13:51:00.056466 [debug] [Thread-1 (]: Finished running node model.my_project.my_first_dbt_model
[0m13:51:00.061525 [debug] [Thread-3 (]: Began running node model.my_project.my_second_dbt_model
[0m13:51:00.065341 [info ] [Thread-3 (]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m13:51:00.067760 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.my_second_dbt_model'
[0m13:51:00.069838 [debug] [Thread-3 (]: Began compiling node model.my_project.my_second_dbt_model
[0m13:51:00.082380 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.my_second_dbt_model"
[0m13:51:00.084014 [debug] [Thread-3 (]: Began executing node model.my_project.my_second_dbt_model
[0m13:51:00.193642 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.my_second_dbt_model"
[0m13:51:00.197424 [debug] [Thread-3 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m13:51:00.200015 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: BEGIN
[0m13:51:00.201965 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:51:00.256970 [debug] [Thread-3 (]: SQL status: BEGIN in 0.055 seconds
[0m13:51:00.259658 [debug] [Thread-3 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m13:51:00.261639 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */

  create view "db"."dev"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "db"."dev"."my_first_dbt_model"
where id = 1
  );
[0m13:51:00.283794 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m13:51:00.298250 [debug] [Thread-3 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m13:51:00.299915 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */
alter table "db"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m13:51:00.303950 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:51:00.309871 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: COMMIT
[0m13:51:00.311280 [debug] [Thread-3 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m13:51:00.312540 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: COMMIT
[0m13:51:00.317887 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m13:51:00.326745 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."my_second_dbt_model__dbt_backup"
[0m13:51:00.338909 [debug] [Thread-3 (]: Using postgres connection "model.my_project.my_second_dbt_model"
[0m13:51:00.340286 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.my_second_dbt_model"} */
drop view if exists "db"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m13:51:00.342546 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:51:00.346392 [debug] [Thread-3 (]: On model.my_project.my_second_dbt_model: Close
[0m13:51:00.348161 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08830f67-0053-4a20-91d8-826fd1b40fce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755d1063c530>]}
[0m13:51:00.350087 [info ] [Thread-3 (]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.28s]
[0m13:51:00.352912 [debug] [Thread-3 (]: Finished running node model.my_project.my_second_dbt_model
[0m13:51:00.359568 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:00.361287 [debug] [MainThread]: On master: BEGIN
[0m13:51:00.362947 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:51:00.404131 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m13:51:00.405717 [debug] [MainThread]: On master: COMMIT
[0m13:51:00.407106 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:00.408415 [debug] [MainThread]: On master: COMMIT
[0m13:51:00.410262 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:51:00.411797 [debug] [MainThread]: On master: Close
[0m13:51:00.413709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:51:00.415626 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m13:51:00.417911 [debug] [MainThread]: Connection 'model.my_project.my_first_dbt_model' was properly closed.
[0m13:51:00.419490 [debug] [MainThread]: Connection 'model.my_project.my_second_dbt_model' was properly closed.
[0m13:51:00.421732 [info ] [MainThread]: 
[0m13:51:00.424071 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.68 seconds (2.68s).
[0m13:51:00.439634 [debug] [MainThread]: Command end result
[0m13:51:00.539619 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:51:00.545634 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:51:00.562994 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:51:00.563821 [info ] [MainThread]: 
[0m13:51:00.565449 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:51:00.568271 [info ] [MainThread]: 
[0m13:51:00.570182 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m13:51:00.577592 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.731522, "process_in_blocks": "26304", "process_kernel_time": 3.221476, "process_mem_max_rss": "112540", "process_out_blocks": "4200", "process_user_time": 9.675693}
[0m13:51:00.581823 [debug] [MainThread]: Command `dbt run` succeeded at 13:51:00.580298 after 8.74 seconds
[0m13:51:00.583708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755d1598e8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755d1598e870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x755d10579b50>]}
[0m13:51:00.585758 [debug] [MainThread]: Flushing usage events
[0m13:51:01.394002 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:50.095328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e13a331f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e138a5c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e1385718e0>]}


============================== 14:05:50.116402 | 8635b63a-b8e7-40c2-adee-2c7652c66ea2 ==============================
[0m14:05:50.116402 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:05:50.118052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:05:50.818499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8635b63a-b8e7-40c2-adee-2c7652c66ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e136b32f00>]}
[0m14:05:50.984981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8635b63a-b8e7-40c2-adee-2c7652c66ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e13836cd40>]}
[0m14:05:50.988221 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:05:51.323519 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:05:51.561342 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:05:51.562370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8635b63a-b8e7-40c2-adee-2c7652c66ea2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e1387e40b0>]}
[0m14:05:53.898860 [error] [MainThread]: Encountered an error:
Compilation Error in model staging (models/staging/staging.sql)
  expected token 'end of print statement', got '{'
    line 1
      {{ config{
[0m14:05:53.954312 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.3399405, "process_in_blocks": "178360", "process_kernel_time": 2.355206, "process_mem_max_rss": "87512", "process_out_blocks": "16", "process_user_time": 7.953953}
[0m14:05:53.969802 [debug] [MainThread]: Command `dbt run` failed at 14:05:53.968157 after 6.36 seconds
[0m14:05:53.975031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e1366d6ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e13b8f74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e138255370>]}
[0m14:05:53.978357 [debug] [MainThread]: Flushing usage events
[0m14:05:55.819049 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:37.258832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739aec53d1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739aec8cdd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739aedba8260>]}


============================== 14:07:37.280775 | 5dbbf55a-8fbe-4eb8-9cdc-9f3a612c2693 ==============================
[0m14:07:37.280775 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:07:37.282984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:07:38.326990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dbbf55a-8fbe-4eb8-9cdc-9f3a612c2693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739aea2f5d60>]}
[0m14:07:38.496122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dbbf55a-8fbe-4eb8-9cdc-9f3a612c2693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739aebe6a120>]}
[0m14:07:38.498624 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:07:38.848936 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:07:39.178765 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:07:39.179714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5dbbf55a-8fbe-4eb8-9cdc-9f3a612c2693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739aea1c10a0>]}
[0m14:07:42.374638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dbbf55a-8fbe-4eb8-9cdc-9f3a612c2693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739aea0c1e20>]}
[0m14:07:42.571486 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:07:42.579140 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:07:42.782202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dbbf55a-8fbe-4eb8-9cdc-9f3a612c2693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739aea0c15b0>]}
[0m14:07:42.783469 [info ] [MainThread]: Found 1 model, 1 source, 429 macros
[0m14:07:42.784515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dbbf55a-8fbe-4eb8-9cdc-9f3a612c2693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739aebc39940>]}
[0m14:07:42.789154 [info ] [MainThread]: 
[0m14:07:42.790355 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:07:42.791754 [info ] [MainThread]: 
[0m14:07:42.794253 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:07:42.799758 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:07:43.213338 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:07:43.214190 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:07:43.214951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:43.484813 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.270 seconds
[0m14:07:43.487510 [debug] [ThreadPool]: On list_db: Close
[0m14:07:43.490947 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m14:07:43.592245 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:07:43.592923 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m14:07:43.593461 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:43.651930 [debug] [ThreadPool]: SQL status: BEGIN in 0.058 seconds
[0m14:07:43.652850 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:07:43.653785 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:07:43.747140 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.092 seconds
[0m14:07:43.749748 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m14:07:43.750957 [debug] [ThreadPool]: On list_db_dev: Close
[0m14:07:43.761408 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:43.762350 [debug] [MainThread]: On master: BEGIN
[0m14:07:43.763190 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:43.809635 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m14:07:43.810631 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:43.811656 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:07:43.963502 [debug] [MainThread]: SQL status: SELECT 0 in 0.151 seconds
[0m14:07:43.967385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dbbf55a-8fbe-4eb8-9cdc-9f3a612c2693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739ac3fc60f0>]}
[0m14:07:43.969005 [debug] [MainThread]: On master: ROLLBACK
[0m14:07:43.970595 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:43.971569 [debug] [MainThread]: On master: BEGIN
[0m14:07:43.973672 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:07:43.975497 [debug] [MainThread]: On master: COMMIT
[0m14:07:43.977113 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:43.978536 [debug] [MainThread]: On master: COMMIT
[0m14:07:43.980720 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:07:43.982040 [debug] [MainThread]: On master: Close
[0m14:07:43.995554 [debug] [Thread-1 (]: Began running node model.my_project.staging
[0m14:07:43.997205 [info ] [Thread-1 (]: 1 of 1 START sql table model dev.staging ....................................... [RUN]
[0m14:07:43.999153 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.staging)
[0m14:07:44.001154 [debug] [Thread-1 (]: Began compiling node model.my_project.staging
[0m14:07:44.022212 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.staging"
[0m14:07:44.033384 [debug] [Thread-1 (]: Began executing node model.my_project.staging
[0m14:07:44.210986 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.staging"
[0m14:07:44.237673 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:07:44.238500 [debug] [Thread-1 (]: On model.my_project.staging: BEGIN
[0m14:07:44.239440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:44.254208 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m14:07:44.255836 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:07:44.257285 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */

  
    

  create  table "db"."dev"."staging__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "db"."dev"."raw_weather_data"
  );
  
[0m14:07:44.311008 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.053 seconds
[0m14:07:44.327049 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:07:44.328330 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
alter table "db"."dev"."staging__dbt_tmp" rename to "staging"
[0m14:07:44.330370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:07:44.375213 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:07:44.376365 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:07:44.377408 [debug] [Thread-1 (]: On model.my_project.staging: COMMIT
[0m14:07:44.383411 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m14:07:44.403464 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."staging__dbt_backup"
[0m14:07:44.431044 [debug] [Thread-1 (]: Using postgres connection "model.my_project.staging"
[0m14:07:44.433653 [debug] [Thread-1 (]: On model.my_project.staging: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.staging"} */
drop table if exists "db"."dev"."staging__dbt_backup" cascade
[0m14:07:44.437442 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:07:44.444923 [debug] [Thread-1 (]: On model.my_project.staging: Close
[0m14:07:44.450305 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dbbf55a-8fbe-4eb8-9cdc-9f3a612c2693', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739aedb22480>]}
[0m14:07:44.452043 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dev.staging .................................. [[32mSELECT 2[0m in 0.45s]
[0m14:07:44.454131 [debug] [Thread-1 (]: Finished running node model.my_project.staging
[0m14:07:44.460653 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:44.461960 [debug] [MainThread]: On master: BEGIN
[0m14:07:44.463856 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:44.486955 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m14:07:44.489135 [debug] [MainThread]: On master: COMMIT
[0m14:07:44.490364 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:44.491585 [debug] [MainThread]: On master: COMMIT
[0m14:07:44.493055 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:07:44.494242 [debug] [MainThread]: On master: Close
[0m14:07:44.496145 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:44.497725 [debug] [MainThread]: Connection 'model.my_project.staging' was properly closed.
[0m14:07:44.499241 [info ] [MainThread]: 
[0m14:07:44.500421 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.71 seconds (1.71s).
[0m14:07:44.504261 [debug] [MainThread]: Command end result
[0m14:07:44.577604 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:07:44.581932 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:07:44.592547 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:07:44.593585 [info ] [MainThread]: 
[0m14:07:44.594804 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:44.596243 [info ] [MainThread]: 
[0m14:07:44.597547 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:07:44.602284 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.577172, "process_in_blocks": "117648", "process_kernel_time": 7.045538, "process_mem_max_rss": "111276", "process_out_blocks": "4144", "process_user_time": 7.533621}
[0m14:07:44.604625 [debug] [MainThread]: Command `dbt run` succeeded at 14:07:44.604093 after 7.58 seconds
[0m14:07:44.605989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739aebeb4b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739aea071c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x739aea071f70>]}
[0m14:07:44.607823 [debug] [MainThread]: Flushing usage events
[0m14:07:45.377548 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:30.588955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7105d0e55280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7105d0abc5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7105d0e56210>]}


============================== 14:20:30.609399 | 60748e6b-d649-46ca-84bc-74f9118be7fa ==============================
[0m14:20:30.609399 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:20:30.611588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:20:31.183189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '60748e6b-d649-46ca-84bc-74f9118be7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7105d08fcf80>]}
[0m14:20:31.312654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '60748e6b-d649-46ca-84bc-74f9118be7fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7105d11a3860>]}
[0m14:20:31.314512 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:20:31.593160 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:20:31.912019 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 1 files changed.
[0m14:20:31.913297 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/weather_report.sql
[0m14:20:31.914203 [debug] [MainThread]: Partial parsing: added file: my_project://models/staging/stg_weather_data.sql
[0m14:20:31.915330 [debug] [MainThread]: Partial parsing: updated file: my_project://models/sources/sources.yaml
[0m14:20:31.916780 [debug] [MainThread]: Partial parsing: deleted file: my_project://models/staging/staging.sql
[0m14:20:42.586560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77da306947d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77da308d3e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77da30802840>]}


============================== 14:20:42.606753 | b745d179-7928-4837-adcb-9c777b5dabb3 ==============================
[0m14:20:42.606753 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:20:42.609643 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:20:43.255367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b745d179-7928-4837-adcb-9c777b5dabb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77da2e8a85c0>]}
[0m14:20:43.563514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b745d179-7928-4837-adcb-9c777b5dabb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77da30f27ad0>]}
[0m14:20:43.567366 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:20:43.891166 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:20:44.232716 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 1 files changed.
[0m14:20:44.234651 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/weather_report.sql
[0m14:20:44.236070 [debug] [MainThread]: Partial parsing: added file: my_project://models/staging/stg_weather_data.sql
[0m14:20:44.238014 [debug] [MainThread]: Partial parsing: updated file: my_project://models/sources/sources.yaml
[0m14:20:44.239032 [debug] [MainThread]: Partial parsing: deleted file: my_project://models/staging/staging.sql
[0m14:20:45.938216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b745d179-7928-4837-adcb-9c777b5dabb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77da2e53c2f0>]}
[0m14:20:46.163486 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:20:46.170907 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:20:46.243713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b745d179-7928-4837-adcb-9c777b5dabb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77da2d462c00>]}
[0m14:20:46.245232 [info ] [MainThread]: Found 2 models, 1 source, 429 macros
[0m14:20:46.247019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b745d179-7928-4837-adcb-9c777b5dabb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77da2d41c950>]}
[0m14:20:46.254009 [info ] [MainThread]: 
[0m14:20:46.255477 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:20:46.260202 [info ] [MainThread]: 
[0m14:20:46.265766 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:20:46.299876 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:20:46.575363 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:20:46.576403 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:20:46.577307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:46.691097 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.113 seconds
[0m14:20:46.695462 [debug] [ThreadPool]: On list_db: Close
[0m14:20:46.701973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m14:20:46.728041 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:20:46.728994 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m14:20:46.730072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:20:46.754697 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m14:20:46.755641 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:20:46.756534 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:20:46.786663 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.029 seconds
[0m14:20:46.791385 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m14:20:46.793228 [debug] [ThreadPool]: On list_db_dev: Close
[0m14:20:46.818161 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:46.819190 [debug] [MainThread]: On master: BEGIN
[0m14:20:46.820453 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:20:46.846586 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m14:20:46.848102 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:46.849859 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:20:46.906495 [debug] [MainThread]: SQL status: SELECT 0 in 0.055 seconds
[0m14:20:46.912586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b745d179-7928-4837-adcb-9c777b5dabb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77da2c61e360>]}
[0m14:20:46.915752 [debug] [MainThread]: On master: ROLLBACK
[0m14:20:46.918225 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:46.920057 [debug] [MainThread]: On master: BEGIN
[0m14:20:46.931519 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:20:46.934967 [debug] [MainThread]: On master: COMMIT
[0m14:20:46.937556 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:46.940580 [debug] [MainThread]: On master: COMMIT
[0m14:20:46.945208 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:20:46.951904 [debug] [MainThread]: On master: Close
[0m14:20:46.986854 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m14:20:46.990647 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.stg_weather_data .............................. [RUN]
[0m14:20:47.003466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m14:20:47.007639 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m14:20:47.091985 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m14:20:47.095842 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m14:20:47.412959 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m14:20:47.416873 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:20:47.429356 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m14:20:47.431707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:47.485326 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m14:20:47.488443 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:20:47.491040 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)

-- SELECT
--     id,
--     city,
--     temperature,
--     weather_descriptions,
--     wind_speed,
--     TIME AS weather_time_local,
--     (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
-- FROM source
  );
  
[0m14:20:47.537834 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ")"
LINE 33:   );
           ^

[0m14:20:47.540011 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: ROLLBACK
[0m14:20:47.543042 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m14:20:47.715133 [debug] [Thread-1 (]: Database Error in model stg_weather_data (models/staging/stg_weather_data.sql)
  syntax error at or near ")"
  LINE 33:   );
             ^
  compiled code at target/run/my_project/models/staging/stg_weather_data.sql
[0m14:20:47.761977 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b745d179-7928-4837-adcb-9c777b5dabb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77da2d40f500>]}
[0m14:20:47.770852 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model dev.stg_weather_data ..................... [[31mERROR[0m in 0.73s]
[0m14:20:47.788967 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m14:20:47.808293 [debug] [Thread-7 (]: Marking all children of 'model.my_project.stg_weather_data' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather_data (models/staging/stg_weather_data.sql)
  syntax error at or near ")"
  LINE 33:   );
             ^
  compiled code at target/run/my_project/models/staging/stg_weather_data.sql.
[0m14:20:47.832893 [debug] [Thread-3 (]: Began running node model.my_project.weather_report
[0m14:20:47.838076 [info ] [Thread-3 (]: 2 of 2 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m14:20:47.853005 [debug] [Thread-3 (]: Finished running node model.my_project.weather_report
[0m14:20:47.884084 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:47.887362 [debug] [MainThread]: On master: BEGIN
[0m14:20:47.901735 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:20:47.976734 [debug] [MainThread]: SQL status: BEGIN in 0.075 seconds
[0m14:20:47.979333 [debug] [MainThread]: On master: COMMIT
[0m14:20:47.984861 [debug] [MainThread]: Using postgres connection "master"
[0m14:20:47.987953 [debug] [MainThread]: On master: COMMIT
[0m14:20:47.992043 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:20:47.995037 [debug] [MainThread]: On master: Close
[0m14:20:48.008574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:20:48.010845 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m14:20:48.013301 [info ] [MainThread]: 
[0m14:20:48.015062 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m14:20:48.031855 [debug] [MainThread]: Command end result
[0m14:20:48.185110 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:20:48.192714 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:20:48.223131 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:20:48.225794 [info ] [MainThread]: 
[0m14:20:48.230846 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:20:48.234578 [info ] [MainThread]: 
[0m14:20:48.238121 [error] [MainThread]:   Database Error in model stg_weather_data (models/staging/stg_weather_data.sql)
  syntax error at or near ")"
  LINE 33:   );
             ^
  compiled code at target/run/my_project/models/staging/stg_weather_data.sql
[0m14:20:48.240310 [info ] [MainThread]: 
[0m14:20:48.242790 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m14:20:48.250190 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 5.9363456, "process_in_blocks": "368", "process_kernel_time": 2.171039, "process_mem_max_rss": "111376", "process_out_blocks": "2544", "process_user_time": 8.444622}
[0m14:20:48.258191 [debug] [MainThread]: Command `dbt run` failed at 14:20:48.256794 after 5.95 seconds
[0m14:20:48.261046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77da30d8ac00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77da30e16330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77da2d462b70>]}
[0m14:20:48.264034 [debug] [MainThread]: Flushing usage events
[0m14:20:49.121968 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:21:11.038180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707a84b7b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707a84a897f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707a84a8b200>]}


============================== 14:21:11.047205 | 3fafffaa-43cd-419f-8565-0902bb0f5102 ==============================
[0m14:21:11.047205 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:21:11.048821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:21:11.488541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fafffaa-43cd-419f-8565-0902bb0f5102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707a8616b560>]}
[0m14:21:11.672591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fafffaa-43cd-419f-8565-0902bb0f5102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707a8434a510>]}
[0m14:21:11.674641 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:21:11.932772 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:21:12.182163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:21:12.184093 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/stg_weather_data.sql
[0m14:21:12.886170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fafffaa-43cd-419f-8565-0902bb0f5102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707a827fd340>]}
[0m14:21:13.067375 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:21:13.074608 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:21:13.117850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fafffaa-43cd-419f-8565-0902bb0f5102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707a82802870>]}
[0m14:21:13.118948 [info ] [MainThread]: Found 2 models, 1 source, 429 macros
[0m14:21:13.119903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fafffaa-43cd-419f-8565-0902bb0f5102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707a82ad4620>]}
[0m14:21:13.124539 [info ] [MainThread]: 
[0m14:21:13.125818 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:21:13.126876 [info ] [MainThread]: 
[0m14:21:13.130255 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:21:13.147569 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:21:13.288294 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:21:13.289223 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:21:13.290087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:13.309930 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.020 seconds
[0m14:21:13.312574 [debug] [ThreadPool]: On list_db: Close
[0m14:21:13.316483 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m14:21:13.335570 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:21:13.336481 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m14:21:13.337364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:21:13.353598 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m14:21:13.354340 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:21:13.355028 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:21:13.362952 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.007 seconds
[0m14:21:13.365673 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m14:21:13.366880 [debug] [ThreadPool]: On list_db_dev: Close
[0m14:21:13.378001 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:13.378878 [debug] [MainThread]: On master: BEGIN
[0m14:21:13.379546 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:21:13.396011 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m14:21:13.397200 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:13.398365 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:21:13.412347 [debug] [MainThread]: SQL status: SELECT 0 in 0.013 seconds
[0m14:21:13.415863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fafffaa-43cd-419f-8565-0902bb0f5102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707a82981b20>]}
[0m14:21:13.417022 [debug] [MainThread]: On master: ROLLBACK
[0m14:21:13.418636 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:13.419394 [debug] [MainThread]: On master: BEGIN
[0m14:21:13.421020 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:21:13.421986 [debug] [MainThread]: On master: COMMIT
[0m14:21:13.422638 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:13.423242 [debug] [MainThread]: On master: COMMIT
[0m14:21:13.424431 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:21:13.425395 [debug] [MainThread]: On master: Close
[0m14:21:13.432355 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m14:21:13.434079 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.stg_weather_data .............................. [RUN]
[0m14:21:13.435806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m14:21:13.437624 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m14:21:13.455846 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m14:21:13.457690 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m14:21:13.561864 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m14:21:13.564498 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:21:13.565631 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m14:21:13.566505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:13.583433 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m14:21:13.584478 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:21:13.585893 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)
SELECT * FROM  de_dup

-- SELECT
--     id,
--     city,
--     temperature,
--     weather_descriptions,
--     wind_speed,
--     TIME AS weather_time_local,
--     (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
-- FROM source
  );
  
[0m14:21:13.622439 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.035 seconds
[0m14:21:13.635819 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:21:13.636842 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m14:21:13.639440 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:21:13.675264 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m14:21:13.676179 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:21:13.676928 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m14:21:13.683123 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m14:21:13.695618 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m14:21:13.707927 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:21:13.708836 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m14:21:13.711450 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m14:21:13.716237 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m14:21:13.721766 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fafffaa-43cd-419f-8565-0902bb0f5102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707a8616a690>]}
[0m14:21:13.723432 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 2[0m in 0.28s]
[0m14:21:13.725170 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m14:21:13.728370 [debug] [Thread-3 (]: Began running node model.my_project.weather_report
[0m14:21:13.730068 [info ] [Thread-3 (]: 2 of 2 START sql table model dev.weather_report ................................ [RUN]
[0m14:21:13.732096 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m14:21:13.734589 [debug] [Thread-3 (]: Began compiling node model.my_project.weather_report
[0m14:21:13.744867 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m14:21:13.750291 [debug] [Thread-3 (]: Began executing node model.my_project.weather_report
[0m14:21:13.764845 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m14:21:13.769476 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m14:21:13.770908 [debug] [Thread-3 (]: On model.my_project.weather_report: BEGIN
[0m14:21:13.772253 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:21:13.790523 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m14:21:13.791468 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m14:21:13.792336 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "db"."dev"."stg_weather_data"
  );
  
[0m14:21:13.807845 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.015 seconds
[0m14:21:13.813852 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m14:21:13.815059 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m14:21:13.817054 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:21:13.821399 [debug] [Thread-3 (]: On model.my_project.weather_report: COMMIT
[0m14:21:13.822383 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m14:21:13.823259 [debug] [Thread-3 (]: On model.my_project.weather_report: COMMIT
[0m14:21:13.828061 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m14:21:13.835179 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m14:21:13.836722 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m14:21:13.837626 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m14:21:13.839166 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:21:13.842069 [debug] [Thread-3 (]: On model.my_project.weather_report: Close
[0m14:21:13.843519 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fafffaa-43cd-419f-8565-0902bb0f5102', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707a808bd3d0>]}
[0m14:21:13.845246 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev.weather_report ........................... [[32mSELECT 2[0m in 0.11s]
[0m14:21:13.847071 [debug] [Thread-3 (]: Finished running node model.my_project.weather_report
[0m14:21:13.852437 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:13.853849 [debug] [MainThread]: On master: BEGIN
[0m14:21:13.854771 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:21:13.873242 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m14:21:13.874609 [debug] [MainThread]: On master: COMMIT
[0m14:21:13.875458 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:13.876239 [debug] [MainThread]: On master: COMMIT
[0m14:21:13.877658 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:21:13.878945 [debug] [MainThread]: On master: Close
[0m14:21:13.883083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:13.884792 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m14:21:13.886343 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m14:21:13.887965 [info ] [MainThread]: 
[0m14:21:13.890446 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m14:21:13.896356 [debug] [MainThread]: Command end result
[0m14:21:13.991793 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:21:13.997868 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:21:14.020482 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:21:14.022072 [info ] [MainThread]: 
[0m14:21:14.023970 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:21:14.027571 [info ] [MainThread]: 
[0m14:21:14.031370 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:21:14.036500 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1715016, "process_in_blocks": "0", "process_kernel_time": 1.042172, "process_mem_max_rss": "109948", "process_out_blocks": "2560", "process_user_time": 4.884715}
[0m14:21:14.039271 [debug] [MainThread]: Command `dbt run` succeeded at 14:21:14.038625 after 3.17 seconds
[0m14:21:14.041761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707a845a6cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707a82721820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707a845e0bf0>]}
[0m14:21:14.044109 [debug] [MainThread]: Flushing usage events
[0m14:21:14.843319 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:25:14.330878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1d7f3572c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1d805b4080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1d7ee05700>]}


============================== 14:25:14.340579 | aced0876-d6c6-4d8c-ac99-97f31659cff3 ==============================
[0m14:25:14.340579 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:25:14.342164 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:25:15.807894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aced0876-d6c6-4d8c-ac99-97f31659cff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1d7e5e7770>]}
[0m14:25:16.122078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aced0876-d6c6-4d8c-ac99-97f31659cff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1d7e6b4c80>]}
[0m14:25:16.124253 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:25:16.455546 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:25:16.813388 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:25:16.815245 [debug] [MainThread]: Partial parsing: updated file: my_project://models/staging/stg_weather_data.sql
[0m14:25:17.839326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aced0876-d6c6-4d8c-ac99-97f31659cff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1d7c9ad1c0>]}
[0m14:25:18.091815 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:25:18.100274 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:25:18.157948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aced0876-d6c6-4d8c-ac99-97f31659cff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1d7c9a27e0>]}
[0m14:25:18.159169 [info ] [MainThread]: Found 2 models, 1 source, 429 macros
[0m14:25:18.160320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aced0876-d6c6-4d8c-ac99-97f31659cff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1d7c99a4e0>]}
[0m14:25:18.166021 [info ] [MainThread]: 
[0m14:25:18.167493 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:25:18.169299 [info ] [MainThread]: 
[0m14:25:18.172070 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:25:18.197122 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:25:18.384751 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:25:18.385603 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:25:18.386301 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:18.416941 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.031 seconds
[0m14:25:18.419828 [debug] [ThreadPool]: On list_db: Close
[0m14:25:18.423426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m14:25:18.446936 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:25:18.447947 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m14:25:18.448701 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:25:18.470762 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m14:25:18.471806 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:25:18.472695 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:25:18.483333 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.010 seconds
[0m14:25:18.486279 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m14:25:18.487887 [debug] [ThreadPool]: On list_db_dev: Close
[0m14:25:18.503454 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:18.504487 [debug] [MainThread]: On master: BEGIN
[0m14:25:18.505420 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:25:18.521796 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m14:25:18.522858 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:18.524114 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:25:18.543512 [debug] [MainThread]: SQL status: SELECT 0 in 0.018 seconds
[0m14:25:18.547731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aced0876-d6c6-4d8c-ac99-97f31659cff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1d6eaad130>]}
[0m14:25:18.549031 [debug] [MainThread]: On master: ROLLBACK
[0m14:25:18.550739 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:18.551650 [debug] [MainThread]: On master: BEGIN
[0m14:25:18.553563 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:25:18.554556 [debug] [MainThread]: On master: COMMIT
[0m14:25:18.555371 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:18.556084 [debug] [MainThread]: On master: COMMIT
[0m14:25:18.557417 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:25:18.558272 [debug] [MainThread]: On master: Close
[0m14:25:18.564916 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m14:25:18.566769 [info ] [Thread-1 (]: 1 of 2 START sql table model dev.stg_weather_data .............................. [RUN]
[0m14:25:18.568121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m14:25:18.570291 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m14:25:18.602165 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m14:25:18.606392 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m14:25:18.727718 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m14:25:18.730003 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:25:18.731087 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m14:25:18.731911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:18.751341 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m14:25:18.752472 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:25:18.753427 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m14:25:18.776500 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.022 seconds
[0m14:25:18.794529 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:25:18.795873 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m14:25:18.798344 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:25:18.851357 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m14:25:18.852374 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:25:18.853365 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m14:25:18.863717 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m14:25:18.883212 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m14:25:18.900366 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:25:18.901533 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m14:25:18.903861 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:25:18.912078 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m14:25:18.917905 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aced0876-d6c6-4d8c-ac99-97f31659cff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1d80336360>]}
[0m14:25:18.922940 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.35s]
[0m14:25:18.926638 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m14:25:18.932091 [debug] [Thread-3 (]: Began running node model.my_project.weather_report
[0m14:25:18.946231 [info ] [Thread-3 (]: 2 of 2 START sql table model dev.weather_report ................................ [RUN]
[0m14:25:18.949894 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m14:25:18.963716 [debug] [Thread-3 (]: Began compiling node model.my_project.weather_report
[0m14:25:19.015923 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m14:25:19.019596 [debug] [Thread-3 (]: Began executing node model.my_project.weather_report
[0m14:25:19.043126 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m14:25:19.047475 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m14:25:19.050163 [debug] [Thread-3 (]: On model.my_project.weather_report: BEGIN
[0m14:25:19.052192 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:25:19.080348 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m14:25:19.082882 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m14:25:19.085430 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT *
FROM "db"."dev"."stg_weather_data"
  );
  
[0m14:25:19.109616 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.022 seconds
[0m14:25:19.131363 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m14:25:19.133733 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m14:25:19.137830 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:25:19.176618 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m14:25:19.178219 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m14:25:19.184226 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:25:19.214018 [debug] [Thread-3 (]: On model.my_project.weather_report: COMMIT
[0m14:25:19.224152 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m14:25:19.226169 [debug] [Thread-3 (]: On model.my_project.weather_report: COMMIT
[0m14:25:19.238482 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m14:25:19.251323 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m14:25:19.254975 [debug] [Thread-3 (]: Using postgres connection "model.my_project.weather_report"
[0m14:25:19.257384 [debug] [Thread-3 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m14:25:19.269870 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.010 seconds
[0m14:25:19.276144 [debug] [Thread-3 (]: On model.my_project.weather_report: Close
[0m14:25:19.280430 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aced0876-d6c6-4d8c-ac99-97f31659cff3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1d6e99dac0>]}
[0m14:25:19.283732 [info ] [Thread-3 (]: 2 of 2 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.33s]
[0m14:25:19.286622 [debug] [Thread-3 (]: Finished running node model.my_project.weather_report
[0m14:25:19.302796 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:19.305593 [debug] [MainThread]: On master: BEGIN
[0m14:25:19.310981 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:25:19.352704 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m14:25:19.354829 [debug] [MainThread]: On master: COMMIT
[0m14:25:19.356507 [debug] [MainThread]: Using postgres connection "master"
[0m14:25:19.358335 [debug] [MainThread]: On master: COMMIT
[0m14:25:19.362014 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:25:19.364550 [debug] [MainThread]: On master: Close
[0m14:25:19.368039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:25:19.372578 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m14:25:19.375775 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m14:25:19.378770 [info ] [MainThread]: 
[0m14:25:19.380881 [info ] [MainThread]: Finished running 2 table models in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m14:25:19.386108 [debug] [MainThread]: Command end result
[0m14:25:19.555982 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:25:19.561102 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:25:19.578754 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:25:19.579793 [info ] [MainThread]: 
[0m14:25:19.581323 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:25:19.583965 [info ] [MainThread]: 
[0m14:25:19.587413 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:25:19.592581 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.4542794, "process_in_blocks": "0", "process_kernel_time": 1.463781, "process_mem_max_rss": "110032", "process_out_blocks": "2560", "process_user_time": 6.788334}
[0m14:25:19.596062 [debug] [MainThread]: Command `dbt run` succeeded at 14:25:19.595573 after 5.46 seconds
[0m14:25:19.597517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1d7e6b4d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1d7cc7c8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d1d7ee05700>]}
[0m14:25:19.599630 [debug] [MainThread]: Flushing usage events
[0m14:25:18.054175 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:31:31.686741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a68233491f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a68231d05f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6823982ed0>]}


============================== 14:31:31.697306 | 373af9c3-7425-480a-94cc-238293e5f4fd ==============================
[0m14:31:31.697306 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:31:31.699471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:31:32.207606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '373af9c3-7425-480a-94cc-238293e5f4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6822d3cc50>]}
[0m14:31:32.360368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '373af9c3-7425-480a-94cc-238293e5f4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6824a54980>]}
[0m14:31:32.362590 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:31:32.597403 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:31:32.891543 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:31:32.892915 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/daily_average.sql
[0m14:31:32.894197 [debug] [MainThread]: Partial parsing: updated file: my_project://models/mart/weather_report.sql
[0m14:31:33.399196 [error] [MainThread]: Encountered an error:
Compilation Error in model daily_average (models/mart/daily_average.sql)
  The name argument to ref() must be a string, got <class 'dbt_common.clients.jinja.create_undefined.<locals>.Undefined'>
[0m14:31:33.404262 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9099572, "process_in_blocks": "16", "process_kernel_time": 1.071752, "process_mem_max_rss": "98140", "process_out_blocks": "8", "process_user_time": 4.191578}
[0m14:31:33.407450 [debug] [MainThread]: Command `dbt run` failed at 14:31:33.406940 after 1.91 seconds
[0m14:31:33.409125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a682312ecf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a682126ac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a682115fec0>]}
[0m14:31:33.411005 [debug] [MainThread]: Flushing usage events
[0m14:31:34.132527 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:32:00.042931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b581d9b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b587078f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b589599d0>]}


============================== 14:32:00.055151 | e12e47df-e985-46c9-87e7-d146a52bf87f ==============================
[0m14:32:00.055151 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:32:00.057269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:32:00.563739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e12e47df-e985-46c9-87e7-d146a52bf87f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b57cfac90>]}
[0m14:32:00.711249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e12e47df-e985-46c9-87e7-d146a52bf87f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b58cf9fd0>]}
[0m14:32:00.712940 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:32:00.971212 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:32:01.312338 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m14:32:01.313807 [debug] [MainThread]: Partial parsing: added file: my_project://models/mart/daily_average.sql
[0m14:32:01.314997 [debug] [MainThread]: Partial parsing: updated file: my_project://models/mart/weather_report.sql
[0m14:32:02.124085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e12e47df-e985-46c9-87e7-d146a52bf87f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b56197740>]}
[0m14:32:02.330495 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:32:02.336329 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:32:02.376054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e12e47df-e985-46c9-87e7-d146a52bf87f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b560b6e70>]}
[0m14:32:02.377232 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m14:32:02.378102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e12e47df-e985-46c9-87e7-d146a52bf87f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b5617c650>]}
[0m14:32:02.382611 [info ] [MainThread]: 
[0m14:32:02.383826 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:32:02.385514 [info ] [MainThread]: 
[0m14:32:02.387826 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:32:02.407718 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:32:02.597953 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:32:02.598775 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:32:02.599534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:02.618732 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m14:32:02.621655 [debug] [ThreadPool]: On list_db: Close
[0m14:32:02.625606 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m14:32:02.639722 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:32:02.640539 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m14:32:02.641175 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:32:02.654971 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m14:32:02.656034 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:32:02.656788 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:32:02.664633 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m14:32:02.667477 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m14:32:02.668702 [debug] [ThreadPool]: On list_db_dev: Close
[0m14:32:02.681186 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:02.682050 [debug] [MainThread]: On master: BEGIN
[0m14:32:02.682782 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:32:02.698259 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m14:32:02.699068 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:02.700116 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:32:02.717015 [debug] [MainThread]: SQL status: SELECT 0 in 0.016 seconds
[0m14:32:02.720015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e12e47df-e985-46c9-87e7-d146a52bf87f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b56450c80>]}
[0m14:32:02.721054 [debug] [MainThread]: On master: ROLLBACK
[0m14:32:02.722226 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:02.722947 [debug] [MainThread]: On master: BEGIN
[0m14:32:02.724646 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:32:02.725427 [debug] [MainThread]: On master: COMMIT
[0m14:32:02.726092 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:02.726762 [debug] [MainThread]: On master: COMMIT
[0m14:32:02.728142 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:32:02.729050 [debug] [MainThread]: On master: Close
[0m14:32:02.736613 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m14:32:02.738250 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m14:32:02.739693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m14:32:02.740899 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m14:32:02.762441 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m14:32:02.764179 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m14:32:02.903891 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m14:32:02.907434 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:32:02.909106 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m14:32:02.910631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:02.934191 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m14:32:02.935755 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:32:02.937277 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m14:32:02.963834 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.025 seconds
[0m14:32:02.983461 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:32:02.984758 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m14:32:02.987439 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:32:02.995776 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:32:02.997017 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m14:32:02.999699 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:32:03.049445 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m14:32:03.050356 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:32:03.051078 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m14:32:03.056205 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:32:03.068184 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m14:32:03.080189 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:32:03.081092 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m14:32:03.088843 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.007 seconds
[0m14:32:03.093752 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m14:32:03.097552 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e12e47df-e985-46c9-87e7-d146a52bf87f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b59a4e4e0>]}
[0m14:32:03.098999 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.36s]
[0m14:32:03.101025 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m14:32:03.104791 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m14:32:03.105901 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m14:32:03.107498 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m14:32:03.109637 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m14:32:03.112645 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m14:32:03.114900 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m14:32:03.116948 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m14:32:03.119015 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m14:32:03.135942 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m14:32:03.153585 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m14:32:03.155992 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m14:32:03.157590 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m14:32:03.164917 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m14:32:03.171869 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m14:32:03.173684 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:32:03.174876 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m14:32:03.175987 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:32:03.176798 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:32:03.177709 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m14:32:03.179094 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:32:03.194719 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m14:32:03.196170 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:32:03.197585 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m14:32:03.200153 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m14:32:03.201706 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:32:03.203051 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m14:32:03.217565 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.013 seconds
[0m14:32:03.225229 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:32:03.226350 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.027 seconds
[0m14:32:03.227259 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m14:32:03.233760 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:32:03.235299 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m14:32:03.236373 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:32:03.242457 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:32:03.243379 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m14:32:03.244195 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m14:32:03.247840 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m14:32:03.249159 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:32:03.249965 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:32:03.250828 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m14:32:03.254619 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:32:03.256003 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:32:03.256943 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:32:03.261142 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m14:32:03.267751 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m14:32:03.268666 [debug] [Thread-4 (]: SQL status: COMMIT in 0.010 seconds
[0m14:32:03.270216 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:32:03.275257 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m14:32:03.276448 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m14:32:03.277881 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:32:03.279079 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m14:32:03.280152 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:32:03.283930 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m14:32:03.285701 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e12e47df-e985-46c9-87e7-d146a52bf87f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b54185250>]}
[0m14:32:03.288504 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m14:32:03.287493 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.17s]
[0m14:32:03.293027 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m14:32:03.294674 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m14:32:03.296693 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e12e47df-e985-46c9-87e7-d146a52bf87f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b5426afc0>]}
[0m14:32:03.299662 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.18s]
[0m14:32:03.302150 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m14:32:03.308295 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:03.309441 [debug] [MainThread]: On master: BEGIN
[0m14:32:03.310556 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:32:03.338431 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m14:32:03.340116 [debug] [MainThread]: On master: COMMIT
[0m14:32:03.342105 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:03.344265 [debug] [MainThread]: On master: COMMIT
[0m14:32:03.346257 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:32:03.348116 [debug] [MainThread]: On master: Close
[0m14:32:03.350272 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:03.351890 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m14:32:03.352903 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m14:32:03.353924 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m14:32:03.355247 [info ] [MainThread]: 
[0m14:32:03.357203 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.97 seconds (0.97s).
[0m14:32:03.361535 [debug] [MainThread]: Command end result
[0m14:32:03.456908 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:32:03.462862 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:32:03.487675 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:32:03.489144 [info ] [MainThread]: 
[0m14:32:03.491168 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:32:03.493232 [info ] [MainThread]: 
[0m14:32:03.495510 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:32:03.500276 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.6338973, "process_in_blocks": "0", "process_kernel_time": 1.143983, "process_mem_max_rss": "110352", "process_out_blocks": "2616", "process_user_time": 5.433919}
[0m14:32:03.503025 [debug] [MainThread]: Command `dbt run` succeeded at 14:32:03.502330 after 3.64 seconds
[0m14:32:03.509001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b560b93a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b5615a240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777b5647be00>]}
[0m14:32:03.511474 [debug] [MainThread]: Flushing usage events
[0m14:32:04.149881 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:52:55.717294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cd5bf5580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cd567ca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cd66d0770>]}


============================== 14:52:55.734413 | ca38de65-6c10-4f05-942c-9a6e9585e430 ==============================
[0m14:52:55.734413 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:52:55.736423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:52:56.369155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca38de65-6c10-4f05-942c-9a6e9585e430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cd5d510a0>]}
[0m14:52:56.610520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca38de65-6c10-4f05-942c-9a6e9585e430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cd564b4d0>]}
[0m14:52:56.612599 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:52:56.927837 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:52:57.317562 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:52:57.318611 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:52:57.477296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca38de65-6c10-4f05-942c-9a6e9585e430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cd3d2ac90>]}
[0m14:52:57.685177 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:52:57.698325 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:52:57.821718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca38de65-6c10-4f05-942c-9a6e9585e430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cd3a243b0>]}
[0m14:52:57.822759 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m14:52:57.823718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca38de65-6c10-4f05-942c-9a6e9585e430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cd5492d80>]}
[0m14:52:57.829291 [info ] [MainThread]: 
[0m14:52:57.834537 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:52:57.838430 [info ] [MainThread]: 
[0m14:52:57.841045 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:57.868578 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:52:58.163664 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:52:58.165584 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:52:58.168940 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:58.309360 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.142 seconds
[0m14:52:58.315773 [debug] [ThreadPool]: On list_db: Close
[0m14:52:58.323602 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m14:52:58.345672 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:52:58.346590 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m14:52:58.347406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:58.366046 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m14:52:58.367305 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:52:58.368387 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:52:58.391321 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.022 seconds
[0m14:52:58.394779 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m14:52:58.396623 [debug] [ThreadPool]: On list_db_dev: Close
[0m14:52:58.418819 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:58.420305 [debug] [MainThread]: On master: BEGIN
[0m14:52:58.421132 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:58.440818 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m14:52:58.442051 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:58.443590 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:58.492606 [debug] [MainThread]: SQL status: SELECT 0 in 0.048 seconds
[0m14:52:58.497392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca38de65-6c10-4f05-942c-9a6e9585e430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cd36b7fe0>]}
[0m14:52:58.499825 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:58.501887 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:58.503196 [debug] [MainThread]: On master: BEGIN
[0m14:52:58.509817 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:52:58.513731 [debug] [MainThread]: On master: COMMIT
[0m14:52:58.516221 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:58.518167 [debug] [MainThread]: On master: COMMIT
[0m14:52:58.521120 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:52:58.522845 [debug] [MainThread]: On master: Close
[0m14:52:58.545055 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m14:52:58.547574 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m14:52:58.554268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m14:52:58.556580 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m14:52:58.602601 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m14:52:58.606555 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m14:52:58.732943 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m14:52:58.736345 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:52:58.738002 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m14:52:58.739820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:58.759059 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m14:52:58.760470 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:52:58.761538 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m14:52:58.814552 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.051 seconds
[0m14:52:58.831156 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:52:58.832005 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m14:52:58.835479 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:52:58.841678 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:52:58.842680 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m14:52:58.844394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:52:58.883885 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m14:52:58.884692 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:52:58.885466 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m14:52:58.891285 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m14:52:58.907319 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m14:52:58.920308 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:52:58.921282 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m14:52:58.946949 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.025 seconds
[0m14:52:58.952330 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m14:52:58.956347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca38de65-6c10-4f05-942c-9a6e9585e430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cd72fe570>]}
[0m14:52:58.957867 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.40s]
[0m14:52:58.960660 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m14:52:58.963756 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m14:52:58.968262 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m14:52:58.966328 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m14:52:58.976389 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m14:52:58.970936 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m14:52:58.978952 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m14:52:58.981282 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m14:52:58.993634 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m14:52:58.995271 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m14:52:59.005963 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m14:52:59.009125 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m14:52:59.025377 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m14:52:59.026607 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m14:52:59.039334 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m14:52:59.043122 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:52:59.044947 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m14:52:59.047737 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:52:59.049236 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:52:59.051395 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m14:52:59.054521 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:52:59.084297 [debug] [Thread-3 (]: SQL status: BEGIN in 0.035 seconds
[0m14:52:59.086734 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:52:59.089207 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m14:52:59.096276 [debug] [Thread-4 (]: SQL status: BEGIN in 0.041 seconds
[0m14:52:59.098570 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:52:59.100977 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m14:52:59.129507 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.026 seconds
[0m14:52:59.140637 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:52:59.141734 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.051 seconds
[0m14:52:59.143162 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m14:52:59.152873 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:52:59.154434 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m14:52:59.155758 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:52:59.163733 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:52:59.164690 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m14:52:59.165745 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m14:52:59.177576 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:52:59.179169 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m14:52:59.180474 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:52:59.184964 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:52:59.186041 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:52:59.186882 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:52:59.191626 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m14:52:59.192792 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:52:59.193860 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:52:59.195206 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m14:52:59.200914 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m14:52:59.206904 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m14:52:59.208124 [debug] [Thread-3 (]: SQL status: COMMIT in 0.012 seconds
[0m14:52:59.209588 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:52:59.215044 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m14:52:59.216241 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m14:52:59.217906 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:52:59.219272 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m14:52:59.228866 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.009 seconds
[0m14:52:59.229771 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.011 seconds
[0m14:52:59.232492 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m14:52:59.235804 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m14:52:59.237638 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca38de65-6c10-4f05-942c-9a6e9585e430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cd02d3aa0>]}
[0m14:52:59.239326 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ca38de65-6c10-4f05-942c-9a6e9585e430', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cd02d2e40>]}
[0m14:52:59.241210 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.26s]
[0m14:52:59.244461 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.26s]
[0m14:52:59.247420 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m14:52:59.249424 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m14:52:59.256780 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:59.257679 [debug] [MainThread]: On master: BEGIN
[0m14:52:59.258637 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:52:59.277786 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m14:52:59.279814 [debug] [MainThread]: On master: COMMIT
[0m14:52:59.280900 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:59.281909 [debug] [MainThread]: On master: COMMIT
[0m14:52:59.283577 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:52:59.285044 [debug] [MainThread]: On master: Close
[0m14:52:59.287236 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:52:59.288591 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m14:52:59.290008 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m14:52:59.292295 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m14:52:59.294540 [info ] [MainThread]: 
[0m14:52:59.298875 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.45 seconds (1.45s).
[0m14:52:59.303480 [debug] [MainThread]: Command end result
[0m14:52:59.383134 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:52:59.387592 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:52:59.402810 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:52:59.404195 [info ] [MainThread]: 
[0m14:52:59.405554 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:52:59.406929 [info ] [MainThread]: 
[0m14:52:59.408499 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:52:59.412800 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.9012399, "process_in_blocks": "768", "process_kernel_time": 3.809018, "process_mem_max_rss": "106924", "process_out_blocks": "1784", "process_user_time": 7.062891}
[0m14:52:59.414776 [debug] [MainThread]: Command `dbt run` succeeded at 14:52:59.414280 after 3.90 seconds
[0m14:52:59.416229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cd7584380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cd2bb03e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x769cd2bb0980>]}
[0m14:52:59.417724 [debug] [MainThread]: Flushing usage events
[0m14:53:00.161261 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:53:31.664457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74704d8b3020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74704f30c350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74704d79ca70>]}


============================== 14:53:31.684107 | c5432275-7381-4b08-bc03-0d14b949f0ac ==============================
[0m14:53:31.684107 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:53:31.686906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:53:32.270066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5432275-7381-4b08-bc03-0d14b949f0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74704d2d3380>]}
[0m14:53:32.439080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5432275-7381-4b08-bc03-0d14b949f0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74704f13c1d0>]}
[0m14:53:32.441082 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:53:32.663222 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:53:32.949027 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:53:32.950218 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:53:33.068317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5432275-7381-4b08-bc03-0d14b949f0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74704baf3dd0>]}
[0m14:53:33.257482 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:53:33.264548 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:53:33.345071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5432275-7381-4b08-bc03-0d14b949f0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74704b7e4dd0>]}
[0m14:53:33.346503 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m14:53:33.348011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5432275-7381-4b08-bc03-0d14b949f0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74704baf1a00>]}
[0m14:53:33.355884 [info ] [MainThread]: 
[0m14:53:33.357533 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:53:33.359544 [info ] [MainThread]: 
[0m14:53:33.362486 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:53:33.397151 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:53:33.534594 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:53:33.535645 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:53:33.536601 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:33.593133 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.057 seconds
[0m14:53:33.595962 [debug] [ThreadPool]: On list_db: Close
[0m14:53:33.601079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m14:53:33.620452 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:53:33.621741 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m14:53:33.622922 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:33.666659 [debug] [ThreadPool]: SQL status: BEGIN in 0.044 seconds
[0m14:53:33.667964 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:53:33.669274 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:53:33.734605 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.064 seconds
[0m14:53:33.737667 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m14:53:33.739091 [debug] [ThreadPool]: On list_db_dev: Close
[0m14:53:33.754456 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:33.755541 [debug] [MainThread]: On master: BEGIN
[0m14:53:33.756858 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:53:33.797031 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m14:53:33.798690 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:33.800822 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:53:33.857023 [debug] [MainThread]: SQL status: SELECT 0 in 0.054 seconds
[0m14:53:33.861977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5432275-7381-4b08-bc03-0d14b949f0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74704b8b56d0>]}
[0m14:53:33.863855 [debug] [MainThread]: On master: ROLLBACK
[0m14:53:33.865407 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:33.866437 [debug] [MainThread]: On master: BEGIN
[0m14:53:33.869030 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:53:33.870883 [debug] [MainThread]: On master: COMMIT
[0m14:53:33.872012 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:33.873200 [debug] [MainThread]: On master: COMMIT
[0m14:53:33.875191 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:53:33.876556 [debug] [MainThread]: On master: Close
[0m14:53:33.891190 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m14:53:33.894527 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m14:53:33.898014 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m14:53:33.902256 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m14:53:33.933186 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m14:53:33.936362 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m14:53:34.065572 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m14:53:34.068040 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:53:34.071122 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m14:53:34.073624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:34.164205 [debug] [Thread-1 (]: SQL status: BEGIN in 0.091 seconds
[0m14:53:34.165996 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:53:34.167767 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m14:53:34.271380 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.102 seconds
[0m14:53:34.296031 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:53:34.299407 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m14:53:34.307402 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:53:34.320226 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:53:34.322639 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m14:53:34.325691 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:53:34.402624 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m14:53:34.404148 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:53:34.405569 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m14:53:34.411192 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:53:34.435623 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m14:53:34.452985 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:53:34.454999 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m14:53:34.474398 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.018 seconds
[0m14:53:34.482619 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m14:53:34.488050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5432275-7381-4b08-bc03-0d14b949f0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74704de52360>]}
[0m14:53:34.490719 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.59s]
[0m14:53:34.493118 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m14:53:34.496679 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m14:53:34.498207 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m14:53:34.500287 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m14:53:34.502704 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m14:53:34.505842 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m14:53:34.508327 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m14:53:34.510515 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m14:53:34.516250 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m14:53:34.542090 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m14:53:34.549886 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m14:53:34.552805 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m14:53:34.554119 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m14:53:34.561987 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m14:53:34.570939 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m14:53:34.573190 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:53:34.574175 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:53:34.575738 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m14:53:34.577190 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m14:53:34.578527 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:53:34.580050 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:53:34.597555 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m14:53:34.599328 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:53:34.600903 [debug] [Thread-4 (]: SQL status: BEGIN in 0.021 seconds
[0m14:53:34.602385 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m14:53:34.603726 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:53:34.605620 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m14:53:34.635341 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.030 seconds
[0m14:53:34.645175 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:53:34.646450 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m14:53:34.649137 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:53:34.650298 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.043 seconds
[0m14:53:34.658704 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:53:34.675202 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:53:34.676446 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m14:53:34.677722 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m14:53:34.680289 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:53:34.681668 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:53:34.690973 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:53:34.696949 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m14:53:34.698268 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m14:53:34.699562 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:53:34.701200 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m14:53:34.702556 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:53:34.710358 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:53:34.711389 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:53:34.712366 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:53:34.713940 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m14:53:34.720250 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m14:53:34.721453 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m14:53:34.723013 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:53:34.737273 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m14:53:34.746575 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m14:53:34.751334 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:53:34.752336 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.008 seconds
[0m14:53:34.753270 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m14:53:34.756602 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m14:53:34.758964 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5432275-7381-4b08-bc03-0d14b949f0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747048093e60>]}
[0m14:53:34.761097 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.25s]
[0m14:53:34.762721 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m14:53:34.764583 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m14:53:34.767847 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m14:53:34.769625 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5432275-7381-4b08-bc03-0d14b949f0ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74704a991670>]}
[0m14:53:34.771653 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.26s]
[0m14:53:34.774475 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m14:53:34.789491 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:34.792467 [debug] [MainThread]: On master: BEGIN
[0m14:53:34.795568 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:53:34.890801 [debug] [MainThread]: SQL status: BEGIN in 0.096 seconds
[0m14:53:34.892488 [debug] [MainThread]: On master: COMMIT
[0m14:53:34.894291 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:34.895735 [debug] [MainThread]: On master: COMMIT
[0m14:53:34.898684 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:53:34.902719 [debug] [MainThread]: On master: Close
[0m14:53:34.905669 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:34.908369 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m14:53:34.911163 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m14:53:34.913750 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m14:53:34.920566 [info ] [MainThread]: 
[0m14:53:34.924464 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m14:53:34.939803 [debug] [MainThread]: Command end result
[0m14:53:35.033119 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:53:35.036769 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:53:35.052160 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:53:35.053166 [info ] [MainThread]: 
[0m14:53:35.054121 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:53:35.055458 [info ] [MainThread]: 
[0m14:53:35.057024 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:53:35.060097 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.508845, "process_in_blocks": "640", "process_kernel_time": 1.767841, "process_mem_max_rss": "108132", "process_out_blocks": "3400", "process_user_time": 6.079453}
[0m14:53:35.061967 [debug] [MainThread]: Command `dbt run` succeeded at 14:53:35.061616 after 3.51 seconds
[0m14:53:35.063131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74704d608860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74704dc91d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74704d38d1f0>]}
[0m14:53:35.064347 [debug] [MainThread]: Flushing usage events
[0m14:53:35.667291 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:02:34.218056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a73b4e0800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a73aa24680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a73ad04ef0>]}


============================== 15:02:34.232891 | 3977e30a-257e-44f6-a4cb-1a813442aa89 ==============================
[0m15:02:34.232891 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:02:34.235272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:02:35.157166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3977e30a-257e-44f6-a4cb-1a813442aa89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a73a83b7d0>]}
[0m15:02:35.649364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3977e30a-257e-44f6-a4cb-1a813442aa89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a73c7cc1a0>]}
[0m15:02:35.653237 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:02:36.294582 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:02:36.734213 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:02:36.735314 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:02:36.827916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3977e30a-257e-44f6-a4cb-1a813442aa89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a73907e4e0>]}
[0m15:02:37.083183 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:02:37.089187 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:02:37.171696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3977e30a-257e-44f6-a4cb-1a813442aa89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a738c80350>]}
[0m15:02:37.173548 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:02:37.177833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3977e30a-257e-44f6-a4cb-1a813442aa89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a738d150a0>]}
[0m15:02:37.185153 [info ] [MainThread]: 
[0m15:02:37.187109 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:02:37.191649 [info ] [MainThread]: 
[0m15:02:37.199651 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:02:37.227200 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:02:37.474163 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:02:37.475182 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:02:37.476085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:37.575711 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.100 seconds
[0m15:02:37.578690 [debug] [ThreadPool]: On list_db: Close
[0m15:02:37.582864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m15:02:37.597674 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:02:37.598487 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m15:02:37.599258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:02:37.627243 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m15:02:37.628414 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:02:37.629926 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:02:37.674521 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.043 seconds
[0m15:02:37.678680 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m15:02:37.680545 [debug] [ThreadPool]: On list_db_dev: Close
[0m15:02:37.699299 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:37.700458 [debug] [MainThread]: On master: BEGIN
[0m15:02:37.703202 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:02:37.726995 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m15:02:37.728795 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:37.730621 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:02:37.781474 [debug] [MainThread]: SQL status: SELECT 0 in 0.049 seconds
[0m15:02:37.785271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3977e30a-257e-44f6-a4cb-1a813442aa89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a738d17530>]}
[0m15:02:37.786929 [debug] [MainThread]: On master: ROLLBACK
[0m15:02:37.788736 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:37.789877 [debug] [MainThread]: On master: BEGIN
[0m15:02:37.791902 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:02:37.793512 [debug] [MainThread]: On master: COMMIT
[0m15:02:37.794490 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:37.795743 [debug] [MainThread]: On master: COMMIT
[0m15:02:37.797723 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:02:37.799141 [debug] [MainThread]: On master: Close
[0m15:02:37.815401 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m15:02:37.818688 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m15:02:37.821331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m15:02:37.822922 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m15:02:37.858374 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m15:02:37.866114 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m15:02:37.979901 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m15:02:37.983958 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:02:37.985530 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m15:02:37.988147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:02:38.009268 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m15:02:38.010959 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:02:38.012195 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m15:02:38.082926 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.069 seconds
[0m15:02:38.106059 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:02:38.107596 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m15:02:38.113127 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:02:38.124244 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:02:38.125935 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m15:02:38.128990 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:02:38.230283 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:02:38.232231 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:02:38.234485 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:02:38.241953 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m15:02:38.274783 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m15:02:38.292502 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:02:38.293858 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m15:02:38.307833 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m15:02:38.316344 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m15:02:38.326385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3977e30a-257e-44f6-a4cb-1a813442aa89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a73c54a0f0>]}
[0m15:02:38.328711 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.50s]
[0m15:02:38.331723 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m15:02:38.335637 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m15:02:38.337557 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m15:02:38.339888 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m15:02:38.351535 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m15:02:38.353476 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m15:02:38.342576 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m15:02:38.367752 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m15:02:38.376607 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m15:02:38.380984 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m15:02:38.407316 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m15:02:38.410991 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m15:02:38.425031 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m15:02:38.427331 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m15:02:38.442749 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m15:02:38.449733 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:02:38.451622 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m15:02:38.453444 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:02:38.454838 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:02:38.456368 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m15:02:38.458865 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:02:38.487804 [debug] [Thread-3 (]: SQL status: BEGIN in 0.033 seconds
[0m15:02:38.489524 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:02:38.491180 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m15:02:38.493061 [debug] [Thread-4 (]: SQL status: BEGIN in 0.034 seconds
[0m15:02:38.494191 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:02:38.495786 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m15:02:38.521946 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.025 seconds
[0m15:02:38.531023 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:02:38.533734 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.041 seconds
[0m15:02:38.535002 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m15:02:38.542500 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:02:38.543952 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m15:02:38.545118 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:02:38.553383 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m15:02:38.556448 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:02:38.573379 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:02:38.574910 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m15:02:38.576433 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m15:02:38.578990 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:02:38.580467 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:02:38.585996 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:02:38.592283 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:02:38.593947 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:02:38.595342 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:02:38.597664 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:02:38.599288 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:02:38.606536 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m15:02:38.614931 [debug] [Thread-3 (]: SQL status: COMMIT in 0.013 seconds
[0m15:02:38.617520 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m15:02:38.624133 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m15:02:38.626574 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:02:38.629562 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:02:38.631034 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m15:02:38.633397 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m15:02:38.641566 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:02:38.646507 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m15:02:38.647758 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.012 seconds
[0m15:02:38.651799 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m15:02:38.653521 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3977e30a-257e-44f6-a4cb-1a813442aa89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a733ef5a00>]}
[0m15:02:38.657574 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3977e30a-257e-44f6-a4cb-1a813442aa89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a733ef5190>]}
[0m15:02:38.655826 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.29s]
[0m15:02:38.660104 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.31s]
[0m15:02:38.662496 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m15:02:38.665058 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m15:02:38.672824 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:38.674859 [debug] [MainThread]: On master: BEGIN
[0m15:02:38.678175 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:02:38.717482 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m15:02:38.719207 [debug] [MainThread]: On master: COMMIT
[0m15:02:38.721167 [debug] [MainThread]: Using postgres connection "master"
[0m15:02:38.722944 [debug] [MainThread]: On master: COMMIT
[0m15:02:38.725306 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:02:38.726920 [debug] [MainThread]: On master: Close
[0m15:02:38.730688 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:38.735270 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m15:02:38.739700 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m15:02:38.741184 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m15:02:38.742878 [info ] [MainThread]: 
[0m15:02:38.744798 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m15:02:38.760040 [debug] [MainThread]: Command end result
[0m15:02:38.882035 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:02:38.887184 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:02:38.912420 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:02:38.913627 [info ] [MainThread]: 
[0m15:02:38.915337 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:02:38.917830 [info ] [MainThread]: 
[0m15:02:38.920925 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:02:38.926388 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.092521, "process_in_blocks": "115256", "process_kernel_time": 3.264208, "process_mem_max_rss": "106876", "process_out_blocks": "1792", "process_user_time": 8.166665}
[0m15:02:38.929077 [debug] [MainThread]: Command `dbt run` succeeded at 15:02:38.928417 after 5.10 seconds
[0m15:02:38.930706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a73a91ebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a738d136e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a73ac675c0>]}
[0m15:02:38.932903 [debug] [MainThread]: Flushing usage events
[0m15:02:39.714360 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:14:21.118830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfb2a09430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfb2a0a000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfb2a08410>]}


============================== 15:14:21.167700 | 8709caba-b534-4039-bd8f-ac8984f7009f ==============================
[0m15:14:21.167700 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:14:21.169860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:14:22.103731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8709caba-b534-4039-bd8f-ac8984f7009f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfb063b440>]}
[0m15:14:22.318738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8709caba-b534-4039-bd8f-ac8984f7009f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfb1dabda0>]}
[0m15:14:22.321467 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:14:22.704978 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:14:23.539257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:14:23.541346 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:14:23.909822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8709caba-b534-4039-bd8f-ac8984f7009f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfb0404290>]}
[0m15:14:24.477071 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:14:24.487343 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:14:24.636429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8709caba-b534-4039-bd8f-ac8984f7009f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfb01dc050>]}
[0m15:14:24.637995 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:14:24.639612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8709caba-b534-4039-bd8f-ac8984f7009f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfb02b5220>]}
[0m15:14:24.647804 [info ] [MainThread]: 
[0m15:14:24.649850 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:14:24.651825 [info ] [MainThread]: 
[0m15:14:24.654692 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:14:24.695085 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:14:25.133015 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:14:25.134599 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:14:25.135835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:25.486507 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.351 seconds
[0m15:14:25.489433 [debug] [ThreadPool]: On list_db: Close
[0m15:14:25.493463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m15:14:25.507037 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:14:25.508049 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m15:14:25.508865 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:14:25.540985 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m15:14:25.541985 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:14:25.543148 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:14:25.640022 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.095 seconds
[0m15:14:25.643662 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m15:14:25.645295 [debug] [ThreadPool]: On list_db_dev: Close
[0m15:14:25.663675 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:25.665878 [debug] [MainThread]: On master: BEGIN
[0m15:14:25.667331 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:25.723959 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m15:14:25.725471 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:25.727139 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:14:25.865168 [debug] [MainThread]: SQL status: SELECT 0 in 0.137 seconds
[0m15:14:25.869872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8709caba-b534-4039-bd8f-ac8984f7009f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfb0247b60>]}
[0m15:14:25.871609 [debug] [MainThread]: On master: ROLLBACK
[0m15:14:25.873632 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:25.874761 [debug] [MainThread]: On master: BEGIN
[0m15:14:25.877068 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:14:25.878738 [debug] [MainThread]: On master: COMMIT
[0m15:14:25.880452 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:25.881554 [debug] [MainThread]: On master: COMMIT
[0m15:14:25.883415 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:14:25.884961 [debug] [MainThread]: On master: Close
[0m15:14:25.899807 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m15:14:25.908243 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m15:14:25.911767 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m15:14:25.913870 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m15:14:25.949242 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m15:14:25.956880 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m15:14:26.082357 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m15:14:26.090803 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:14:26.092286 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m15:14:26.093554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:14:26.121965 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m15:14:26.123699 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:14:26.124987 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m15:14:26.217717 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.091 seconds
[0m15:14:26.256007 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:14:26.257431 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m15:14:26.261509 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:14:26.269744 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:14:26.270987 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m15:14:26.273529 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:14:26.334377 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:14:26.335486 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:14:26.336508 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:14:26.341491 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:14:26.357875 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m15:14:26.372592 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:14:26.373630 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m15:14:26.396253 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.021 seconds
[0m15:14:26.419379 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m15:14:26.438119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8709caba-b534-4039-bd8f-ac8984f7009f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfb3afe240>]}
[0m15:14:26.444033 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.51s]
[0m15:14:26.452883 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m15:14:26.458005 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m15:14:26.460992 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m15:14:26.463970 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m15:14:26.468316 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m15:14:26.480220 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m15:14:26.485754 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m15:14:26.488592 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m15:14:26.501271 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m15:14:26.526204 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m15:14:26.544861 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m15:14:26.549097 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m15:14:26.551312 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m15:14:26.577106 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m15:14:26.580538 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m15:14:26.584505 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:14:26.585966 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m15:14:26.588006 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:14:26.589337 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:14:26.590952 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m15:14:26.593225 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:14:26.622984 [debug] [Thread-4 (]: SQL status: BEGIN in 0.030 seconds
[0m15:14:26.624639 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:14:26.626259 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m15:14:26.639607 [debug] [Thread-3 (]: SQL status: BEGIN in 0.047 seconds
[0m15:14:26.642153 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:14:26.644164 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m15:14:26.652155 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.023 seconds
[0m15:14:26.671688 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:14:26.675085 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m15:14:26.680159 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:14:26.693378 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:14:26.695384 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.049 seconds
[0m15:14:26.696855 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m15:14:26.713067 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:14:26.716805 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m15:14:26.718684 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:14:26.726930 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m15:14:26.728159 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:14:26.736324 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:14:26.759764 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:14:26.767880 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:14:26.770046 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m15:14:26.773335 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:14:26.777590 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m15:14:26.801059 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:14:26.809677 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:14:26.814149 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m15:14:26.817039 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:14:26.825132 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:14:26.829261 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m15:14:26.834066 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m15:14:26.846973 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.016 seconds
[0m15:14:26.855741 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m15:14:26.853829 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m15:14:26.860392 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:14:26.862778 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m15:14:26.865003 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8709caba-b534-4039-bd8f-ac8984f7009f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfaf55c5c0>]}
[0m15:14:26.869603 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.38s]
[0m15:14:26.873284 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m15:14:26.880471 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.013 seconds
[0m15:14:26.888719 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m15:14:26.892491 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8709caba-b534-4039-bd8f-ac8984f7009f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfac2b5b50>]}
[0m15:14:26.895882 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.42s]
[0m15:14:26.899210 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m15:14:26.906998 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:26.908996 [debug] [MainThread]: On master: BEGIN
[0m15:14:26.911583 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:14:26.966243 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m15:14:26.968206 [debug] [MainThread]: On master: COMMIT
[0m15:14:26.969721 [debug] [MainThread]: Using postgres connection "master"
[0m15:14:26.970922 [debug] [MainThread]: On master: COMMIT
[0m15:14:26.973058 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:14:26.974370 [debug] [MainThread]: On master: Close
[0m15:14:26.985598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:26.987221 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m15:14:26.989040 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m15:14:26.991195 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m15:14:26.993715 [info ] [MainThread]: 
[0m15:14:27.004682 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.34 seconds (2.34s).
[0m15:14:27.013802 [debug] [MainThread]: Command end result
[0m15:14:27.163615 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:14:27.171202 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:14:27.204466 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:14:27.205819 [info ] [MainThread]: 
[0m15:14:27.210092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:14:27.213109 [info ] [MainThread]: 
[0m15:14:27.217054 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:14:27.224189 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.9309907, "process_in_blocks": "114440", "process_kernel_time": 11.744245, "process_mem_max_rss": "106376", "process_out_blocks": "1792", "process_user_time": 9.093378}
[0m15:14:27.226929 [debug] [MainThread]: Command `dbt run` succeeded at 15:14:27.226100 after 6.93 seconds
[0m15:14:27.229368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfb3d840b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfb04cb5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76bfb28409b0>]}
[0m15:14:27.230935 [debug] [MainThread]: Flushing usage events
[0m15:14:28.071949 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:23:17.228883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763ea4832060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763ea34efc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763ea35f1910>]}


============================== 15:23:17.248088 | c8d4ca2a-5b27-429b-be7f-46b087351bfa ==============================
[0m15:23:17.248088 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:23:17.252149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:23:17.957059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8d4ca2a-5b27-429b-be7f-46b087351bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763ea309bec0>]}
[0m15:23:18.181046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8d4ca2a-5b27-429b-be7f-46b087351bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763ea11ab0b0>]}
[0m15:23:18.184362 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:23:18.487554 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:23:18.997503 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:23:18.999254 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:23:19.272320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8d4ca2a-5b27-429b-be7f-46b087351bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763ea1221760>]}
[0m15:23:19.933684 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:23:19.944956 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:23:20.097829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8d4ca2a-5b27-429b-be7f-46b087351bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763ea0dc4110>]}
[0m15:23:20.099752 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:23:20.104482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8d4ca2a-5b27-429b-be7f-46b087351bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763ea10b3d70>]}
[0m15:23:20.114007 [info ] [MainThread]: 
[0m15:23:20.115827 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:23:20.117223 [info ] [MainThread]: 
[0m15:23:20.125055 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:23:20.157192 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:23:20.556654 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:23:20.559048 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:23:20.560547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:23:20.726589 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.166 seconds
[0m15:23:20.734010 [debug] [ThreadPool]: On list_db: Close
[0m15:23:20.745366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m15:23:20.777316 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:23:20.778815 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m15:23:20.780190 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:23:20.807764 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m15:23:20.809828 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:23:20.811217 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:23:20.861084 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.049 seconds
[0m15:23:20.867220 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m15:23:20.872277 [debug] [ThreadPool]: On list_db_dev: Close
[0m15:23:20.902579 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:20.904010 [debug] [MainThread]: On master: BEGIN
[0m15:23:20.905477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:23:20.924503 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m15:23:20.927104 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:20.928673 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:23:20.985912 [debug] [MainThread]: SQL status: SELECT 0 in 0.056 seconds
[0m15:23:20.991245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8d4ca2a-5b27-429b-be7f-46b087351bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763ea10bc7d0>]}
[0m15:23:20.993429 [debug] [MainThread]: On master: ROLLBACK
[0m15:23:20.997711 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:20.999228 [debug] [MainThread]: On master: BEGIN
[0m15:23:21.002126 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:23:21.003748 [debug] [MainThread]: On master: COMMIT
[0m15:23:21.005082 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:21.006047 [debug] [MainThread]: On master: COMMIT
[0m15:23:21.007761 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:23:21.009048 [debug] [MainThread]: On master: Close
[0m15:23:21.027879 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m15:23:21.030643 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m15:23:21.032923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m15:23:21.036112 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m15:23:21.063510 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m15:23:21.069304 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m15:23:21.244978 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m15:23:21.251079 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:23:21.254934 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m15:23:21.256618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:23:21.281140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m15:23:21.282732 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:23:21.284274 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m15:23:21.349893 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.064 seconds
[0m15:23:21.371162 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:23:21.372735 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m15:23:21.377348 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:23:21.388170 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:23:21.389368 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m15:23:21.391641 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:21.465190 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:23:21.466411 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:23:21.467701 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:23:21.474231 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m15:23:21.494836 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m15:23:21.520291 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:23:21.522530 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m15:23:21.539026 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m15:23:21.547941 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m15:23:21.558321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8d4ca2a-5b27-429b-be7f-46b087351bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763ea46e6330>]}
[0m15:23:21.561036 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.52s]
[0m15:23:21.564575 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m15:23:21.568250 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m15:23:21.570674 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m15:23:21.574132 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m15:23:21.576958 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m15:23:21.579783 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m15:23:21.587651 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m15:23:21.591057 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m15:23:21.593445 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m15:23:21.627478 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m15:23:21.632884 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m15:23:21.642423 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m15:23:21.643889 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m15:23:21.657782 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m15:23:21.677058 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m15:23:21.680509 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:23:21.682812 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m15:23:21.684417 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:23:21.685985 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:23:21.688522 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m15:23:21.690011 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:23:21.717272 [debug] [Thread-3 (]: SQL status: BEGIN in 0.027 seconds
[0m15:23:21.719194 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:23:21.720803 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m15:23:21.722875 [debug] [Thread-4 (]: SQL status: BEGIN in 0.038 seconds
[0m15:23:21.724507 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:23:21.726608 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m15:23:21.775651 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.047 seconds
[0m15:23:21.785976 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:23:21.788058 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m15:23:21.790252 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:21.800859 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:23:21.802022 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m15:23:21.805103 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:21.811886 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:23:21.815423 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:23:21.817160 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.095 seconds
[0m15:23:21.818960 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:23:21.833154 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:23:21.835055 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m15:23:21.837613 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:21.851780 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:23:21.853053 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m15:23:21.855510 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:23:21.860377 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:23:21.861450 [debug] [Thread-4 (]: SQL status: COMMIT in 0.027 seconds
[0m15:23:21.863323 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:23:21.869826 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m15:23:21.871594 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:23:21.874131 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:23:21.876762 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m15:23:21.895442 [debug] [Thread-3 (]: SQL status: COMMIT in 0.019 seconds
[0m15:23:21.909110 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m15:23:21.911690 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:23:21.912795 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m15:23:21.921646 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.043 seconds
[0m15:23:21.926328 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m15:23:21.928438 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8d4ca2a-5b27-429b-be7f-46b087351bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763e9bfd48c0>]}
[0m15:23:21.930036 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.34s]
[0m15:23:21.931782 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m15:23:21.942858 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.029 seconds
[0m15:23:21.946897 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m15:23:21.949315 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8d4ca2a-5b27-429b-be7f-46b087351bfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763e9bfe38c0>]}
[0m15:23:21.952105 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.37s]
[0m15:23:21.962066 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m15:23:21.971143 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:21.972824 [debug] [MainThread]: On master: BEGIN
[0m15:23:21.974342 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:22.003467 [debug] [MainThread]: SQL status: BEGIN in 0.029 seconds
[0m15:23:22.005451 [debug] [MainThread]: On master: COMMIT
[0m15:23:22.007092 [debug] [MainThread]: Using postgres connection "master"
[0m15:23:22.008360 [debug] [MainThread]: On master: COMMIT
[0m15:23:22.010721 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:23:22.012121 [debug] [MainThread]: On master: Close
[0m15:23:22.014131 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:22.015668 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m15:23:22.016821 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m15:23:22.018065 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m15:23:22.019866 [info ] [MainThread]: 
[0m15:23:22.021789 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.90 seconds (1.90s).
[0m15:23:22.031748 [debug] [MainThread]: Command end result
[0m15:23:22.130055 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:23:22.138623 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:23:22.168419 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:23:22.169521 [info ] [MainThread]: 
[0m15:23:22.176451 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:23:22.179524 [info ] [MainThread]: 
[0m15:23:22.182629 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:23:22.194682 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.293901, "process_in_blocks": "116768", "process_kernel_time": 2.862477, "process_mem_max_rss": "106312", "process_out_blocks": "1792", "process_user_time": 7.915583}
[0m15:23:22.197576 [debug] [MainThread]: Command `dbt run` succeeded at 15:23:22.196884 after 5.30 seconds
[0m15:23:22.200352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763ea29211c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763ea29217c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763ea0e752b0>]}
[0m15:23:22.205454 [debug] [MainThread]: Flushing usage events
[0m15:23:22.937105 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:34:29.868773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79956c27cbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79956ad609e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79956a4da7e0>]}


============================== 15:34:29.884195 | 0ac2fe31-a116-4a41-a074-9845854c6509 ==============================
[0m15:34:29.884195 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:34:29.889886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:34:30.650047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ac2fe31-a116-4a41-a074-9845854c6509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79956a0f4230>]}
[0m15:34:30.912123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ac2fe31-a116-4a41-a074-9845854c6509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79956a5fe3c0>]}
[0m15:34:30.916214 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:34:31.360669 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:34:31.860896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:34:31.861868 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:34:32.007901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ac2fe31-a116-4a41-a074-9845854c6509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7995689bd1c0>]}
[0m15:34:32.301382 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:34:32.307849 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:34:32.389145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ac2fe31-a116-4a41-a074-9845854c6509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7995686b4230>]}
[0m15:34:32.390244 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:34:32.391332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ac2fe31-a116-4a41-a074-9845854c6509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79956870f3e0>]}
[0m15:34:32.397651 [info ] [MainThread]: 
[0m15:34:32.399029 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:34:32.400508 [info ] [MainThread]: 
[0m15:34:32.402938 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:34:32.425637 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:34:32.690606 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:34:32.692042 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:34:32.693315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:32.860401 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.167 seconds
[0m15:34:32.864470 [debug] [ThreadPool]: On list_db: Close
[0m15:34:32.868255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m15:34:32.882011 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:34:32.882816 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m15:34:32.883724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:32.903743 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m15:34:32.905131 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:34:32.906079 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:34:32.956621 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.050 seconds
[0m15:34:32.959869 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m15:34:32.961878 [debug] [ThreadPool]: On list_db_dev: Close
[0m15:34:32.978046 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:32.981211 [debug] [MainThread]: On master: BEGIN
[0m15:34:32.982502 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:34:32.999925 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m15:34:33.001082 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:33.002700 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:34:33.053450 [debug] [MainThread]: SQL status: SELECT 0 in 0.049 seconds
[0m15:34:33.057980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ac2fe31-a116-4a41-a074-9845854c6509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799567938b30>]}
[0m15:34:33.059500 [debug] [MainThread]: On master: ROLLBACK
[0m15:34:33.061062 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:33.062001 [debug] [MainThread]: On master: BEGIN
[0m15:34:33.064938 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:34:33.066648 [debug] [MainThread]: On master: COMMIT
[0m15:34:33.068152 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:33.069519 [debug] [MainThread]: On master: COMMIT
[0m15:34:33.071318 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:34:33.072273 [debug] [MainThread]: On master: Close
[0m15:34:33.081919 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m15:34:33.083764 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m15:34:33.087309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m15:34:33.091613 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m15:34:33.127532 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m15:34:33.132945 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m15:34:33.294780 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m15:34:33.301402 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:34:33.302755 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m15:34:33.304882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:33.331809 [debug] [Thread-1 (]: SQL status: BEGIN in 0.027 seconds
[0m15:34:33.333825 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:34:33.337052 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m15:34:33.431019 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.089 seconds
[0m15:34:33.452040 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:34:33.453411 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m15:34:33.458086 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m15:34:33.466299 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:34:33.467842 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m15:34:33.471893 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:34:33.541721 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:34:33.544080 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:34:33.547317 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:34:33.554851 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m15:34:33.591387 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m15:34:33.624157 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:34:33.625567 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m15:34:33.641360 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m15:34:33.650252 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m15:34:33.658310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ac2fe31-a116-4a41-a074-9845854c6509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7995678ed7c0>]}
[0m15:34:33.660739 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.57s]
[0m15:34:33.664683 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m15:34:33.668587 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m15:34:33.670346 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m15:34:33.673196 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m15:34:33.676107 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m15:34:33.679594 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m15:34:33.682587 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m15:34:33.684979 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m15:34:33.693114 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m15:34:33.711442 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m15:34:33.727946 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m15:34:33.732185 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m15:34:33.733575 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m15:34:33.743958 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m15:34:33.753713 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m15:34:33.757492 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:34:33.758826 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:34:33.760507 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m15:34:33.762040 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m15:34:33.763317 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:34:33.764443 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:34:33.787228 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m15:34:33.789242 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:34:33.790770 [debug] [Thread-4 (]: SQL status: BEGIN in 0.026 seconds
[0m15:34:33.793450 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m15:34:33.795550 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:34:33.797445 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m15:34:33.823595 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.024 seconds
[0m15:34:33.842360 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:34:33.844711 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.047 seconds
[0m15:34:33.847698 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m15:34:33.857598 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:34:33.861098 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m15:34:33.862526 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:34:33.870768 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m15:34:33.874822 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:34:33.891729 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:34:33.893127 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m15:34:33.894537 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m15:34:33.897191 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:34:33.898561 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:34:33.904070 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:34:33.908614 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:34:33.910007 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:34:33.911641 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:34:33.912825 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:34:33.914030 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:34:33.920243 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m15:34:33.927506 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m15:34:33.928725 [debug] [Thread-3 (]: SQL status: COMMIT in 0.013 seconds
[0m15:34:33.931501 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:34:33.938874 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m15:34:33.941483 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m15:34:33.944251 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:34:33.946299 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m15:34:33.952886 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m15:34:33.957035 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m15:34:33.958304 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.010 seconds
[0m15:34:33.960184 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ac2fe31-a116-4a41-a074-9845854c6509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799564760710>]}
[0m15:34:33.965508 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m15:34:33.968271 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.28s]
[0m15:34:33.970909 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m15:34:33.972736 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ac2fe31-a116-4a41-a074-9845854c6509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7995647522a0>]}
[0m15:34:33.975573 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.29s]
[0m15:34:33.977682 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m15:34:33.983451 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:33.984791 [debug] [MainThread]: On master: BEGIN
[0m15:34:33.986081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:34:34.011815 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m15:34:34.014369 [debug] [MainThread]: On master: COMMIT
[0m15:34:34.015699 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:34.016995 [debug] [MainThread]: On master: COMMIT
[0m15:34:34.019707 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:34:34.021339 [debug] [MainThread]: On master: Close
[0m15:34:34.023451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:34:34.024877 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m15:34:34.026188 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m15:34:34.028324 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m15:34:34.030587 [info ] [MainThread]: 
[0m15:34:34.033381 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.63 seconds (1.63s).
[0m15:34:34.041842 [debug] [MainThread]: Command end result
[0m15:34:34.131917 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:34:34.135686 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:34:34.154001 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:34:34.155216 [info ] [MainThread]: 
[0m15:34:34.156647 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:34:34.158254 [info ] [MainThread]: 
[0m15:34:34.159795 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:34:34.165156 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.6697288, "process_in_blocks": "113648", "process_kernel_time": 4.466305, "process_mem_max_rss": "106656", "process_out_blocks": "1792", "process_user_time": 9.350413}
[0m15:34:34.167161 [debug] [MainThread]: Command `dbt run` succeeded at 15:34:34.166569 after 4.67 seconds
[0m15:34:34.168937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79956c0da240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79956a4dba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79956a2db920>]}
[0m15:34:34.170434 [debug] [MainThread]: Flushing usage events
[0m15:34:34.998404 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:40:16.589872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72869ec3f830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72869eebfc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72869f2acc20>]}


============================== 15:40:16.642227 | 040bbd70-36a5-491c-87b2-376b6f70b315 ==============================
[0m15:40:16.642227 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:40:16.644945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:40:17.951193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '040bbd70-36a5-491c-87b2-376b6f70b315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72869ec6c0e0>]}
[0m15:40:18.249940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '040bbd70-36a5-491c-87b2-376b6f70b315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72869f864380>]}
[0m15:40:18.254774 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:40:18.706272 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:40:19.501149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:40:19.502527 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:40:19.611498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '040bbd70-36a5-491c-87b2-376b6f70b315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72869d316810>]}
[0m15:40:19.846128 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:40:19.853639 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:40:20.019152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '040bbd70-36a5-491c-87b2-376b6f70b315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72869d000110>]}
[0m15:40:20.020803 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:40:20.022838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '040bbd70-36a5-491c-87b2-376b6f70b315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72869cff7ec0>]}
[0m15:40:20.031076 [info ] [MainThread]: 
[0m15:40:20.033060 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:40:20.034605 [info ] [MainThread]: 
[0m15:40:20.039171 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:40:20.081001 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:40:20.741302 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:40:20.742987 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:40:20.744501 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:40:21.065738 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.321 seconds
[0m15:40:21.069021 [debug] [ThreadPool]: On list_db: Close
[0m15:40:21.075114 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m15:40:21.090707 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:40:21.091716 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m15:40:21.092622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:40:21.155661 [debug] [ThreadPool]: SQL status: BEGIN in 0.063 seconds
[0m15:40:21.157249 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:40:21.158812 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:40:21.230159 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.070 seconds
[0m15:40:21.234242 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m15:40:21.235807 [debug] [ThreadPool]: On list_db_dev: Close
[0m15:40:21.258860 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:21.260022 [debug] [MainThread]: On master: BEGIN
[0m15:40:21.261383 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:40:21.325751 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m15:40:21.327368 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:21.328775 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:40:21.459077 [debug] [MainThread]: SQL status: SELECT 0 in 0.129 seconds
[0m15:40:21.463574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '040bbd70-36a5-491c-87b2-376b6f70b315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72869c46a120>]}
[0m15:40:21.464978 [debug] [MainThread]: On master: ROLLBACK
[0m15:40:21.466679 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:21.467878 [debug] [MainThread]: On master: BEGIN
[0m15:40:21.470479 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:40:21.472928 [debug] [MainThread]: On master: COMMIT
[0m15:40:21.474462 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:21.475807 [debug] [MainThread]: On master: COMMIT
[0m15:40:21.477930 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:40:21.479266 [debug] [MainThread]: On master: Close
[0m15:40:21.500440 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m15:40:21.504454 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m15:40:21.507285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m15:40:21.509015 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m15:40:21.550811 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m15:40:21.553647 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m15:40:21.673759 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m15:40:21.675885 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:40:21.676664 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m15:40:21.677396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:40:21.720788 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m15:40:21.722362 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:40:21.723989 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m15:40:21.849302 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.124 seconds
[0m15:40:21.878644 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:40:21.880388 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m15:40:21.885758 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:40:21.897014 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:40:21.898695 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m15:40:21.901479 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:40:22.002969 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:40:22.005156 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:40:22.008238 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:40:22.017925 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m15:40:22.049505 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m15:40:22.078537 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:40:22.080259 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m15:40:22.103884 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.022 seconds
[0m15:40:22.113878 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m15:40:22.122931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '040bbd70-36a5-491c-87b2-376b6f70b315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7286a091e300>]}
[0m15:40:22.126590 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.61s]
[0m15:40:22.130244 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m15:40:22.137896 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m15:40:22.144288 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m15:40:22.146755 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m15:40:22.149300 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m15:40:22.155536 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m15:40:22.160992 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m15:40:22.166183 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m15:40:22.168742 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m15:40:22.222811 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m15:40:22.225259 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m15:40:22.229226 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m15:40:22.231370 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m15:40:22.249051 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m15:40:22.265906 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m15:40:22.269987 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:40:22.271540 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m15:40:22.273339 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:40:22.275221 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:40:22.276991 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m15:40:22.279278 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:40:22.324262 [debug] [Thread-4 (]: SQL status: BEGIN in 0.045 seconds
[0m15:40:22.326229 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:40:22.327822 [debug] [Thread-3 (]: SQL status: BEGIN in 0.052 seconds
[0m15:40:22.329527 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m15:40:22.331258 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:40:22.333760 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m15:40:22.354661 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.021 seconds
[0m15:40:22.373174 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:40:22.376048 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.040 seconds
[0m15:40:22.378200 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m15:40:22.394014 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:40:22.395637 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m15:40:22.397055 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m15:40:22.410110 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:40:22.411940 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:40:22.413998 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m15:40:22.430077 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:40:22.432126 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m15:40:22.433886 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:40:22.439487 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:40:22.441215 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m15:40:22.442529 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:40:22.447532 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:40:22.449314 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:40:22.451115 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:40:22.453353 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:40:22.456830 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m15:40:22.463827 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m15:40:22.465205 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m15:40:22.467210 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:40:22.474461 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m15:40:22.476559 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m15:40:22.479579 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:40:22.482366 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m15:40:22.488985 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.007 seconds
[0m15:40:22.494987 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m15:40:22.496617 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.013 seconds
[0m15:40:22.499505 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '040bbd70-36a5-491c-87b2-376b6f70b315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72869c2a0da0>]}
[0m15:40:22.505455 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m15:40:22.508599 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.34s]
[0m15:40:22.511875 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '040bbd70-36a5-491c-87b2-376b6f70b315', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72869c2afb60>]}
[0m15:40:22.515575 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m15:40:22.519116 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.36s]
[0m15:40:22.525952 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m15:40:22.540640 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:22.545201 [debug] [MainThread]: On master: BEGIN
[0m15:40:22.548313 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:40:22.578113 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m15:40:22.579805 [debug] [MainThread]: On master: COMMIT
[0m15:40:22.581326 [debug] [MainThread]: Using postgres connection "master"
[0m15:40:22.582773 [debug] [MainThread]: On master: COMMIT
[0m15:40:22.584328 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:40:22.585528 [debug] [MainThread]: On master: Close
[0m15:40:22.587648 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:40:22.589840 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m15:40:22.592443 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m15:40:22.598940 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m15:40:22.600851 [info ] [MainThread]: 
[0m15:40:22.603057 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m15:40:22.618616 [debug] [MainThread]: Command end result
[0m15:40:22.714366 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:40:22.720532 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:40:22.748411 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:40:22.750142 [info ] [MainThread]: 
[0m15:40:22.752070 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:40:22.754355 [info ] [MainThread]: 
[0m15:40:22.756244 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:40:22.767886 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.606403, "process_in_blocks": "116424", "process_kernel_time": 8.18127, "process_mem_max_rss": "106592", "process_out_blocks": "1784", "process_user_time": 8.842301}
[0m15:40:22.773413 [debug] [MainThread]: Command `dbt run` succeeded at 15:40:22.772789 after 6.62 seconds
[0m15:40:22.775479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72869f1449b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72869ef86ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72869d482c00>]}
[0m15:40:22.777514 [debug] [MainThread]: Flushing usage events
[0m15:40:23.975870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:08:54.245180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7942667f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794402c350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79427caa80>]}


============================== 18:08:54.337750 | 8b701ee7-4795-479f-a793-67e3634853b1 ==============================
[0m18:08:54.337750 [info ] [MainThread]: Running with dbt=1.9.0
[0m18:08:54.341317 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:08:57.358763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b701ee7-4795-479f-a793-67e3634853b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7940760d40>]}
[0m18:08:58.168627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b701ee7-4795-479f-a793-67e3634853b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7942413860>]}
[0m18:08:58.184384 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:08:59.168490 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m18:09:00.825145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:09:00.838164 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:09:01.288529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b701ee7-4795-479f-a793-67e3634853b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794081d730>]}
[0m18:09:02.198777 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m18:09:02.218312 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m18:09:02.609414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b701ee7-4795-479f-a793-67e3634853b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7940504a70>]}
[0m18:09:02.613513 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m18:09:02.615917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b701ee7-4795-479f-a793-67e3634853b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f794081efc0>]}
[0m18:09:02.633491 [info ] [MainThread]: 
[0m18:09:02.638613 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:09:02.646553 [info ] [MainThread]: 
[0m18:09:02.649128 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:09:02.696453 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m18:09:03.717736 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m18:09:03.729156 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m18:09:03.731791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:04.248383 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.516 seconds
[0m18:09:04.265232 [debug] [ThreadPool]: On list_db: Close
[0m18:09:04.272642 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m18:09:04.357095 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m18:09:04.359031 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m18:09:04.372048 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:04.435354 [debug] [ThreadPool]: SQL status: BEGIN in 0.074 seconds
[0m18:09:04.437482 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m18:09:04.445147 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m18:09:04.613119 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.166 seconds
[0m18:09:04.631306 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m18:09:04.662640 [debug] [ThreadPool]: On list_db_dev: Close
[0m18:09:04.755821 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:04.757678 [debug] [MainThread]: On master: BEGIN
[0m18:09:04.759846 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:09:04.856910 [debug] [MainThread]: SQL status: BEGIN in 0.097 seconds
[0m18:09:04.858701 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:04.861418 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:09:05.048932 [debug] [MainThread]: SQL status: SELECT 0 in 0.174 seconds
[0m18:09:05.061103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b701ee7-4795-479f-a793-67e3634853b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7940762e70>]}
[0m18:09:05.067401 [debug] [MainThread]: On master: ROLLBACK
[0m18:09:05.070793 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:05.073707 [debug] [MainThread]: On master: BEGIN
[0m18:09:05.085563 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m18:09:05.087889 [debug] [MainThread]: On master: COMMIT
[0m18:09:05.090975 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:05.093475 [debug] [MainThread]: On master: COMMIT
[0m18:09:05.107422 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:09:05.109717 [debug] [MainThread]: On master: Close
[0m18:09:05.150599 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m18:09:05.166049 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m18:09:05.169065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m18:09:05.185692 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m18:09:05.265338 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m18:09:05.269390 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m18:09:05.800883 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m18:09:05.818838 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m18:09:05.820807 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m18:09:05.822862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:05.928966 [debug] [Thread-1 (]: SQL status: BEGIN in 0.106 seconds
[0m18:09:05.942838 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m18:09:05.956963 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m18:09:06.171063 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.212 seconds
[0m18:09:06.269915 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m18:09:06.272649 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m18:09:06.292025 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m18:09:06.324080 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m18:09:06.327086 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m18:09:06.342517 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:09:06.637077 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m18:09:06.639837 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m18:09:06.642019 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m18:09:06.655501 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m18:09:06.782117 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m18:09:06.880145 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m18:09:06.882530 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m18:09:06.919327 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.024 seconds
[0m18:09:06.942312 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m18:09:06.989829 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b701ee7-4795-479f-a793-67e3634853b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7942b728a0>]}
[0m18:09:06.993178 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 1.79s]
[0m18:09:07.006631 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m18:09:07.024107 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m18:09:07.026925 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m18:09:07.029819 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m18:09:07.034027 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m18:09:07.044409 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m18:09:07.047417 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m18:09:07.050792 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m18:09:07.053778 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m18:09:07.111278 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m18:09:07.149192 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m18:09:07.156346 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m18:09:07.172044 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m18:09:07.208879 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m18:09:07.238329 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m18:09:07.255152 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m18:09:07.257528 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m18:09:07.273699 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m18:09:07.276302 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:09:07.259909 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m18:09:07.305125 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:09:07.379250 [debug] [Thread-4 (]: SQL status: BEGIN in 0.074 seconds
[0m18:09:07.381489 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m18:09:07.385192 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m18:09:07.414658 [debug] [Thread-3 (]: SQL status: BEGIN in 0.128 seconds
[0m18:09:07.428034 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m18:09:07.430178 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m18:09:07.445083 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.079 seconds
[0m18:09:07.501447 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m18:09:07.504651 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m18:09:07.511649 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:09:07.558472 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.148 seconds
[0m18:09:07.561672 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m18:09:07.573309 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m18:09:07.590403 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m18:09:07.626874 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m18:09:07.629696 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m18:09:07.623794 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m18:09:07.633728 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m18:09:07.644062 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m18:09:07.646600 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m18:09:07.692683 [debug] [Thread-4 (]: SQL status: COMMIT in 0.023 seconds
[0m18:09:07.695456 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m18:09:07.716739 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m18:09:07.734745 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m18:09:07.724329 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m18:09:07.745550 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m18:09:07.764462 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m18:09:07.767266 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m18:09:07.779477 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m18:09:07.769597 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m18:09:07.794629 [debug] [Thread-3 (]: SQL status: COMMIT in 0.013 seconds
[0m18:09:07.814837 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.021 seconds
[0m18:09:07.837316 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m18:09:07.841081 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m18:09:07.847211 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m18:09:07.849647 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m18:09:07.857772 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b701ee7-4795-479f-a793-67e3634853b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793c5c86e0>]}
[0m18:09:07.861409 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.81s]
[0m18:09:07.874611 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m18:09:07.876449 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.017 seconds
[0m18:09:07.891370 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m18:09:07.894778 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b701ee7-4795-479f-a793-67e3634853b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f793c579a30>]}
[0m18:09:07.908597 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.85s]
[0m18:09:07.912086 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m18:09:07.922547 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:07.931950 [debug] [MainThread]: On master: BEGIN
[0m18:09:07.933667 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:09:07.988457 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m18:09:07.990731 [debug] [MainThread]: On master: COMMIT
[0m18:09:08.004041 [debug] [MainThread]: Using postgres connection "master"
[0m18:09:08.006687 [debug] [MainThread]: On master: COMMIT
[0m18:09:08.019616 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:09:08.023088 [debug] [MainThread]: On master: Close
[0m18:09:08.038942 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:08.040856 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m18:09:08.051415 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m18:09:08.053464 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m18:09:08.056944 [info ] [MainThread]: 
[0m18:09:08.069544 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 5.41 seconds (5.41s).
[0m18:09:08.089483 [debug] [MainThread]: Command end result
[0m18:09:08.405035 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m18:09:08.423433 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m18:09:08.518965 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m18:09:08.527495 [info ] [MainThread]: 
[0m18:09:08.530199 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:09:08.542786 [info ] [MainThread]: 
[0m18:09:08.546448 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:09:08.572898 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.129649, "process_in_blocks": "115264", "process_kernel_time": 14.876981, "process_mem_max_rss": "107400", "process_out_blocks": "3392", "process_user_time": 23.250439}
[0m18:09:08.577313 [debug] [MainThread]: Command `dbt run` succeeded at 18:09:08.576293 after 15.14 seconds
[0m18:09:08.589587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7942b73e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7941fd22d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f79429b1670>]}
[0m18:09:08.592021 [debug] [MainThread]: Flushing usage events
[0m18:09:09.709270 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:24:25.728396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beb41bc05c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beb40b8dc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beb40014980>]}


============================== 18:24:25.756256 | 0ce255c9-4c47-4a03-bc29-de80f7f38cbc ==============================
[0m18:24:25.756256 [info ] [MainThread]: Running with dbt=1.9.0
[0m18:24:25.757758 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:24:26.599441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ce255c9-4c47-4a03-bc29-de80f7f38cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beb41b437d0>]}
[0m18:24:26.826519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0ce255c9-4c47-4a03-bc29-de80f7f38cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beb417e8260>]}
[0m18:24:26.832066 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:24:29.359357 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m18:24:30.388789 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:24:30.403790 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:24:30.659888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0ce255c9-4c47-4a03-bc29-de80f7f38cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beb3e3c2f30>]}
[0m18:24:30.910065 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m18:24:30.958525 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m18:24:31.123573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0ce255c9-4c47-4a03-bc29-de80f7f38cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beb3e30b830>]}
[0m18:24:31.140275 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m18:24:31.142245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ce255c9-4c47-4a03-bc29-de80f7f38cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beb4017a900>]}
[0m18:24:31.170293 [info ] [MainThread]: 
[0m18:24:31.174341 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:24:31.176339 [info ] [MainThread]: 
[0m18:24:31.179682 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:24:31.223704 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m18:24:31.718705 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m18:24:31.727990 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m18:24:31.729203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:32.915015 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.120 seconds
[0m18:24:32.957465 [debug] [ThreadPool]: On list_db: Close
[0m18:24:33.005067 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev'
[0m18:24:33.109931 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m18:24:33.112440 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m18:24:33.116742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:35.770352 [debug] [ThreadPool]: SQL status: BEGIN in 2.616 seconds
[0m18:24:35.792001 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m18:24:35.794369 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m18:24:35.908027 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.104 seconds
[0m18:24:35.922656 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m18:24:35.935642 [debug] [ThreadPool]: On list_db_dev: Close
[0m18:24:36.028971 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:36.036720 [debug] [MainThread]: On master: BEGIN
[0m18:24:36.045796 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:24:37.190349 [debug] [MainThread]: SQL status: BEGIN in 1.135 seconds
[0m18:24:37.200122 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:37.204551 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:24:37.423855 [debug] [MainThread]: SQL status: SELECT 0 in 0.217 seconds
[0m18:24:37.434300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0ce255c9-4c47-4a03-bc29-de80f7f38cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beb3e3e8ce0>]}
[0m18:24:37.471382 [debug] [MainThread]: On master: ROLLBACK
[0m18:24:37.480384 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:37.489093 [debug] [MainThread]: On master: BEGIN
[0m18:24:37.492043 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:24:37.493554 [debug] [MainThread]: On master: COMMIT
[0m18:24:37.495063 [debug] [MainThread]: Using postgres connection "master"
[0m18:24:37.496708 [debug] [MainThread]: On master: COMMIT
[0m18:24:37.507908 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:24:37.509907 [debug] [MainThread]: On master: Close
[0m18:24:37.673975 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m18:24:37.695417 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m18:24:37.697705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m18:24:37.700757 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m18:24:37.932400 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m18:24:37.970394 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m18:24:38.260394 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m18:24:38.273340 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m18:24:38.274999 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m18:24:38.276972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:24:38.969512 [debug] [Thread-1 (]: SQL status: BEGIN in 0.681 seconds
[0m18:24:38.980646 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m18:24:38.982518 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m18:24:39.083595 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.099 seconds
[0m18:24:39.114246 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m18:24:39.117735 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m18:24:39.124961 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m18:24:39.146560 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m18:24:39.154776 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m18:24:39.157938 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:24:39.437327 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m18:24:39.465563 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m18:24:39.467876 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m18:24:39.502633 [debug] [Thread-1 (]: SQL status: COMMIT in 0.026 seconds
[0m18:24:39.550290 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m18:24:39.600633 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m18:24:39.604283 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m18:24:41.558207 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.264 seconds
[0m18:25:33.997718 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m18:25:34.688297 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ce255c9-4c47-4a03-bc29-de80f7f38cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beb3e142f60>]}
[0m18:25:34.800197 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 56.52s]
[0m18:25:34.804246 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m18:25:34.860261 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m18:25:34.890163 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m18:25:34.906801 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m18:25:34.910132 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m18:25:34.938967 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m18:25:34.941470 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m18:25:34.926955 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m18:25:34.957324 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m18:25:35.081622 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m18:25:35.090524 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m18:25:35.128510 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m18:25:35.147353 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m18:25:35.186518 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m18:25:35.199980 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m18:25:35.230004 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m18:25:35.231566 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m18:25:35.233173 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:25:35.205507 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m18:25:35.282260 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m18:25:35.284076 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:25:45.491960 [debug] [Thread-4 (]: SQL status: BEGIN in 10.181 seconds
[0m18:25:45.494753 [debug] [Thread-3 (]: SQL status: BEGIN in 10.223 seconds
[0m18:25:45.516292 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m18:25:45.519029 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m18:25:45.521933 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m18:25:45.526865 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m18:25:45.603940 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.074 seconds
[0m18:25:45.653640 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m18:25:45.655752 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m18:25:45.662961 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m18:25:45.690448 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m18:25:45.707019 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.177 seconds
[0m18:25:45.692141 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m18:25:45.727650 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m18:25:45.735094 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m18:25:45.737823 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m18:25:45.773656 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m18:25:45.775848 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m18:25:45.778288 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m18:25:45.792369 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m18:25:45.795035 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m18:25:45.797568 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m18:25:45.806816 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:25:45.813716 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m18:25:45.826205 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m18:25:45.827881 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m18:25:45.854371 [debug] [Thread-3 (]: SQL status: COMMIT in 0.025 seconds
[0m18:25:45.837960 [debug] [Thread-4 (]: SQL status: COMMIT in 0.033 seconds
[0m18:25:45.875571 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m18:25:45.893787 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m18:25:45.906213 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m18:25:45.899708 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m18:25:45.913966 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m18:25:45.916589 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m18:25:45.947803 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.029 seconds
[0m18:25:45.950494 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.039 seconds
[0m18:25:45.956905 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m18:25:45.993619 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m18:25:46.032072 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ce255c9-4c47-4a03-bc29-de80f7f38cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beb3d255d30>]}
[0m18:25:46.031378 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0ce255c9-4c47-4a03-bc29-de80f7f38cbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beb3d255df0>]}
[0m18:25:46.074709 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 11.12s]
[0m18:25:46.083601 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m18:25:46.085087 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 11.08s]
[0m18:25:46.114426 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m18:25:46.179728 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:46.221993 [debug] [MainThread]: On master: BEGIN
[0m18:25:46.228972 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:25:48.404418 [debug] [MainThread]: SQL status: BEGIN in 2.156 seconds
[0m18:25:48.429026 [debug] [MainThread]: On master: COMMIT
[0m18:25:48.432111 [debug] [MainThread]: Using postgres connection "master"
[0m18:25:48.433628 [debug] [MainThread]: On master: COMMIT
[0m18:25:48.448390 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:25:48.460980 [debug] [MainThread]: On master: Close
[0m18:25:48.475957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:25:48.485714 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m18:25:48.487736 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m18:25:48.500898 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m18:25:48.503797 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m18:25:48.550620 [info ] [MainThread]: 
[0m18:25:48.553403 [info ] [MainThread]: Finished running 3 table models in 0 hours 1 minutes and 17.34 seconds (77.34s).
[0m18:25:48.564780 [debug] [MainThread]: Command end result
[0m18:25:48.905893 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m18:25:48.971500 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m18:25:49.052590 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m18:25:49.056441 [info ] [MainThread]: 
[0m18:25:49.060633 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:25:49.071895 [info ] [MainThread]: 
[0m18:25:49.077368 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:25:49.167527 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 83.60634, "process_in_blocks": "1468232", "process_kernel_time": 18.745472, "process_mem_max_rss": "94252", "process_out_blocks": "3504", "process_user_time": 9.671486}
[0m18:25:49.193671 [debug] [MainThread]: Command `dbt run` succeeded at 18:25:49.192877 after 83.64 seconds
[0m18:25:49.201007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beb4017af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beb4017b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7beb3e0969c0>]}
[0m18:25:49.214454 [debug] [MainThread]: Flushing usage events
[0m18:25:54.716507 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:53.634840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6996104e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6996371a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6995d6c860>]}


============================== 13:21:53.723403 | 40c6cff4-d1fb-4617-8b51-d17584046852 ==============================
[0m13:21:53.723403 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:21:53.726135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:55.136282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40c6cff4-d1fb-4617-8b51-d17584046852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6997847020>]}
[0m13:21:55.592907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40c6cff4-d1fb-4617-8b51-d17584046852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6995baf4d0>]}
[0m13:21:55.603173 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:21:56.065601 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:21:56.808960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:56.810789 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:56.933575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40c6cff4-d1fb-4617-8b51-d17584046852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6995aab110>]}
[0m13:21:57.290098 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:21:57.304470 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:21:57.598259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40c6cff4-d1fb-4617-8b51-d17584046852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6993fb8140>]}
[0m13:21:57.600974 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:21:57.603255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40c6cff4-d1fb-4617-8b51-d17584046852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e699662eba0>]}
[0m13:21:57.622835 [info ] [MainThread]: 
[0m13:21:57.624934 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:21:57.626565 [info ] [MainThread]: 
[0m13:21:57.639243 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:21:57.680256 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:21:58.497543 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:21:58.501711 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:21:58.503353 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:58.823965 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.321 seconds
[0m13:21:58.829883 [debug] [ThreadPool]: On list_db: Close
[0m13:21:58.842520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m13:21:58.878774 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:21:58.881929 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m13:21:58.883690 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:58.950460 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m13:21:58.951936 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:21:58.953846 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:21:59.078684 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.123 seconds
[0m13:21:59.084429 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m13:21:59.087769 [debug] [ThreadPool]: On list_db_dev: Close
[0m13:21:59.119712 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:59.121792 [debug] [MainThread]: On master: BEGIN
[0m13:21:59.123205 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:21:59.178209 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m13:21:59.180114 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:59.182523 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:21:59.268925 [debug] [MainThread]: SQL status: SELECT 0 in 0.084 seconds
[0m13:21:59.275410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40c6cff4-d1fb-4617-8b51-d17584046852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6995ad3140>]}
[0m13:21:59.278494 [debug] [MainThread]: On master: ROLLBACK
[0m13:21:59.281761 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:59.285922 [debug] [MainThread]: On master: BEGIN
[0m13:21:59.289406 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m13:21:59.291157 [debug] [MainThread]: On master: COMMIT
[0m13:21:59.292954 [debug] [MainThread]: Using postgres connection "master"
[0m13:21:59.294913 [debug] [MainThread]: On master: COMMIT
[0m13:21:59.297374 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:21:59.304008 [debug] [MainThread]: On master: Close
[0m13:21:59.324498 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m13:21:59.327310 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m13:21:59.330879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m13:21:59.333619 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m13:21:59.364213 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m13:21:59.369182 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m13:21:59.627232 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m13:21:59.631621 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:21:59.633638 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m13:21:59.635718 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:21:59.675334 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m13:21:59.677284 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:21:59.679082 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m13:21:59.752317 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.072 seconds
[0m13:21:59.779883 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:21:59.781966 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m13:21:59.784790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:21:59.795455 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:21:59.797378 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m13:21:59.800043 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:21:59.866003 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:21:59.867614 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:21:59.869049 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:21:59.884779 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m13:21:59.906818 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m13:21:59.931775 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:21:59.933871 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m13:21:59.963459 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.028 seconds
[0m13:21:59.985817 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m13:21:59.993636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40c6cff4-d1fb-4617-8b51-d17584046852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e69978461b0>]}
[0m13:21:59.997411 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.66s]
[0m13:22:00.004600 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m13:22:00.018245 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m13:22:00.019944 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m13:22:00.024300 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m13:22:00.034859 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m13:22:00.032336 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m13:22:00.038232 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m13:22:00.042268 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m13:22:00.080460 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m13:22:00.101587 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m13:22:00.102563 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m13:22:00.105821 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m13:22:00.118219 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m13:22:00.119738 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m13:22:00.135976 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:22:00.130710 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m13:22:00.137608 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m13:22:00.139832 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:22:00.143301 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:22:00.144762 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m13:22:00.146258 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:22:00.203009 [debug] [Thread-3 (]: SQL status: BEGIN in 0.063 seconds
[0m13:22:00.206091 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:22:00.207934 [debug] [Thread-4 (]: SQL status: BEGIN in 0.062 seconds
[0m13:22:00.216579 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m13:22:00.222897 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:22:00.226694 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m13:22:00.283296 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.052 seconds
[0m13:22:00.303093 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:22:00.306098 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m13:22:00.311047 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:22:00.320490 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:22:00.321976 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m13:22:00.323984 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.098 seconds
[0m13:22:00.326639 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:22:00.338985 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:22:00.345393 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:22:00.346689 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m13:22:00.348321 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:22:00.350252 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:22:00.351776 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:22:00.374849 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m13:22:00.373353 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:22:00.384742 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m13:22:00.386360 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m13:22:00.388878 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:22:00.390641 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m13:22:00.391707 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:22:00.396021 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:22:00.397517 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:22:00.398682 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m13:22:00.399601 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:22:00.403501 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m13:22:00.406295 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40c6cff4-d1fb-4617-8b51-d17584046852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6990063b90>]}
[0m13:22:00.409809 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m13:22:00.408492 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.37s]
[0m13:22:00.427993 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m13:22:00.432357 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m13:22:00.436558 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:22:00.438449 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m13:22:00.449644 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.009 seconds
[0m13:22:00.456549 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m13:22:00.458548 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40c6cff4-d1fb-4617-8b51-d17584046852', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6990054320>]}
[0m13:22:00.461985 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.42s]
[0m13:22:00.465647 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m13:22:00.474442 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:00.476216 [debug] [MainThread]: On master: BEGIN
[0m13:22:00.480293 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:22:00.505313 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m13:22:00.506997 [debug] [MainThread]: On master: COMMIT
[0m13:22:00.508560 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:00.510414 [debug] [MainThread]: On master: COMMIT
[0m13:22:00.512480 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:22:00.514040 [debug] [MainThread]: On master: Close
[0m13:22:00.516458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:22:00.518650 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m13:22:00.520377 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m13:22:00.521499 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m13:22:00.523280 [info ] [MainThread]: 
[0m13:22:00.524781 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m13:22:00.530633 [debug] [MainThread]: Command end result
[0m13:22:00.629879 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:22:00.636435 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:22:00.660075 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:22:00.661273 [info ] [MainThread]: 
[0m13:22:00.662712 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:22:00.664579 [info ] [MainThread]: 
[0m13:22:00.668872 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:22:00.676760 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.146087, "process_in_blocks": "113016", "process_kernel_time": 5.180751, "process_mem_max_rss": "106592", "process_out_blocks": "1792", "process_user_time": 9.604947}
[0m13:22:00.678708 [debug] [MainThread]: Command `dbt run` succeeded at 13:22:00.678204 after 8.15 seconds
[0m13:22:00.680150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e69966e8a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e69978f0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e6995a82e10>]}
[0m13:22:00.681818 [debug] [MainThread]: Flushing usage events
[0m13:22:01.499310 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:28:52.834044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75041e50bb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75041dbe89b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75041dfb1790>]}


============================== 13:28:52.854682 | ad8d01b4-82ed-4c22-bfcc-71fd7dbc50de ==============================
[0m13:28:52.854682 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:28:52.856535 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:28:53.533749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad8d01b4-82ed-4c22-bfcc-71fd7dbc50de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75041f90f3b0>]}
[0m13:28:53.697068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad8d01b4-82ed-4c22-bfcc-71fd7dbc50de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75041dc4b620>]}
[0m13:28:53.700037 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:28:54.023440 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:28:54.434845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:28:54.435948 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:28:54.534180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad8d01b4-82ed-4c22-bfcc-71fd7dbc50de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75041c1982f0>]}
[0m13:28:54.731153 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:28:54.738285 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:28:54.828721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad8d01b4-82ed-4c22-bfcc-71fd7dbc50de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75041bed6270>]}
[0m13:28:54.829842 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:28:54.831200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad8d01b4-82ed-4c22-bfcc-71fd7dbc50de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75041f385640>]}
[0m13:28:54.836078 [info ] [MainThread]: 
[0m13:28:54.837269 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:28:54.838502 [info ] [MainThread]: 
[0m13:28:54.840834 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:28:54.851461 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:28:55.052750 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:28:55.053680 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:28:55.054422 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:55.124787 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.070 seconds
[0m13:28:55.127715 [debug] [ThreadPool]: On list_db: Close
[0m13:28:55.132369 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m13:28:55.150742 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:28:55.151812 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m13:28:55.152506 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:55.168298 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m13:28:55.169530 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:28:55.170638 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:28:55.198112 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.026 seconds
[0m13:28:55.203410 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m13:28:55.205240 [debug] [ThreadPool]: On list_db_dev: Close
[0m13:28:55.234446 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:55.236317 [debug] [MainThread]: On master: BEGIN
[0m13:28:55.238759 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:28:55.261685 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m13:28:55.263742 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:55.266059 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:28:55.323618 [debug] [MainThread]: SQL status: SELECT 0 in 0.056 seconds
[0m13:28:55.332846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad8d01b4-82ed-4c22-bfcc-71fd7dbc50de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75041d9936e0>]}
[0m13:28:55.337810 [debug] [MainThread]: On master: ROLLBACK
[0m13:28:55.340084 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:55.342833 [debug] [MainThread]: On master: BEGIN
[0m13:28:55.346670 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m13:28:55.348325 [debug] [MainThread]: On master: COMMIT
[0m13:28:55.349987 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:55.353408 [debug] [MainThread]: On master: COMMIT
[0m13:28:55.356339 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:28:55.358749 [debug] [MainThread]: On master: Close
[0m13:28:55.387683 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m13:28:55.389851 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m13:28:55.392102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m13:28:55.394397 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m13:28:55.417763 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m13:28:55.419719 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m13:28:55.529218 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m13:28:55.531784 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:28:55.533061 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m13:28:55.534066 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:28:55.549094 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m13:28:55.550590 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:28:55.552090 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m13:28:55.598506 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.045 seconds
[0m13:28:55.614888 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:28:55.616249 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m13:28:55.619695 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:28:55.626676 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:28:55.627879 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m13:28:55.629811 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:28:55.672280 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:28:55.673340 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:28:55.674229 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:28:55.679448 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m13:28:55.697006 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m13:28:55.713341 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:28:55.714424 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m13:28:55.725448 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m13:28:55.732401 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m13:28:55.737508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad8d01b4-82ed-4c22-bfcc-71fd7dbc50de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75041e4ea7e0>]}
[0m13:28:55.739653 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.34s]
[0m13:28:55.741838 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m13:28:55.745139 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m13:28:55.746237 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m13:28:55.747747 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m13:28:55.749819 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m13:28:55.751947 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m13:28:55.753532 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m13:28:55.754834 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m13:28:55.756486 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m13:28:55.763764 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m13:28:55.771450 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m13:28:55.774042 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m13:28:55.775311 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m13:28:55.782094 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m13:28:55.789164 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m13:28:55.791354 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:28:55.792443 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m13:28:55.793406 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:28:55.794549 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:28:55.795887 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m13:28:55.797131 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:28:55.813285 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m13:28:55.815646 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:28:55.817219 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m13:28:55.820394 [debug] [Thread-3 (]: SQL status: BEGIN in 0.023 seconds
[0m13:28:55.822772 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:28:55.825407 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m13:28:55.842058 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.023 seconds
[0m13:28:55.857160 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:28:55.858795 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m13:28:55.862193 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:28:55.870070 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.043 seconds
[0m13:28:55.874487 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:28:55.882328 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:28:55.883843 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m13:28:55.885140 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m13:28:55.887962 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:28:55.890014 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:28:55.895646 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:28:55.905262 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:28:55.906568 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:28:55.908209 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m13:28:55.909491 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:28:55.912450 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:28:55.917142 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:28:55.918300 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m13:28:55.919825 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:28:55.926397 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m13:28:55.927930 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:28:55.930331 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:28:55.932533 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m13:28:55.936605 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m13:28:55.944445 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m13:28:55.945688 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.012 seconds
[0m13:28:55.947747 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:28:55.952806 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m13:28:55.954384 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m13:28:55.956801 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad8d01b4-82ed-4c22-bfcc-71fd7dbc50de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x750418743f20>]}
[0m13:28:55.959455 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.20s]
[0m13:28:55.962090 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m13:28:55.963660 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.008 seconds
[0m13:28:55.971982 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m13:28:55.974818 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad8d01b4-82ed-4c22-bfcc-71fd7dbc50de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75041b03c230>]}
[0m13:28:55.978550 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.22s]
[0m13:28:55.982467 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m13:28:55.994893 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:55.996443 [debug] [MainThread]: On master: BEGIN
[0m13:28:55.998244 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:28:56.020773 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m13:28:56.022333 [debug] [MainThread]: On master: COMMIT
[0m13:28:56.024320 [debug] [MainThread]: Using postgres connection "master"
[0m13:28:56.025775 [debug] [MainThread]: On master: COMMIT
[0m13:28:56.027941 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:28:56.029869 [debug] [MainThread]: On master: Close
[0m13:28:56.033796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:56.040100 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m13:28:56.041858 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m13:28:56.043684 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m13:28:56.045828 [info ] [MainThread]: 
[0m13:28:56.049871 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.21 seconds (1.21s).
[0m13:28:56.058794 [debug] [MainThread]: Command end result
[0m13:28:56.150371 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:28:56.156168 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:28:56.180665 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:28:56.182100 [info ] [MainThread]: 
[0m13:28:56.184025 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:28:56.186015 [info ] [MainThread]: 
[0m13:28:56.188013 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:28:56.192628 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.5312674, "process_in_blocks": "116784", "process_kernel_time": 2.523253, "process_mem_max_rss": "107168", "process_out_blocks": "3400", "process_user_time": 6.281892}
[0m13:28:56.194427 [debug] [MainThread]: Command `dbt run` succeeded at 13:28:56.194047 after 3.53 seconds
[0m13:28:56.195857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75041dbe89b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75041be6b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75041dca2510>]}
[0m13:28:56.197194 [debug] [MainThread]: Flushing usage events
[0m13:28:57.076738 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:37:53.692815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f3951759d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f3936ea5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f3936e8f50>]}


============================== 13:37:53.730090 | e8a2d395-f14f-47c7-aa8d-4a286361e196 ==============================
[0m13:37:53.730090 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:37:53.732888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:37:56.272669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8a2d395-f14f-47c7-aa8d-4a286361e196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f393149700>]}
[0m13:37:56.806994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8a2d395-f14f-47c7-aa8d-4a286361e196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f3938b1970>]}
[0m13:37:56.815861 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:37:57.535423 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:37:58.785200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:37:58.790043 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:37:59.385723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8a2d395-f14f-47c7-aa8d-4a286361e196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f3918a2360>]}
[0m13:38:00.370860 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:38:00.396387 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:38:01.187439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8a2d395-f14f-47c7-aa8d-4a286361e196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f3915a8b30>]}
[0m13:38:01.190186 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:38:01.193954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8a2d395-f14f-47c7-aa8d-4a286361e196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f3915a79b0>]}
[0m13:38:01.232931 [info ] [MainThread]: 
[0m13:38:01.242094 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:38:01.246225 [info ] [MainThread]: 
[0m13:38:01.263719 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:38:01.414223 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:38:02.461293 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:38:02.464542 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:38:02.476926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:03.099747 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.633 seconds
[0m13:38:03.106437 [debug] [ThreadPool]: On list_db: Close
[0m13:38:03.121057 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev'
[0m13:38:03.176257 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:38:03.179904 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m13:38:03.181741 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:03.233199 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m13:38:03.235023 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:38:03.236899 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:38:03.291492 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.049 seconds
[0m13:38:03.297963 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m13:38:03.301467 [debug] [ThreadPool]: On list_db_dev: Close
[0m13:38:03.334821 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:03.336964 [debug] [MainThread]: On master: BEGIN
[0m13:38:03.338970 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:03.371625 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m13:38:03.373533 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:03.375841 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:38:03.482455 [debug] [MainThread]: SQL status: SELECT 0 in 0.104 seconds
[0m13:38:03.489812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8a2d395-f14f-47c7-aa8d-4a286361e196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f394f180e0>]}
[0m13:38:03.492467 [debug] [MainThread]: On master: ROLLBACK
[0m13:38:03.501464 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:03.504332 [debug] [MainThread]: On master: BEGIN
[0m13:38:03.513253 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:38:03.515108 [debug] [MainThread]: On master: COMMIT
[0m13:38:03.517086 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:03.518981 [debug] [MainThread]: On master: COMMIT
[0m13:38:03.530699 [debug] [MainThread]: SQL status: COMMIT in 0.010 seconds
[0m13:38:03.532932 [debug] [MainThread]: On master: Close
[0m13:38:03.569886 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m13:38:03.572752 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m13:38:03.579889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m13:38:03.581890 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m13:38:03.641715 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m13:38:03.645620 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m13:38:03.992409 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m13:38:04.007756 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:38:04.009823 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m13:38:04.012115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:04.067417 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m13:38:04.069464 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:38:04.071656 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m13:38:04.187747 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.114 seconds
[0m13:38:04.219250 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:38:04.221180 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m13:38:04.225881 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:38:04.249110 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:38:04.251176 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m13:38:04.255655 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:38:04.417857 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:38:04.419582 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:38:04.421260 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:38:04.429840 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m13:38:04.484379 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m13:38:04.528545 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:38:04.530687 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m13:38:04.563508 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.029 seconds
[0m13:38:04.583657 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m13:38:04.597843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a2d395-f14f-47c7-aa8d-4a286361e196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f393c3a7b0>]}
[0m13:38:04.609598 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 1.01s]
[0m13:38:04.613434 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m13:38:04.618419 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m13:38:04.627913 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m13:38:04.629934 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m13:38:04.640513 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m13:38:04.647225 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m13:38:04.649743 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m13:38:04.652915 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m13:38:04.684746 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m13:38:04.689363 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m13:38:04.701481 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m13:38:04.759798 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m13:38:04.754257 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m13:38:04.764282 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:38:04.770110 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m13:38:04.773908 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:38:04.789912 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m13:38:04.809296 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m13:38:04.812628 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:38:04.814552 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m13:38:04.816506 [debug] [Thread-3 (]: SQL status: BEGIN in 0.042 seconds
[0m13:38:04.818790 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:38:04.820963 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:38:04.824501 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m13:38:04.882448 [debug] [Thread-4 (]: SQL status: BEGIN in 0.064 seconds
[0m13:38:04.884537 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:38:04.887061 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m13:38:04.897328 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.071 seconds
[0m13:38:04.918058 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:38:04.920301 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m13:38:04.925441 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:38:04.933536 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.044 seconds
[0m13:38:04.946369 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:38:04.955209 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m13:38:04.964945 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:38:04.966927 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:38:04.968941 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m13:38:04.977868 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:38:04.980939 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:38:04.982557 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:38:04.984880 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:38:05.003448 [debug] [Thread-3 (]: SQL status: COMMIT in 0.017 seconds
[0m13:38:05.018700 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:38:05.023818 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m13:38:05.025524 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m13:38:05.029274 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:38:05.033500 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m13:38:05.035873 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:38:05.049881 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:38:05.051733 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:38:05.055627 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:38:05.058756 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.020 seconds
[0m13:38:05.069470 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m13:38:05.072410 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a2d395-f14f-47c7-aa8d-4a286361e196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f390828890>]}
[0m13:38:05.074353 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m13:38:05.077150 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.43s]
[0m13:38:05.096775 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m13:38:05.117020 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m13:38:05.120095 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:38:05.123020 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m13:38:05.149970 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.022 seconds
[0m13:38:05.156693 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m13:38:05.163340 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8a2d395-f14f-47c7-aa8d-4a286361e196', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f39076d970>]}
[0m13:38:05.171744 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.51s]
[0m13:38:05.175166 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m13:38:05.196563 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:05.198407 [debug] [MainThread]: On master: BEGIN
[0m13:38:05.200201 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:38:05.234933 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m13:38:05.238137 [debug] [MainThread]: On master: COMMIT
[0m13:38:05.240448 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:05.242036 [debug] [MainThread]: On master: COMMIT
[0m13:38:05.244933 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:38:05.247083 [debug] [MainThread]: On master: Close
[0m13:38:05.251574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:05.260700 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m13:38:05.266867 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m13:38:05.268778 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m13:38:05.271467 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m13:38:05.279169 [info ] [MainThread]: 
[0m13:38:05.281610 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 4.02 seconds (4.02s).
[0m13:38:05.293329 [debug] [MainThread]: Command end result
[0m13:38:05.436161 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:38:05.449526 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:38:05.477265 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:38:05.479292 [info ] [MainThread]: 
[0m13:38:05.485619 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:38:05.490274 [info ] [MainThread]: 
[0m13:38:05.492076 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:38:05.500715 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.159666, "process_in_blocks": "128984", "process_kernel_time": 5.896439, "process_mem_max_rss": "100256", "process_out_blocks": "3408", "process_user_time": 15.058135}
[0m13:38:05.512938 [debug] [MainThread]: Command `dbt run` succeeded at 13:38:05.512139 after 12.17 seconds
[0m13:38:05.515959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f393307ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f39182d280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f391636390>]}
[0m13:38:05.518997 [debug] [MainThread]: Flushing usage events
[0m13:38:06.742283 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:38:36.091654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad3c6ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad3c69340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad35920f0>]}


============================== 13:38:36.171814 | 7877644f-b7ea-4ae2-aabc-91ccb800ef4d ==============================
[0m13:38:36.171814 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:38:36.174911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:38:39.320473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7877644f-b7ea-4ae2-aabc-91ccb800ef4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad4f034d0>]}
[0m13:38:40.526749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7877644f-b7ea-4ae2-aabc-91ccb800ef4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad48247a0>]}
[0m13:38:40.545562 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:38:41.305771 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:38:42.185529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:38:42.187115 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:38:42.595392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7877644f-b7ea-4ae2-aabc-91ccb800ef4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad16b6510>]}
[0m13:38:43.356819 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:38:43.391272 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:38:43.777906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7877644f-b7ea-4ae2-aabc-91ccb800ef4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad155f290>]}
[0m13:38:43.790995 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:38:43.793265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7877644f-b7ea-4ae2-aabc-91ccb800ef4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad175ef30>]}
[0m13:38:43.825324 [info ] [MainThread]: 
[0m13:38:43.827395 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:38:43.839863 [info ] [MainThread]: 
[0m13:38:43.842752 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:38:43.906392 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:38:44.807746 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:38:44.809875 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:38:44.812047 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:38:45.153445 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.341 seconds
[0m13:38:45.159002 [debug] [ThreadPool]: On list_db: Close
[0m13:38:45.183613 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m13:38:45.233127 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:38:45.235522 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m13:38:45.237157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:38:45.271490 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m13:38:45.273224 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:38:45.279280 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:38:45.315233 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.034 seconds
[0m13:38:45.330359 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m13:38:45.332970 [debug] [ThreadPool]: On list_db_dev: Close
[0m13:38:45.380673 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:45.382706 [debug] [MainThread]: On master: BEGIN
[0m13:38:45.384296 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:38:45.434300 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m13:38:45.436148 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:45.438507 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:38:45.506395 [debug] [MainThread]: SQL status: SELECT 0 in 0.062 seconds
[0m13:38:45.522319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7877644f-b7ea-4ae2-aabc-91ccb800ef4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad2f270b0>]}
[0m13:38:45.524715 [debug] [MainThread]: On master: ROLLBACK
[0m13:38:45.527255 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:45.530646 [debug] [MainThread]: On master: BEGIN
[0m13:38:45.533852 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:38:45.535745 [debug] [MainThread]: On master: COMMIT
[0m13:38:45.537741 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:45.540868 [debug] [MainThread]: On master: COMMIT
[0m13:38:45.553061 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:38:45.555138 [debug] [MainThread]: On master: Close
[0m13:38:45.579194 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m13:38:45.588399 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m13:38:45.590838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m13:38:45.593098 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m13:38:45.649947 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m13:38:45.661283 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m13:38:45.975531 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m13:38:45.978581 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:38:45.982040 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m13:38:45.986465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:38:46.022937 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m13:38:46.024987 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:38:46.027500 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m13:38:46.073176 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.044 seconds
[0m13:38:46.112179 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:38:46.116893 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m13:38:46.130560 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m13:38:46.189184 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:38:46.203250 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m13:38:46.206881 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:38:46.495425 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:38:46.497411 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:38:46.510840 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:38:46.524422 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m13:38:46.644813 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m13:38:46.742180 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:38:46.755053 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m13:38:46.782682 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.025 seconds
[0m13:38:46.804891 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m13:38:46.824982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7877644f-b7ea-4ae2-aabc-91ccb800ef4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad3aca270>]}
[0m13:38:46.836884 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 1.22s]
[0m13:38:46.842786 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m13:38:46.857299 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m13:38:46.860051 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m13:38:46.862717 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m13:38:46.869433 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m13:38:46.866118 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m13:38:46.877527 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m13:38:46.881153 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m13:38:46.897607 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m13:38:46.910258 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m13:38:46.913352 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m13:38:46.927229 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m13:38:46.939458 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m13:38:46.945639 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m13:38:46.961298 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m13:38:46.964850 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:38:46.966728 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:38:46.968335 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m13:38:46.970806 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m13:38:46.973119 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:38:46.975745 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:38:47.001778 [debug] [Thread-4 (]: SQL status: BEGIN in 0.028 seconds
[0m13:38:47.004290 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:38:47.006452 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m13:38:47.010053 [debug] [Thread-3 (]: SQL status: BEGIN in 0.034 seconds
[0m13:38:47.012172 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:38:47.014283 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m13:38:47.031325 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.023 seconds
[0m13:38:47.051025 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:38:47.053938 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.036 seconds
[0m13:38:47.055696 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m13:38:47.072245 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:38:47.082797 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m13:38:47.084603 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m13:38:47.098102 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:38:47.100609 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m13:38:47.102737 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:38:47.112617 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m13:38:47.145988 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:38:47.148749 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:38:47.127338 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:38:47.160761 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:38:47.163099 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m13:38:47.167405 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:38:47.173965 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m13:38:47.184015 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:38:47.192024 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:38:47.196910 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:38:47.202161 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m13:38:47.209103 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:38:47.213255 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m13:38:47.215725 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m13:38:47.235586 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.018 seconds
[0m13:38:47.240962 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m13:38:47.250316 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m13:38:47.254115 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:38:47.256840 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m13:38:47.259680 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7877644f-b7ea-4ae2-aabc-91ccb800ef4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad060d5e0>]}
[0m13:38:47.263282 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.38s]
[0m13:38:47.278598 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m13:38:47.296119 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.034 seconds
[0m13:38:47.313121 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m13:38:47.319411 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7877644f-b7ea-4ae2-aabc-91ccb800ef4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad12adbb0>]}
[0m13:38:47.330640 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.45s]
[0m13:38:47.333480 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m13:38:47.346445 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:47.349038 [debug] [MainThread]: On master: BEGIN
[0m13:38:47.352077 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:38:47.385220 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m13:38:47.387301 [debug] [MainThread]: On master: COMMIT
[0m13:38:47.388948 [debug] [MainThread]: Using postgres connection "master"
[0m13:38:47.390361 [debug] [MainThread]: On master: COMMIT
[0m13:38:47.393058 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:38:47.395673 [debug] [MainThread]: On master: Close
[0m13:38:47.398642 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:38:47.405548 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m13:38:47.407022 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m13:38:47.421057 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m13:38:47.429988 [info ] [MainThread]: 
[0m13:38:47.433385 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 3.58 seconds (3.58s).
[0m13:38:47.441837 [debug] [MainThread]: Command end result
[0m13:38:47.639712 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:38:47.666911 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:38:47.792685 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:38:47.794997 [info ] [MainThread]: 
[0m13:38:47.797560 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:38:47.810582 [info ] [MainThread]: 
[0m13:38:47.812686 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:38:47.841025 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.340621, "process_in_blocks": "94552", "process_kernel_time": 6.628438, "process_mem_max_rss": "103624", "process_out_blocks": "3400", "process_user_time": 20.466585}
[0m13:38:47.852729 [debug] [MainThread]: Command `dbt run` succeeded at 13:38:47.851973 after 12.35 seconds
[0m13:38:47.855365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad16efd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad31a6300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8ad31a5850>]}
[0m13:38:47.862128 [debug] [MainThread]: Flushing usage events
[0m13:38:48.739747 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:14.260312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74351b868860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74351cf9c440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74351c83b500>]}


============================== 13:39:14.312949 | 2c4843c6-2606-4ad1-8f40-5177ddee5611 ==============================
[0m13:39:14.312949 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:39:14.317300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:39:15.556641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c4843c6-2606-4ad1-8f40-5177ddee5611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74351af6eb70>]}
[0m13:39:15.901178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c4843c6-2606-4ad1-8f40-5177ddee5611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74351d2488f0>]}
[0m13:39:15.905948 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:39:16.379286 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:39:17.369021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:39:17.371593 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:39:17.762786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c4843c6-2606-4ad1-8f40-5177ddee5611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743519634230>]}
[0m13:39:18.489312 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:39:18.501895 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:39:18.623580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c4843c6-2606-4ad1-8f40-5177ddee5611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743519394500>]}
[0m13:39:18.625206 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:39:18.627265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c4843c6-2606-4ad1-8f40-5177ddee5611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74351cedd6d0>]}
[0m13:39:18.634170 [info ] [MainThread]: 
[0m13:39:18.637681 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:39:18.639595 [info ] [MainThread]: 
[0m13:39:18.642296 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:39:18.663261 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:39:19.110098 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:39:19.111985 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:39:19.113930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:19.269508 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.156 seconds
[0m13:39:19.277225 [debug] [ThreadPool]: On list_db: Close
[0m13:39:19.284438 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m13:39:19.328742 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:39:19.340998 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m13:39:19.344311 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:19.384802 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m13:39:19.386606 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:39:19.389706 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:39:19.417868 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.026 seconds
[0m13:39:19.429954 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m13:39:19.432319 [debug] [ThreadPool]: On list_db_dev: Close
[0m13:39:19.488376 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:19.490009 [debug] [MainThread]: On master: BEGIN
[0m13:39:19.491475 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:39:19.538668 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m13:39:19.541224 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:19.544570 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:39:19.618778 [debug] [MainThread]: SQL status: SELECT 0 in 0.064 seconds
[0m13:39:19.632223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c4843c6-2606-4ad1-8f40-5177ddee5611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7435195a3b00>]}
[0m13:39:19.634769 [debug] [MainThread]: On master: ROLLBACK
[0m13:39:19.639172 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:19.645732 [debug] [MainThread]: On master: BEGIN
[0m13:39:19.651369 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:39:19.654085 [debug] [MainThread]: On master: COMMIT
[0m13:39:19.656399 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:19.661897 [debug] [MainThread]: On master: COMMIT
[0m13:39:19.667573 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:39:19.670779 [debug] [MainThread]: On master: Close
[0m13:39:19.696354 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m13:39:19.699274 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m13:39:19.702504 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m13:39:19.705622 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m13:39:19.739657 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m13:39:19.741984 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m13:39:19.979234 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m13:39:19.982532 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:39:19.984769 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m13:39:19.987332 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:20.008022 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m13:39:20.009830 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:39:20.011527 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m13:39:20.047865 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.034 seconds
[0m13:39:20.069307 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:39:20.070715 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m13:39:20.073395 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:20.082281 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:39:20.083659 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m13:39:20.086296 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:20.143886 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:39:20.145273 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:39:20.146356 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:39:20.151962 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m13:39:20.180479 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m13:39:20.205563 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:39:20.207759 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m13:39:20.217874 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m13:39:20.229898 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m13:39:20.242169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c4843c6-2606-4ad1-8f40-5177ddee5611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74351cdda720>]}
[0m13:39:20.245490 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.53s]
[0m13:39:20.249120 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m13:39:20.254683 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m13:39:20.257014 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m13:39:20.266487 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m13:39:20.269336 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m13:39:20.270888 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m13:39:20.263812 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m13:39:20.286616 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m13:39:20.291418 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m13:39:20.289071 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m13:39:20.312869 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m13:39:20.311330 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m13:39:20.329648 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:39:20.334633 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m13:39:20.338150 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m13:39:20.340703 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:39:20.343442 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m13:39:20.364449 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m13:39:20.367998 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:39:20.372267 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m13:39:20.375324 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:39:20.382845 [debug] [Thread-4 (]: SQL status: BEGIN in 0.042 seconds
[0m13:39:20.384801 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:39:20.386464 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m13:39:20.407148 [debug] [Thread-3 (]: SQL status: BEGIN in 0.033 seconds
[0m13:39:20.409061 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:39:20.410769 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m13:39:20.414069 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.026 seconds
[0m13:39:20.430759 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:39:20.432781 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m13:39:20.435889 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:20.446881 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.030 seconds
[0m13:39:20.449741 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:39:20.460257 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:39:20.462844 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m13:39:20.465582 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m13:39:20.469192 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:20.471334 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:39:20.487939 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:39:20.495576 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:39:20.497513 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:39:20.498879 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:39:20.500941 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m13:39:20.504402 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:20.506025 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m13:39:20.520893 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:39:20.529042 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m13:39:20.530883 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:39:20.539042 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:39:20.534226 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:39:20.543451 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m13:39:20.547527 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m13:39:20.558377 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.013 seconds
[0m13:39:20.562369 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m13:39:20.568570 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m13:39:20.577728 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c4843c6-2606-4ad1-8f40-5177ddee5611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7435184f1a60>]}
[0m13:39:20.574137 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:39:20.580805 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.31s]
[0m13:39:20.586480 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m13:39:20.583226 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m13:39:20.596531 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m13:39:20.601043 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m13:39:20.603506 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c4843c6-2606-4ad1-8f40-5177ddee5611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743519394500>]}
[0m13:39:20.606657 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.31s]
[0m13:39:20.611073 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m13:39:20.618422 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:20.619940 [debug] [MainThread]: On master: BEGIN
[0m13:39:20.621738 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:39:20.645437 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m13:39:20.647406 [debug] [MainThread]: On master: COMMIT
[0m13:39:20.649061 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:20.650235 [debug] [MainThread]: On master: COMMIT
[0m13:39:20.652063 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:39:20.653757 [debug] [MainThread]: On master: Close
[0m13:39:20.656091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:20.657697 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m13:39:20.659016 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m13:39:20.661086 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m13:39:20.663990 [info ] [MainThread]: 
[0m13:39:20.666573 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.02 seconds (2.02s).
[0m13:39:20.672256 [debug] [MainThread]: Command end result
[0m13:39:20.774843 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:39:20.785873 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:39:20.823912 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:39:20.825582 [info ] [MainThread]: 
[0m13:39:20.827298 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:39:20.832545 [info ] [MainThread]: 
[0m13:39:20.835083 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:39:20.842590 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.9515305, "process_in_blocks": "69880", "process_kernel_time": 3.416523, "process_mem_max_rss": "102004", "process_out_blocks": "3400", "process_user_time": 12.937292}
[0m13:39:20.845113 [debug] [MainThread]: Command `dbt run` succeeded at 13:39:20.844498 after 6.95 seconds
[0m13:39:20.847021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74351b6d66c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74351944b920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74351c21f9e0>]}
[0m13:39:20.849500 [debug] [MainThread]: Flushing usage events
[0m13:39:21.777536 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:37.993800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78472d428560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78472cddd340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78472cddc1a0>]}


============================== 13:39:38.043029 | a5255c73-3053-47f4-8254-63dc062042c5 ==============================
[0m13:39:38.043029 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:39:38.045905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:39:38.845595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5255c73-3053-47f4-8254-63dc062042c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78472d17d850>]}
[0m13:39:39.026152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5255c73-3053-47f4-8254-63dc062042c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78472ce53380>]}
[0m13:39:39.029873 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:39:39.851692 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:39:40.834947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:39:40.841184 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:39:41.110952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5255c73-3053-47f4-8254-63dc062042c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78472b52c950>]}
[0m13:39:41.759700 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:39:41.812660 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:39:42.035271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5255c73-3053-47f4-8254-63dc062042c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78472b1f36b0>]}
[0m13:39:42.043236 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:39:42.044960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5255c73-3053-47f4-8254-63dc062042c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78472b2148f0>]}
[0m13:39:42.053756 [info ] [MainThread]: 
[0m13:39:42.056432 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:39:42.058048 [info ] [MainThread]: 
[0m13:39:42.062384 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:39:42.113375 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:39:42.419845 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:39:42.423555 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:39:42.425830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:42.814463 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.385 seconds
[0m13:39:42.818165 [debug] [ThreadPool]: On list_db: Close
[0m13:39:42.828918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m13:39:42.866430 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:39:42.868212 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m13:39:42.870026 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:42.899993 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m13:39:42.901987 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:39:42.904036 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:39:42.933326 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.026 seconds
[0m13:39:42.939444 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m13:39:42.941824 [debug] [ThreadPool]: On list_db_dev: Close
[0m13:39:42.979923 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:42.982721 [debug] [MainThread]: On master: BEGIN
[0m13:39:42.985507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:39:43.006135 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m13:39:43.007769 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:43.009592 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:39:43.043240 [debug] [MainThread]: SQL status: SELECT 0 in 0.032 seconds
[0m13:39:43.051159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5255c73-3053-47f4-8254-63dc062042c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78472cd452e0>]}
[0m13:39:43.055993 [debug] [MainThread]: On master: ROLLBACK
[0m13:39:43.058157 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:43.059353 [debug] [MainThread]: On master: BEGIN
[0m13:39:43.062802 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m13:39:43.064365 [debug] [MainThread]: On master: COMMIT
[0m13:39:43.066296 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:43.068068 [debug] [MainThread]: On master: COMMIT
[0m13:39:43.070852 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:39:43.072651 [debug] [MainThread]: On master: Close
[0m13:39:43.091043 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m13:39:43.093743 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m13:39:43.097362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m13:39:43.100249 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m13:39:43.130574 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m13:39:43.136109 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m13:39:43.315428 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m13:39:43.321112 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:39:43.322802 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m13:39:43.324442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:43.440662 [debug] [Thread-1 (]: SQL status: BEGIN in 0.116 seconds
[0m13:39:43.442630 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:39:43.444508 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m13:39:43.489415 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.043 seconds
[0m13:39:43.524859 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:39:43.526830 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m13:39:43.531470 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:39:43.546396 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:39:43.550662 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m13:39:43.555409 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:43.687451 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:39:43.691128 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:39:43.694072 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:39:43.701873 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m13:39:43.731503 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m13:39:43.769332 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:39:43.774997 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m13:39:43.804452 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.026 seconds
[0m13:39:43.828073 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m13:39:43.870051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5255c73-3053-47f4-8254-63dc062042c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78472ecd2390>]}
[0m13:39:43.886075 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.74s]
[0m13:39:43.889336 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m13:39:43.930776 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m13:39:43.932944 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m13:39:43.938326 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m13:39:43.935598 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m13:39:43.946917 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m13:39:43.940741 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m13:39:43.951502 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m13:39:43.953443 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m13:39:43.983243 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m13:39:44.001756 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m13:39:44.006706 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m13:39:44.021890 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m13:39:44.045109 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m13:39:44.049274 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m13:39:44.055658 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:39:44.057408 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:39:44.059478 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m13:39:44.061755 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m13:39:44.064085 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:39:44.066793 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:39:44.191758 [debug] [Thread-3 (]: SQL status: BEGIN in 0.128 seconds
[0m13:39:44.193502 [debug] [Thread-4 (]: SQL status: BEGIN in 0.127 seconds
[0m13:39:44.195666 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:39:44.198462 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:39:44.202003 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m13:39:44.204305 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m13:39:44.227909 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.021 seconds
[0m13:39:44.243264 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.036 seconds
[0m13:39:44.246096 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:39:44.258370 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:39:44.261176 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m13:39:44.263222 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m13:39:44.266554 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:44.269165 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:39:44.292430 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:39:44.301418 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:39:44.303387 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m13:39:44.305598 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m13:39:44.308975 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:39:44.310794 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:39:44.318902 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:39:44.325798 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:39:44.327604 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:39:44.329785 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:39:44.331902 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:39:44.334563 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:39:44.343981 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m13:39:44.352915 [debug] [Thread-3 (]: SQL status: COMMIT in 0.014 seconds
[0m13:39:44.360891 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m13:39:44.373489 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m13:39:44.376366 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:39:44.379468 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:39:44.381857 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m13:39:44.385847 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m13:39:44.397292 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m13:39:44.403406 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m13:39:44.405533 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.016 seconds
[0m13:39:44.407884 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5255c73-3053-47f4-8254-63dc062042c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78472a490cb0>]}
[0m13:39:44.417075 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m13:39:44.420399 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.47s]
[0m13:39:44.424119 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m13:39:44.427722 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5255c73-3053-47f4-8254-63dc062042c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78472a580b90>]}
[0m13:39:44.431387 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.49s]
[0m13:39:44.437573 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m13:39:44.448696 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:44.450488 [debug] [MainThread]: On master: BEGIN
[0m13:39:44.454128 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:39:44.489170 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m13:39:44.493333 [debug] [MainThread]: On master: COMMIT
[0m13:39:44.496008 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:44.498075 [debug] [MainThread]: On master: COMMIT
[0m13:39:44.502004 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:39:44.503978 [debug] [MainThread]: On master: Close
[0m13:39:44.507025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:44.508767 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m13:39:44.523596 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m13:39:44.526359 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m13:39:44.534712 [info ] [MainThread]: 
[0m13:39:44.537355 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.47 seconds (2.47s).
[0m13:39:44.547985 [debug] [MainThread]: Command end result
[0m13:39:44.708847 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:39:44.726863 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:39:44.772695 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:39:44.774789 [info ] [MainThread]: 
[0m13:39:44.777189 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:39:44.779060 [info ] [MainThread]: 
[0m13:39:44.790727 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:39:44.844701 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.224467, "process_in_blocks": "194936", "process_kernel_time": 3.205986, "process_mem_max_rss": "94492", "process_out_blocks": "3408", "process_user_time": 10.281126}
[0m13:39:44.860843 [debug] [MainThread]: Command `dbt run` succeeded at 13:39:44.860063 after 7.24 seconds
[0m13:39:44.862756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78472d8eec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78472d8ec6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78472d8ed070>]}
[0m13:39:44.864542 [debug] [MainThread]: Flushing usage events
[0m13:39:45.761659 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:40:21.042155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f2a374680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f2a6b4620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f2a6209e0>]}


============================== 13:40:21.192866 | fbc85f09-9d40-46d3-9e45-19659c353f93 ==============================
[0m13:40:21.192866 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:40:21.195692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:40:22.616868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbc85f09-9d40-46d3-9e45-19659c353f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f2a5a3710>]}
[0m13:40:23.018389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbc85f09-9d40-46d3-9e45-19659c353f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f2a076150>]}
[0m13:40:23.063286 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:40:24.260169 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:40:25.240445 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:40:25.256339 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:40:25.469997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbc85f09-9d40-46d3-9e45-19659c353f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f26e49490>]}
[0m13:40:25.865789 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:40:25.926498 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:40:26.213928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbc85f09-9d40-46d3-9e45-19659c353f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f26acf5c0>]}
[0m13:40:26.246236 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:40:26.248963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbc85f09-9d40-46d3-9e45-19659c353f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f26e490d0>]}
[0m13:40:26.266251 [info ] [MainThread]: 
[0m13:40:26.268667 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:40:26.270167 [info ] [MainThread]: 
[0m13:40:26.277706 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:40:26.319039 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:40:26.995027 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:40:27.004514 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:40:27.007035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:27.581252 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.564 seconds
[0m13:40:27.596859 [debug] [ThreadPool]: On list_db: Close
[0m13:40:27.613363 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev'
[0m13:40:27.655307 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:40:27.659575 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m13:40:27.661748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:29.002043 [debug] [ThreadPool]: SQL status: BEGIN in 1.328 seconds
[0m13:40:29.016686 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:40:29.018216 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:40:29.069081 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.048 seconds
[0m13:40:29.080329 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m13:40:29.084515 [debug] [ThreadPool]: On list_db_dev: Close
[0m13:40:29.149581 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:29.151293 [debug] [MainThread]: On master: BEGIN
[0m13:40:29.158316 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:40:30.339581 [debug] [MainThread]: SQL status: BEGIN in 1.145 seconds
[0m13:40:30.393854 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:30.399561 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:40:30.544100 [debug] [MainThread]: SQL status: SELECT 0 in 0.129 seconds
[0m13:40:30.598412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbc85f09-9d40-46d3-9e45-19659c353f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f25d99370>]}
[0m13:40:30.620565 [debug] [MainThread]: On master: ROLLBACK
[0m13:40:30.650433 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:30.657182 [debug] [MainThread]: On master: BEGIN
[0m13:40:30.683099 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m13:40:30.685838 [debug] [MainThread]: On master: COMMIT
[0m13:40:30.687626 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:30.690758 [debug] [MainThread]: On master: COMMIT
[0m13:40:30.693078 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:40:30.694795 [debug] [MainThread]: On master: Close
[0m13:40:30.775564 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m13:40:30.789364 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m13:40:30.791793 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m13:40:30.793704 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m13:40:30.868533 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m13:40:30.878436 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m13:40:31.168658 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m13:40:31.203867 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:40:31.205465 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m13:40:31.207075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:32.367128 [debug] [Thread-1 (]: SQL status: BEGIN in 1.144 seconds
[0m13:40:32.379831 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:40:32.385739 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m13:40:32.462698 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.074 seconds
[0m13:40:32.503026 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:40:32.508970 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m13:40:32.517413 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m13:40:32.534473 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:40:32.536951 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m13:40:32.540798 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:40:32.655655 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:40:32.659733 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:40:32.661846 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:40:32.685782 [debug] [Thread-1 (]: SQL status: COMMIT in 0.020 seconds
[0m13:40:32.739480 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m13:40:32.772436 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:40:32.774273 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m13:40:32.805359 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.029 seconds
[0m13:40:32.829216 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m13:40:32.870539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbc85f09-9d40-46d3-9e45-19659c353f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f2a5a28a0>]}
[0m13:40:32.878800 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 2.05s]
[0m13:40:32.882541 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m13:40:32.895077 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m13:40:32.897835 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m13:40:32.903751 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m13:40:32.900792 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m13:40:32.907181 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m13:40:32.909828 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m13:40:32.911710 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m13:40:32.914052 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m13:40:32.938212 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m13:40:32.953487 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m13:40:32.959930 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m13:40:32.975509 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m13:40:32.997017 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m13:40:33.002405 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m13:40:33.009365 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:40:33.011185 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m13:40:33.013471 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:40:33.017010 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:40:33.029252 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m13:40:33.030913 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:40:33.769854 [debug] [Thread-3 (]: SQL status: BEGIN in 0.745 seconds
[0m13:40:33.793794 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:40:33.774240 [debug] [Thread-4 (]: SQL status: BEGIN in 0.732 seconds
[0m13:40:33.797875 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:40:33.799513 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m13:40:33.795899 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m13:40:33.825504 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.024 seconds
[0m13:40:33.845509 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:40:33.847823 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m13:40:33.852550 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.048 seconds
[0m13:40:33.860070 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m13:40:33.883938 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:40:33.880844 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:40:33.886476 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m13:40:33.888465 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m13:40:33.892067 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:40:33.893535 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:40:33.905035 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:40:33.911338 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:40:33.913731 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m13:40:33.915839 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:40:33.919204 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:40:33.920714 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:40:33.928851 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:40:33.930558 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m13:40:33.932445 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:40:33.945335 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:40:33.947298 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m13:40:33.951661 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:40:33.953498 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m13:40:33.955855 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m13:40:33.965275 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m13:40:33.969145 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:40:33.971156 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m13:40:33.992463 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.025 seconds
[0m13:40:33.998012 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m13:40:34.000132 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.027 seconds
[0m13:40:34.009641 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m13:40:34.026132 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbc85f09-9d40-46d3-9e45-19659c353f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f2438e420>]}
[0m13:40:34.029311 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbc85f09-9d40-46d3-9e45-19659c353f93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f243c3bc0>]}
[0m13:40:34.041404 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 1.11s]
[0m13:40:34.050081 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m13:40:34.045759 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 1.12s]
[0m13:40:34.055455 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m13:40:34.080941 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:34.085788 [debug] [MainThread]: On master: BEGIN
[0m13:40:34.090983 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:40:35.060524 [debug] [MainThread]: SQL status: BEGIN in 0.957 seconds
[0m13:40:35.079898 [debug] [MainThread]: On master: COMMIT
[0m13:40:35.082118 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:35.084364 [debug] [MainThread]: On master: COMMIT
[0m13:40:35.086937 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:40:35.088722 [debug] [MainThread]: On master: Close
[0m13:40:35.093693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:35.095484 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m13:40:35.098394 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m13:40:35.099627 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m13:40:35.101273 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m13:40:35.115354 [info ] [MainThread]: 
[0m13:40:35.118521 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 8.83 seconds (8.83s).
[0m13:40:35.124334 [debug] [MainThread]: Command end result
[0m13:40:35.262205 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:40:35.302357 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:40:35.354301 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:40:35.356674 [info ] [MainThread]: 
[0m13:40:35.359769 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:40:35.363041 [info ] [MainThread]: 
[0m13:40:35.367453 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:40:35.418039 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.881029, "process_in_blocks": "635584", "process_kernel_time": 5.64475, "process_mem_max_rss": "94384", "process_out_blocks": "3480", "process_user_time": 10.549205}
[0m13:40:35.440213 [debug] [MainThread]: Command `dbt run` succeeded at 13:40:35.439480 after 14.91 seconds
[0m13:40:35.445665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f29340dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f2872af00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x701f29a4bbf0>]}
[0m13:40:35.450307 [debug] [MainThread]: Flushing usage events
[0m13:40:45.569369 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:09:21.007996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9a1168bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9a07d8f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9a005cb30>]}


============================== 15:09:21.028862 | a69d8eb0-e0db-433c-a5d7-bb000aab54ff ==============================
[0m15:09:21.028862 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:09:21.030503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:09:21.923150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a69d8eb0-e0db-433c-a5d7-bb000aab54ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b99fbc53d0>]}
[0m15:09:22.095658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a69d8eb0-e0db-433c-a5d7-bb000aab54ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9a0962150>]}
[0m15:09:22.100450 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:09:22.439633 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:09:22.927602 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:09:22.928793 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:09:23.118259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a69d8eb0-e0db-433c-a5d7-bb000aab54ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b99e377dd0>]}
[0m15:09:23.427010 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:09:23.435750 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:09:23.571054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a69d8eb0-e0db-433c-a5d7-bb000aab54ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b99e0577a0>]}
[0m15:09:23.572661 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:09:23.574121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a69d8eb0-e0db-433c-a5d7-bb000aab54ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b99e377530>]}
[0m15:09:23.581196 [info ] [MainThread]: 
[0m15:09:23.582739 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:09:23.583884 [info ] [MainThread]: 
[0m15:09:23.585767 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:09:23.596568 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:09:23.832335 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:09:23.833338 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:09:23.834593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:24.023369 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.189 seconds
[0m15:09:24.026903 [debug] [ThreadPool]: On list_db: Close
[0m15:09:24.031732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m15:09:24.054477 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:09:24.055692 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m15:09:24.057002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:24.078638 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m15:09:24.079879 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:09:24.082464 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:09:24.116381 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.032 seconds
[0m15:09:24.119692 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m15:09:24.121326 [debug] [ThreadPool]: On list_db_dev: Close
[0m15:09:24.135521 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:24.136426 [debug] [MainThread]: On master: BEGIN
[0m15:09:24.137165 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:09:24.153310 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m15:09:24.154879 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:24.156098 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:09:24.204445 [debug] [MainThread]: SQL status: SELECT 0 in 0.047 seconds
[0m15:09:24.207993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a69d8eb0-e0db-433c-a5d7-bb000aab54ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b99fbc6420>]}
[0m15:09:24.209489 [debug] [MainThread]: On master: ROLLBACK
[0m15:09:24.211486 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:24.212710 [debug] [MainThread]: On master: BEGIN
[0m15:09:24.215231 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:09:24.216281 [debug] [MainThread]: On master: COMMIT
[0m15:09:24.217254 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:24.218400 [debug] [MainThread]: On master: COMMIT
[0m15:09:24.219871 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:09:24.221636 [debug] [MainThread]: On master: Close
[0m15:09:24.231656 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m15:09:24.233723 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m15:09:24.235402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m15:09:24.236791 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m15:09:24.256083 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m15:09:24.259009 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m15:09:24.375867 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m15:09:24.379156 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:09:24.380386 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m15:09:24.381416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:09:24.404472 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m15:09:24.405886 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:09:24.407478 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m15:09:24.473526 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.065 seconds
[0m15:09:24.487793 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:09:24.488943 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m15:09:24.491426 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:09:24.499576 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:09:24.500792 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m15:09:24.503102 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:09:24.613031 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:09:24.614777 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:09:24.616329 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:09:24.632424 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m15:09:24.664836 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m15:09:24.684096 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:09:24.685555 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m15:09:24.700643 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m15:09:24.709855 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m15:09:24.717119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a69d8eb0-e0db-433c-a5d7-bb000aab54ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b9a072e720>]}
[0m15:09:24.720277 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.48s]
[0m15:09:24.723523 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m15:09:24.727221 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m15:09:24.728688 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m15:09:24.730777 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m15:09:24.733002 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m15:09:24.735033 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m15:09:24.736618 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m15:09:24.738263 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m15:09:24.739628 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m15:09:24.749210 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m15:09:24.757078 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m15:09:24.760540 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m15:09:24.761564 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m15:09:24.769176 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m15:09:24.776880 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m15:09:24.779410 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:09:24.780479 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m15:09:24.781553 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:09:24.783185 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:09:24.784719 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m15:09:24.785924 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:09:24.810464 [debug] [Thread-3 (]: SQL status: BEGIN in 0.029 seconds
[0m15:09:24.811960 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:09:24.813135 [debug] [Thread-4 (]: SQL status: BEGIN in 0.027 seconds
[0m15:09:24.814261 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m15:09:24.815642 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:09:24.817307 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m15:09:24.835739 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.017 seconds
[0m15:09:24.842852 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:09:24.843934 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m15:09:24.846874 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.030 seconds
[0m15:09:24.848095 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:09:24.854441 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:09:24.862602 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:09:24.863797 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m15:09:24.864839 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m15:09:24.866906 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:09:24.868000 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:09:24.871581 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:09:24.880413 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:09:24.881720 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:09:24.883212 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m15:09:24.884381 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:09:24.886694 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:09:24.891391 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:09:24.893011 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m15:09:24.894283 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:09:24.902533 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m15:09:24.903760 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:09:24.905373 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:09:24.907185 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m15:09:24.910845 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m15:09:24.917005 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m15:09:24.918080 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m15:09:24.919583 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:09:24.922944 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m15:09:24.924366 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m15:09:24.926478 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a69d8eb0-e0db-433c-a5d7-bb000aab54ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b99c15be00>]}
[0m15:09:24.928302 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.19s]
[0m15:09:24.930243 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m15:09:24.931737 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m15:09:24.935132 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m15:09:24.937148 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a69d8eb0-e0db-433c-a5d7-bb000aab54ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b99d24a870>]}
[0m15:09:24.939172 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.20s]
[0m15:09:24.941850 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m15:09:24.947625 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:24.948703 [debug] [MainThread]: On master: BEGIN
[0m15:09:24.949570 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:09:24.964724 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m15:09:24.965671 [debug] [MainThread]: On master: COMMIT
[0m15:09:24.966933 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:24.967737 [debug] [MainThread]: On master: COMMIT
[0m15:09:24.969010 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:09:24.969822 [debug] [MainThread]: On master: Close
[0m15:09:24.971650 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:24.972686 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m15:09:24.973641 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m15:09:24.974667 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m15:09:24.975764 [info ] [MainThread]: 
[0m15:09:24.977367 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.39 seconds (1.39s).
[0m15:09:24.980645 [debug] [MainThread]: Command end result
[0m15:09:25.032889 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:09:25.036911 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:09:25.049354 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:09:25.050561 [info ] [MainThread]: 
[0m15:09:25.051818 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:09:25.052830 [info ] [MainThread]: 
[0m15:09:25.053828 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:09:25.057278 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.190081, "process_in_blocks": "116408", "process_kernel_time": 2.065775, "process_mem_max_rss": "107272", "process_out_blocks": "3400", "process_user_time": 7.390066}
[0m15:09:25.058410 [debug] [MainThread]: Command `dbt run` succeeded at 15:09:25.058080 after 4.19 seconds
[0m15:09:25.059169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b99fdfbce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b99fbf3aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b99d4fed20>]}
[0m15:09:25.059931 [debug] [MainThread]: Flushing usage events
[0m15:09:25.805278 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:11:38.401500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722c44f36bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722c44f35fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722c44f94c50>]}


============================== 16:11:38.467102 | 110d10d6-e7c5-47d0-a4da-f78e2a09cf1d ==============================
[0m16:11:38.467102 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:11:38.469726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:11:39.475629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '110d10d6-e7c5-47d0-a4da-f78e2a09cf1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722c448b3bf0>]}
[0m16:11:39.772743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '110d10d6-e7c5-47d0-a4da-f78e2a09cf1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722c4494bc50>]}
[0m16:11:39.778148 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:11:40.485979 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m16:11:41.033907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:11:41.034870 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:11:41.125067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '110d10d6-e7c5-47d0-a4da-f78e2a09cf1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722c42e1b380>]}
[0m16:11:41.409249 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:11:41.421687 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:11:41.625726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '110d10d6-e7c5-47d0-a4da-f78e2a09cf1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722c4492e960>]}
[0m16:11:41.627151 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m16:11:41.628666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '110d10d6-e7c5-47d0-a4da-f78e2a09cf1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722c42f78d70>]}
[0m16:11:41.636269 [info ] [MainThread]: 
[0m16:11:41.637827 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:11:41.639069 [info ] [MainThread]: 
[0m16:11:41.640914 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:11:41.657047 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:11:42.043108 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:11:42.044746 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:11:42.046254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:42.268048 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.222 seconds
[0m16:11:42.270964 [debug] [ThreadPool]: On list_db: Close
[0m16:11:42.275774 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m16:11:42.288268 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:11:42.289192 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m16:11:42.289909 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:42.313250 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m16:11:42.314551 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:11:42.316085 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:11:42.352680 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.034 seconds
[0m16:11:42.357299 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m16:11:42.359055 [debug] [ThreadPool]: On list_db_dev: Close
[0m16:11:42.377345 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:42.378663 [debug] [MainThread]: On master: BEGIN
[0m16:11:42.380097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:42.401155 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m16:11:42.402746 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:42.404346 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:11:42.442851 [debug] [MainThread]: SQL status: SELECT 0 in 0.037 seconds
[0m16:11:42.446738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '110d10d6-e7c5-47d0-a4da-f78e2a09cf1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722c42cd7cb0>]}
[0m16:11:42.448101 [debug] [MainThread]: On master: ROLLBACK
[0m16:11:42.450073 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:42.451635 [debug] [MainThread]: On master: BEGIN
[0m16:11:42.454471 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:11:42.456056 [debug] [MainThread]: On master: COMMIT
[0m16:11:42.457784 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:42.459249 [debug] [MainThread]: On master: COMMIT
[0m16:11:42.461845 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:11:42.463413 [debug] [MainThread]: On master: Close
[0m16:11:42.474501 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m16:11:42.477374 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m16:11:42.479118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m16:11:42.480613 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m16:11:42.499784 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m16:11:42.502698 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m16:11:42.601211 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m16:11:42.603322 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:11:42.604214 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m16:11:42.605181 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:42.625374 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m16:11:42.626916 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:11:42.628531 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m16:11:42.712650 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.082 seconds
[0m16:11:42.726593 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:11:42.727917 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m16:11:42.736154 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m16:11:42.745059 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:11:42.746245 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m16:11:42.748029 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:42.799824 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:11:42.800670 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:11:42.801526 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:11:42.807613 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:11:42.823022 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m16:11:42.835094 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:11:42.836012 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m16:11:42.856232 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.019 seconds
[0m16:11:42.861256 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m16:11:42.865762 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '110d10d6-e7c5-47d0-a4da-f78e2a09cf1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722c454cde50>]}
[0m16:11:42.867138 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.38s]
[0m16:11:42.868589 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m16:11:42.871593 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m16:11:42.873315 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m16:11:42.875432 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m16:11:42.877329 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m16:11:42.879996 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m16:11:42.882486 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m16:11:42.884355 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m16:11:42.886099 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m16:11:42.895077 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m16:11:42.907982 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m16:11:42.909570 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m16:11:42.910820 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m16:11:42.917755 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m16:11:42.925079 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m16:11:42.927150 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:11:42.929613 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m16:11:42.930613 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:11:42.931702 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:11:42.933194 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m16:11:42.935529 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:11:42.989439 [debug] [Thread-3 (]: SQL status: BEGIN in 0.057 seconds
[0m16:11:42.990816 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:11:42.992538 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m16:11:43.012002 [debug] [Thread-4 (]: SQL status: BEGIN in 0.076 seconds
[0m16:11:43.014050 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:11:43.015497 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m16:11:43.051310 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.034 seconds
[0m16:11:43.061820 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:11:43.063409 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m16:11:43.066497 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:43.068254 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.074 seconds
[0m16:11:43.081634 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:11:43.094076 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:11:43.096036 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m16:11:43.097776 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m16:11:43.101435 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:11:43.102893 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:11:43.109242 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:11:43.122307 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:11:43.127195 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:11:43.128292 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:11:43.129770 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m16:11:43.132717 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:11:43.137586 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:11:43.138917 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m16:11:43.140286 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:11:43.154078 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m16:11:43.155120 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:11:43.156893 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:11:43.158621 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m16:11:43.162175 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m16:11:43.171625 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.012 seconds
[0m16:11:43.173614 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m16:11:43.177083 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m16:11:43.178814 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:11:43.180318 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m16:11:43.181789 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '110d10d6-e7c5-47d0-a4da-f78e2a09cf1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722c41ff1f40>]}
[0m16:11:43.184611 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.30s]
[0m16:11:43.187102 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m16:11:43.190984 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.008 seconds
[0m16:11:43.195021 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m16:11:43.196825 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '110d10d6-e7c5-47d0-a4da-f78e2a09cf1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722c4070be60>]}
[0m16:11:43.199100 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.32s]
[0m16:11:43.201374 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m16:11:43.206886 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:43.207892 [debug] [MainThread]: On master: BEGIN
[0m16:11:43.208799 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:11:43.247085 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m16:11:43.249315 [debug] [MainThread]: On master: COMMIT
[0m16:11:43.253226 [debug] [MainThread]: Using postgres connection "master"
[0m16:11:43.254906 [debug] [MainThread]: On master: COMMIT
[0m16:11:43.257036 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:11:43.258676 [debug] [MainThread]: On master: Close
[0m16:11:43.260226 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:43.261248 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m16:11:43.262488 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m16:11:43.263336 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m16:11:43.265048 [info ] [MainThread]: 
[0m16:11:43.267073 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.62 seconds (1.62s).
[0m16:11:43.271105 [debug] [MainThread]: Command end result
[0m16:11:43.376148 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:11:43.383214 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:11:43.416132 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:11:43.417791 [info ] [MainThread]: 
[0m16:11:43.419779 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:43.421733 [info ] [MainThread]: 
[0m16:11:43.423683 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:11:43.430112 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.286686, "process_in_blocks": "118376", "process_kernel_time": 9.161016, "process_mem_max_rss": "107644", "process_out_blocks": "3392", "process_user_time": 7.488767}
[0m16:11:43.432539 [debug] [MainThread]: Command `dbt run` succeeded at 16:11:43.432026 after 5.29 seconds
[0m16:11:43.434363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722c44cd6660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722c44d04200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722c44c86810>]}
[0m16:11:43.436057 [debug] [MainThread]: Flushing usage events
[0m16:11:44.106064 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:21:22.387440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78deac9d9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78deab0033b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78deab4b3d40>]}


============================== 16:21:22.411704 | 213b619c-78af-46d6-b04b-403d8c23d66f ==============================
[0m16:21:22.411704 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:21:22.413752 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:21:23.093102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '213b619c-78af-46d6-b04b-403d8c23d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78deaa98be30>]}
[0m16:21:23.309935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '213b619c-78af-46d6-b04b-403d8c23d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78deaa8aa3c0>]}
[0m16:21:23.313796 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:21:23.807604 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m16:21:24.369136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:21:24.372384 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:21:24.555237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '213b619c-78af-46d6-b04b-403d8c23d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78dea9128e90>]}
[0m16:21:25.049118 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:21:25.089152 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:21:25.345536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '213b619c-78af-46d6-b04b-403d8c23d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78dea8eb4fe0>]}
[0m16:21:25.347577 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m16:21:25.349819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '213b619c-78af-46d6-b04b-403d8c23d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78deaa98bda0>]}
[0m16:21:25.358140 [info ] [MainThread]: 
[0m16:21:25.360313 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:21:25.362214 [info ] [MainThread]: 
[0m16:21:25.364712 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:21:25.389766 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:21:25.762090 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:21:25.765794 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:21:25.767943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:26.148782 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.381 seconds
[0m16:21:26.153012 [debug] [ThreadPool]: On list_db: Close
[0m16:21:26.157957 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m16:21:26.173765 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:21:26.174687 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m16:21:26.175629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:26.196591 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m16:21:26.198058 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:21:26.200186 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:21:26.258677 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.056 seconds
[0m16:21:26.264450 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m16:21:26.268143 [debug] [ThreadPool]: On list_db_dev: Close
[0m16:21:26.311374 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:26.316903 [debug] [MainThread]: On master: BEGIN
[0m16:21:26.318779 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:21:26.357753 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m16:21:26.359531 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:26.362605 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:21:26.435714 [debug] [MainThread]: SQL status: SELECT 0 in 0.070 seconds
[0m16:21:26.451023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '213b619c-78af-46d6-b04b-403d8c23d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78dea8e24620>]}
[0m16:21:26.453674 [debug] [MainThread]: On master: ROLLBACK
[0m16:21:26.456166 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:26.457773 [debug] [MainThread]: On master: BEGIN
[0m16:21:26.465839 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:21:26.467534 [debug] [MainThread]: On master: COMMIT
[0m16:21:26.469456 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:26.471119 [debug] [MainThread]: On master: COMMIT
[0m16:21:26.473417 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:21:26.475106 [debug] [MainThread]: On master: Close
[0m16:21:26.492033 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m16:21:26.494891 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m16:21:26.505182 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m16:21:26.506942 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m16:21:26.541343 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m16:21:26.546013 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m16:21:26.732251 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m16:21:26.740402 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:21:26.742988 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m16:21:26.744622 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:26.772681 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m16:21:26.774305 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:21:26.775705 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m16:21:26.863918 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.086 seconds
[0m16:21:26.888821 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:21:26.890374 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m16:21:26.894009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:21:26.909254 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:21:26.911134 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m16:21:26.913903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:26.983582 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:21:26.984816 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:21:26.986084 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:21:26.991649 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:21:27.025938 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m16:21:27.047716 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:21:27.049265 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m16:21:27.064038 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m16:21:27.069492 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m16:21:27.079891 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '213b619c-78af-46d6-b04b-403d8c23d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78deab492270>]}
[0m16:21:27.081891 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.57s]
[0m16:21:27.083598 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m16:21:27.086345 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m16:21:27.087716 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m16:21:27.089944 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m16:21:27.091846 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m16:21:27.093616 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m16:21:27.094879 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m16:21:27.096980 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m16:21:27.099137 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m16:21:27.111785 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m16:21:27.122204 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m16:21:27.125697 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m16:21:27.127155 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m16:21:27.155928 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m16:21:27.161762 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m16:21:27.166418 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:21:27.168332 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m16:21:27.171083 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:21:27.173306 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:21:27.176295 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m16:21:27.178699 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:21:27.206979 [debug] [Thread-4 (]: SQL status: BEGIN in 0.034 seconds
[0m16:21:27.208983 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:21:27.210778 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m16:21:27.212193 [debug] [Thread-3 (]: SQL status: BEGIN in 0.033 seconds
[0m16:21:27.214322 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:21:27.215960 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m16:21:27.233548 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.019 seconds
[0m16:21:27.244673 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:21:27.246580 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m16:21:27.249247 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:27.258426 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.041 seconds
[0m16:21:27.259803 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:21:27.274837 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:21:27.276503 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m16:21:27.278271 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m16:21:27.281442 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:21:27.282924 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:21:27.287629 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:21:27.305778 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:21:27.296385 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:21:27.307752 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:21:27.311185 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m16:21:27.315289 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:21:27.320131 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:21:27.321432 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m16:21:27.322787 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:21:27.329825 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m16:21:27.331758 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:21:27.335283 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:21:27.336686 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m16:21:27.342556 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m16:21:27.354393 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.016 seconds
[0m16:21:27.358416 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m16:21:27.353630 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m16:21:27.361332 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:21:27.363280 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '213b619c-78af-46d6-b04b-403d8c23d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78dea0e33fe0>]}
[0m16:21:27.364771 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m16:21:27.368688 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.27s]
[0m16:21:27.373519 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m16:21:27.380492 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.010 seconds
[0m16:21:27.385616 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m16:21:27.387708 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '213b619c-78af-46d6-b04b-403d8c23d66f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78dea3f01160>]}
[0m16:21:27.389922 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.29s]
[0m16:21:27.392222 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m16:21:27.398110 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:27.399927 [debug] [MainThread]: On master: BEGIN
[0m16:21:27.401930 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:21:27.425057 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m16:21:27.425982 [debug] [MainThread]: On master: COMMIT
[0m16:21:27.426877 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:27.427770 [debug] [MainThread]: On master: COMMIT
[0m16:21:27.429528 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:21:27.430580 [debug] [MainThread]: On master: Close
[0m16:21:27.433289 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:27.435183 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m16:21:27.438049 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m16:21:27.441337 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m16:21:27.443583 [info ] [MainThread]: 
[0m16:21:27.444992 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.08 seconds (2.08s).
[0m16:21:27.448340 [debug] [MainThread]: Command end result
[0m16:21:27.528502 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:21:27.544560 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:21:27.586797 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:21:27.588383 [info ] [MainThread]: 
[0m16:21:27.590696 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:21:27.595976 [info ] [MainThread]: 
[0m16:21:27.597606 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:21:27.604320 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.3615146, "process_in_blocks": "118632", "process_kernel_time": 4.412439, "process_mem_max_rss": "107316", "process_out_blocks": "3392", "process_user_time": 9.360468}
[0m16:21:27.607238 [debug] [MainThread]: Command `dbt run` succeeded at 16:21:27.606646 after 5.37 seconds
[0m16:21:27.609676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78deaafaa9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78deab319670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78deaad37740>]}
[0m16:21:27.616071 [debug] [MainThread]: Flushing usage events
[0m16:21:28.468425 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:22:17.766999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b9b0f20f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b9b33a150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b9a734da0>]}


============================== 16:22:17.792763 | a3390c5c-347b-47f9-9f9b-91f086764d1d ==============================
[0m16:22:17.792763 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:22:17.795219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:22:19.033052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3390c5c-347b-47f9-9f9b-91f086764d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b9a4deb40>]}
[0m16:22:19.366405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3390c5c-347b-47f9-9f9b-91f086764d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b9a3af860>]}
[0m16:22:19.368424 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:22:19.851589 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m16:22:20.305657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:22:20.307017 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:22:20.480514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3390c5c-347b-47f9-9f9b-91f086764d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b98bc4230>]}
[0m16:22:20.860781 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:22:20.869767 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:22:20.941437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3390c5c-347b-47f9-9f9b-91f086764d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b9a6eab70>]}
[0m16:22:20.942691 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m16:22:20.944378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3390c5c-347b-47f9-9f9b-91f086764d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b9a3fade0>]}
[0m16:22:20.952880 [info ] [MainThread]: 
[0m16:22:20.954802 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:22:20.959792 [info ] [MainThread]: 
[0m16:22:20.965935 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:22:20.989462 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:22:21.171336 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:22:21.173987 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:22:21.176635 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:21.218032 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.042 seconds
[0m16:22:21.221836 [debug] [ThreadPool]: On list_db: Close
[0m16:22:21.226290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m16:22:21.248320 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:22:21.249915 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m16:22:21.251178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:22:21.277506 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m16:22:21.281359 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:22:21.282821 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:22:21.310553 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.027 seconds
[0m16:22:21.317137 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m16:22:21.319870 [debug] [ThreadPool]: On list_db_dev: Close
[0m16:22:21.349700 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:21.353813 [debug] [MainThread]: On master: BEGIN
[0m16:22:21.355214 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:22:21.380136 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m16:22:21.381887 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:21.383979 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:22:21.441645 [debug] [MainThread]: SQL status: SELECT 0 in 0.051 seconds
[0m16:22:21.448192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3390c5c-347b-47f9-9f9b-91f086764d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b9a604e60>]}
[0m16:22:21.450935 [debug] [MainThread]: On master: ROLLBACK
[0m16:22:21.453385 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:21.455604 [debug] [MainThread]: On master: BEGIN
[0m16:22:21.461130 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:22:21.462714 [debug] [MainThread]: On master: COMMIT
[0m16:22:21.464519 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:21.466398 [debug] [MainThread]: On master: COMMIT
[0m16:22:21.468865 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:22:21.470834 [debug] [MainThread]: On master: Close
[0m16:22:21.498717 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m16:22:21.501609 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m16:22:21.512828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m16:22:21.514850 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m16:22:21.572798 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m16:22:21.575468 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m16:22:21.808816 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m16:22:21.812153 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:22:21.814001 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m16:22:21.815717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:22:21.855706 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m16:22:21.859367 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:22:21.861399 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m16:22:21.907509 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.043 seconds
[0m16:22:21.949441 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:22:21.951131 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m16:22:21.954588 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:22:21.974776 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:22:21.976310 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m16:22:21.979053 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:22:22.047927 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:22:22.049001 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:22:22.050605 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:22:22.063161 [debug] [Thread-1 (]: SQL status: COMMIT in 0.011 seconds
[0m16:22:22.083777 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m16:22:22.105702 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:22:22.107457 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m16:22:22.120502 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m16:22:22.129699 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m16:22:22.136584 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3390c5c-347b-47f9-9f9b-91f086764d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b9af2e690>]}
[0m16:22:22.138781 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.62s]
[0m16:22:22.142447 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m16:22:22.147580 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m16:22:22.149345 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m16:22:22.151798 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m16:22:22.156397 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m16:22:22.163853 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m16:22:22.166371 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m16:22:22.168371 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m16:22:22.170193 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m16:22:22.197704 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m16:22:22.199199 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m16:22:22.203252 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m16:22:22.204842 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m16:22:22.237985 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m16:22:22.243332 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m16:22:22.247280 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:22:22.249974 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:22:22.252041 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m16:22:22.254153 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m16:22:22.256864 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:22:22.260572 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:22:22.292840 [debug] [Thread-4 (]: SQL status: BEGIN in 0.031 seconds
[0m16:22:22.297016 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:22:22.299470 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m16:22:22.301588 [debug] [Thread-3 (]: SQL status: BEGIN in 0.045 seconds
[0m16:22:22.303950 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:22:22.305893 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m16:22:22.323198 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.020 seconds
[0m16:22:22.340285 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:22:22.349710 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m16:22:22.347474 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.039 seconds
[0m16:22:22.353021 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:22:22.365971 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:22:22.376181 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:22:22.377555 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m16:22:22.378930 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m16:22:22.381637 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:22:22.383037 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:22:22.389022 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:22:22.397774 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:22:22.408270 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:22:22.410731 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:22:22.414349 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m16:22:22.418735 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:22:22.427740 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:22:22.430750 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:22:22.436400 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:22:22.438438 [debug] [Thread-4 (]: SQL status: COMMIT in 0.022 seconds
[0m16:22:22.450792 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m16:22:22.461482 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m16:22:22.465036 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:22:22.466465 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m16:22:22.472066 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m16:22:22.475540 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:22:22.480651 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m16:22:22.488709 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.015 seconds
[0m16:22:22.494533 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m16:22:22.496054 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.011 seconds
[0m16:22:22.502614 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m16:22:22.505677 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3390c5c-347b-47f9-9f9b-91f086764d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b97a69730>]}
[0m16:22:22.507332 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a3390c5c-347b-47f9-9f9b-91f086764d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b97a78590>]}
[0m16:22:22.518357 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.34s]
[0m16:22:22.515827 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.34s]
[0m16:22:22.526113 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m16:22:22.532323 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m16:22:22.545138 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:22.548316 [debug] [MainThread]: On master: BEGIN
[0m16:22:22.550171 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:22:22.575492 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m16:22:22.577510 [debug] [MainThread]: On master: COMMIT
[0m16:22:22.578544 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:22.579489 [debug] [MainThread]: On master: COMMIT
[0m16:22:22.581041 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:22:22.582971 [debug] [MainThread]: On master: Close
[0m16:22:22.585275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:22:22.586827 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m16:22:22.588135 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m16:22:22.596331 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m16:22:22.600072 [info ] [MainThread]: 
[0m16:22:22.602285 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.64 seconds (1.64s).
[0m16:22:22.612929 [debug] [MainThread]: Command end result
[0m16:22:22.708009 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:22:22.713959 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:22:22.748762 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:22:22.750137 [info ] [MainThread]: 
[0m16:22:22.751894 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:22:22.753783 [info ] [MainThread]: 
[0m16:22:22.755642 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:22:22.775881 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.1876807, "process_in_blocks": "0", "process_kernel_time": 2.1702, "process_mem_max_rss": "107896", "process_out_blocks": "3392", "process_user_time": 10.001615}
[0m16:22:22.778511 [debug] [MainThread]: Command `dbt run` succeeded at 16:22:22.777858 after 5.20 seconds
[0m16:22:22.780471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b9a7643b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b9af4c620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x745b989595e0>]}
[0m16:22:22.786139 [debug] [MainThread]: Flushing usage events
[0m16:22:23.394100 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:28:38.767748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c4e82c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c4ec766c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c4edcdfd0>]}


============================== 16:28:38.835903 | 84762038-022f-4742-8d9c-b666f76dbfed ==============================
[0m16:28:38.835903 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:28:38.843453 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:28:41.728993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '84762038-022f-4742-8d9c-b666f76dbfed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c4e7e8050>]}
[0m16:28:42.552557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '84762038-022f-4742-8d9c-b666f76dbfed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c4e9ebef0>]}
[0m16:28:42.571186 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:28:43.458164 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m16:28:45.010078 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:28:45.012138 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:28:45.493538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '84762038-022f-4742-8d9c-b666f76dbfed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c4cf81490>]}
[0m16:28:46.491483 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:28:46.537363 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:28:47.163416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '84762038-022f-4742-8d9c-b666f76dbfed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c4cc8cb00>]}
[0m16:28:47.178358 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m16:28:47.180928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84762038-022f-4742-8d9c-b666f76dbfed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c4cc885f0>]}
[0m16:28:47.230202 [info ] [MainThread]: 
[0m16:28:47.233567 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:28:47.236572 [info ] [MainThread]: 
[0m16:28:47.251540 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:28:47.334576 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:28:48.891467 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:28:48.897051 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:28:48.898508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:49.961711 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.063 seconds
[0m16:28:49.978127 [debug] [ThreadPool]: On list_db: Close
[0m16:28:49.984343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m16:28:50.042162 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:28:50.043904 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m16:28:50.045354 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:28:50.376015 [debug] [ThreadPool]: SQL status: BEGIN in 0.330 seconds
[0m16:28:50.378074 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:28:50.389255 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:28:50.883630 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.492 seconds
[0m16:28:50.899690 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m16:28:50.903017 [debug] [ThreadPool]: On list_db_dev: Close
[0m16:28:50.971451 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:50.974394 [debug] [MainThread]: On master: BEGIN
[0m16:28:50.987634 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:28:51.736995 [debug] [MainThread]: SQL status: BEGIN in 0.749 seconds
[0m16:28:51.738970 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:51.741844 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:28:52.331020 [debug] [MainThread]: SQL status: SELECT 0 in 0.568 seconds
[0m16:28:52.344162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '84762038-022f-4742-8d9c-b666f76dbfed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c4e7978c0>]}
[0m16:28:52.352113 [debug] [MainThread]: On master: ROLLBACK
[0m16:28:52.358734 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:52.361176 [debug] [MainThread]: On master: BEGIN
[0m16:28:52.366202 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:28:52.371542 [debug] [MainThread]: On master: COMMIT
[0m16:28:52.380963 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:52.389523 [debug] [MainThread]: On master: COMMIT
[0m16:28:52.392241 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:28:52.396407 [debug] [MainThread]: On master: Close
[0m16:28:52.437525 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m16:28:52.444352 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m16:28:52.452248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m16:28:52.455487 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m16:28:52.550868 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m16:28:52.577951 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m16:28:53.157748 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m16:28:53.178596 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:28:53.182408 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m16:28:53.184514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:53.367715 [debug] [Thread-1 (]: SQL status: BEGIN in 0.183 seconds
[0m16:28:53.371096 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:28:53.373310 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m16:28:53.662979 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.285 seconds
[0m16:28:53.736942 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:28:53.739414 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m16:28:53.759401 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.018 seconds
[0m16:28:53.799824 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:28:53.802783 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m16:28:53.807015 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:28:54.092107 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:28:54.104868 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:28:54.107651 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:28:54.137286 [debug] [Thread-1 (]: SQL status: COMMIT in 0.025 seconds
[0m16:28:54.255566 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m16:28:54.367893 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:28:54.380832 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m16:28:54.503893 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.119 seconds
[0m16:28:54.534975 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m16:28:54.565846 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84762038-022f-4742-8d9c-b666f76dbfed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c4ebce180>]}
[0m16:28:54.581165 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 2.10s]
[0m16:28:54.602525 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m16:28:54.614912 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m16:28:54.629791 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m16:28:54.635128 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m16:28:54.646636 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m16:28:54.651300 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m16:28:54.654719 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m16:28:54.667569 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m16:28:54.682603 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m16:28:54.784070 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m16:28:54.785998 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m16:28:54.816504 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m16:28:54.851422 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m16:28:54.864636 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m16:28:54.898586 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m16:28:54.912973 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:28:54.914717 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m16:28:54.926493 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:28:54.928697 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:28:54.932616 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m16:28:54.943408 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:28:55.094082 [debug] [Thread-3 (]: SQL status: BEGIN in 0.165 seconds
[0m16:28:55.096350 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:28:55.112156 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m16:28:55.175461 [debug] [Thread-4 (]: SQL status: BEGIN in 0.238 seconds
[0m16:28:55.177553 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:28:55.179456 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m16:28:55.284697 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.170 seconds
[0m16:28:55.331321 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.150 seconds
[0m16:28:55.350637 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:28:55.397626 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m16:28:55.400992 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:28:55.414216 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m16:28:55.404531 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m16:28:55.464286 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.026 seconds
[0m16:28:55.452351 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:28:55.489408 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:28:55.492158 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m16:28:55.494958 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m16:28:55.504968 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:28:55.522816 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m16:28:55.545913 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:28:55.550659 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:28:55.553265 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:28:55.557747 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:28:55.555060 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:28:55.566335 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:28:55.649753 [debug] [Thread-4 (]: SQL status: COMMIT in 0.090 seconds
[0m16:28:55.671027 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m16:28:55.684500 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:28:55.686571 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m16:28:55.713547 [debug] [Thread-3 (]: SQL status: COMMIT in 0.144 seconds
[0m16:28:55.733695 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m16:28:55.737507 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:28:55.749194 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m16:28:55.824504 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.136 seconds
[0m16:28:55.844377 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m16:28:55.855922 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84762038-022f-4742-8d9c-b666f76dbfed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c44d33800>]}
[0m16:28:55.858669 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.107 seconds
[0m16:28:55.863335 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 1.19s]
[0m16:28:55.876241 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m16:28:55.894141 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m16:28:55.899260 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '84762038-022f-4742-8d9c-b666f76dbfed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c47e35ee0>]}
[0m16:28:55.904814 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 1.25s]
[0m16:28:55.919894 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m16:28:56.032966 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:56.042832 [debug] [MainThread]: On master: BEGIN
[0m16:28:56.048577 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:28:56.287356 [debug] [MainThread]: SQL status: BEGIN in 0.240 seconds
[0m16:28:56.289129 [debug] [MainThread]: On master: COMMIT
[0m16:28:56.291040 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:56.302525 [debug] [MainThread]: On master: COMMIT
[0m16:28:56.304943 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:28:56.306519 [debug] [MainThread]: On master: Close
[0m16:28:56.321581 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:28:56.323685 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m16:28:56.325577 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m16:28:56.328118 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m16:28:56.335344 [info ] [MainThread]: 
[0m16:28:56.339763 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 9.08 seconds (9.08s).
[0m16:28:56.345907 [debug] [MainThread]: Command end result
[0m16:28:56.589664 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:28:56.605257 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:28:56.680994 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:28:56.686807 [info ] [MainThread]: 
[0m16:28:56.693690 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:28:56.696029 [info ] [MainThread]: 
[0m16:28:56.699078 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:28:56.714998 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.889946, "process_in_blocks": "115952", "process_kernel_time": 14.777518, "process_mem_max_rss": "107520", "process_out_blocks": "3392", "process_user_time": 19.859509}
[0m16:28:56.727989 [debug] [MainThread]: Command `dbt run` succeeded at 16:28:56.727264 after 18.90 seconds
[0m16:28:56.730291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c51f96870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c4e7952b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x758c4ed66330>]}
[0m16:28:56.737229 [debug] [MainThread]: Flushing usage events
[0m16:28:58.371719 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:33:48.372409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d6c3cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d62ddb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d6c3d280>]}


============================== 16:33:48.444116 | 72182b72-c03f-4c5f-8386-b074cb013fb8 ==============================
[0m16:33:48.444116 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:33:48.448595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:33:50.312332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72182b72-c03f-4c5f-8386-b074cb013fb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d7e9f2c0>]}
[0m16:33:50.529015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72182b72-c03f-4c5f-8386-b074cb013fb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d60207a0>]}
[0m16:33:50.532842 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:33:51.007750 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m16:33:51.905261 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:33:51.906742 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:33:52.040828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72182b72-c03f-4c5f-8386-b074cb013fb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d6151310>]}
[0m16:33:52.352823 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:33:52.362469 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:33:52.588649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72182b72-c03f-4c5f-8386-b074cb013fb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d4466de0>]}
[0m16:33:52.589905 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m16:33:52.591410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72182b72-c03f-4c5f-8386-b074cb013fb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d441b410>]}
[0m16:33:52.597793 [info ] [MainThread]: 
[0m16:33:52.600588 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:33:52.602568 [info ] [MainThread]: 
[0m16:33:52.605378 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:33:52.627672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:33:53.016722 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:33:53.018318 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:33:53.019821 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:33:53.308777 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.289 seconds
[0m16:33:53.313134 [debug] [ThreadPool]: On list_db: Close
[0m16:33:53.318764 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m16:33:53.340270 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:33:53.341550 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m16:33:53.342864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:33:53.404116 [debug] [ThreadPool]: SQL status: BEGIN in 0.061 seconds
[0m16:33:53.405489 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:33:53.406969 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:33:53.523749 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.115 seconds
[0m16:33:53.528021 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m16:33:53.529938 [debug] [ThreadPool]: On list_db_dev: Close
[0m16:33:53.550059 [debug] [MainThread]: Using postgres connection "master"
[0m16:33:53.551663 [debug] [MainThread]: On master: BEGIN
[0m16:33:53.552774 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:33:53.608693 [debug] [MainThread]: SQL status: BEGIN in 0.056 seconds
[0m16:33:53.610483 [debug] [MainThread]: Using postgres connection "master"
[0m16:33:53.612144 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:33:53.705583 [debug] [MainThread]: SQL status: SELECT 0 in 0.091 seconds
[0m16:33:53.711158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72182b72-c03f-4c5f-8386-b074cb013fb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d72e2e70>]}
[0m16:33:53.713315 [debug] [MainThread]: On master: ROLLBACK
[0m16:33:53.715689 [debug] [MainThread]: Using postgres connection "master"
[0m16:33:53.717129 [debug] [MainThread]: On master: BEGIN
[0m16:33:53.722822 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:33:53.724543 [debug] [MainThread]: On master: COMMIT
[0m16:33:53.726121 [debug] [MainThread]: Using postgres connection "master"
[0m16:33:53.728418 [debug] [MainThread]: On master: COMMIT
[0m16:33:53.731034 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:33:53.733018 [debug] [MainThread]: On master: Close
[0m16:33:53.754368 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m16:33:53.758038 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m16:33:53.763564 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m16:33:53.765963 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m16:33:53.805583 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m16:33:53.809625 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m16:33:53.977474 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m16:33:53.981352 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:33:53.983454 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m16:33:53.984981 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:33:54.009541 [debug] [Thread-1 (]: SQL status: BEGIN in 0.024 seconds
[0m16:33:54.011163 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:33:54.012981 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m16:33:54.141729 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.127 seconds
[0m16:33:54.159361 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:33:54.160424 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m16:33:54.163417 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:33:54.174099 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:33:54.175268 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m16:33:54.177410 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:33:54.243289 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:33:54.244719 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:33:54.246097 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:33:54.252426 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:33:54.285843 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m16:33:54.305838 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:33:54.307652 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m16:33:54.333321 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.024 seconds
[0m16:33:54.341529 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m16:33:54.350361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72182b72-c03f-4c5f-8386-b074cb013fb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d6a79dc0>]}
[0m16:33:54.354211 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.58s]
[0m16:33:54.357517 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m16:33:54.362809 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m16:33:54.367272 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m16:33:54.373676 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m16:33:54.376673 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m16:33:54.380216 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m16:33:54.391184 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m16:33:54.393021 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m16:33:54.416508 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m16:33:54.418175 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m16:33:54.439206 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m16:33:54.441214 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m16:33:54.456514 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m16:33:54.458995 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m16:33:54.473403 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:33:54.480590 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m16:33:54.479653 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m16:33:54.483797 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:33:54.489063 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:33:54.491077 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m16:33:54.492907 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:33:54.514910 [debug] [Thread-3 (]: SQL status: BEGIN in 0.031 seconds
[0m16:33:54.516756 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:33:54.518204 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m16:33:54.529405 [debug] [Thread-4 (]: SQL status: BEGIN in 0.036 seconds
[0m16:33:54.531202 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:33:54.533279 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m16:33:54.559365 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.040 seconds
[0m16:33:54.575464 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.040 seconds
[0m16:33:54.582218 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:33:54.595028 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m16:33:54.597558 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:33:54.599486 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m16:33:54.600912 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:33:54.608896 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m16:33:54.618735 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:33:54.623339 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:33:54.624987 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m16:33:54.627508 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m16:33:54.630159 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:33:54.631825 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:33:54.637681 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:33:54.644815 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:33:54.647091 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:33:54.648571 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:33:54.650002 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:33:54.651553 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:33:54.657565 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m16:33:54.666775 [debug] [Thread-3 (]: SQL status: COMMIT in 0.013 seconds
[0m16:33:54.668933 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m16:33:54.679070 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m16:33:54.681190 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:33:54.683873 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:33:54.685460 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m16:33:54.687176 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m16:33:54.695801 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m16:33:54.701776 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m16:33:54.703603 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.015 seconds
[0m16:33:54.708788 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m16:33:54.710871 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72182b72-c03f-4c5f-8386-b074cb013fb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d364d790>]}
[0m16:33:54.713677 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.33s]
[0m16:33:54.716091 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '72182b72-c03f-4c5f-8386-b074cb013fb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d35ba0f0>]}
[0m16:33:54.719182 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m16:33:54.722434 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.33s]
[0m16:33:54.727303 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m16:33:54.736465 [debug] [MainThread]: Using postgres connection "master"
[0m16:33:54.738689 [debug] [MainThread]: On master: BEGIN
[0m16:33:54.740540 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:33:54.789986 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m16:33:54.793623 [debug] [MainThread]: On master: COMMIT
[0m16:33:54.795407 [debug] [MainThread]: Using postgres connection "master"
[0m16:33:54.797199 [debug] [MainThread]: On master: COMMIT
[0m16:33:54.799963 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:33:54.802215 [debug] [MainThread]: On master: Close
[0m16:33:54.805884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:33:54.812736 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m16:33:54.815532 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m16:33:54.817968 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m16:33:54.821826 [info ] [MainThread]: 
[0m16:33:54.831557 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.22 seconds (2.22s).
[0m16:33:54.838405 [debug] [MainThread]: Command end result
[0m16:33:54.950635 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:33:54.956505 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:33:54.985060 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:33:54.986556 [info ] [MainThread]: 
[0m16:33:54.989591 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:33:54.991706 [info ] [MainThread]: 
[0m16:33:54.993424 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:33:55.000752 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.8712463, "process_in_blocks": "118808", "process_kernel_time": 6.895083, "process_mem_max_rss": "107416", "process_out_blocks": "3392", "process_user_time": 8.883736}
[0m16:33:55.003631 [debug] [MainThread]: Command `dbt run` succeeded at 16:33:55.003003 after 6.87 seconds
[0m16:33:55.006503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d62ddb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d64e2150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d43fee40>]}
[0m16:33:55.009789 [debug] [MainThread]: Flushing usage events
[0m16:33:55.777010 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:36:43.927449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e40c11bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e40bacdc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e40b7b5370>]}


============================== 16:36:43.960159 | ccec69b2-f5f2-4ceb-92f5-59c428e1f940 ==============================
[0m16:36:43.960159 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:36:43.969205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:36:45.448197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccec69b2-f5f2-4ceb-92f5-59c428e1f940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e40c1f9f40>]}
[0m16:36:45.789255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ccec69b2-f5f2-4ceb-92f5-59c428e1f940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e409bf8350>]}
[0m16:36:45.803900 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:36:46.321444 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m16:36:47.296481 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:47.301316 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:47.535682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccec69b2-f5f2-4ceb-92f5-59c428e1f940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e409c9c380>]}
[0m16:36:48.029315 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:36:48.047150 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:36:48.242521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccec69b2-f5f2-4ceb-92f5-59c428e1f940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e409998ec0>]}
[0m16:36:48.244581 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m16:36:48.246264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccec69b2-f5f2-4ceb-92f5-59c428e1f940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e40997a9f0>]}
[0m16:36:48.253235 [info ] [MainThread]: 
[0m16:36:48.254801 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:36:48.257175 [info ] [MainThread]: 
[0m16:36:48.260859 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:36:48.295098 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:36:48.681803 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:36:48.684470 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:36:48.686779 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:48.854753 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.168 seconds
[0m16:36:48.860822 [debug] [ThreadPool]: On list_db: Close
[0m16:36:48.867940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m16:36:48.889407 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:36:48.891046 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m16:36:48.892021 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:48.921643 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m16:36:48.923094 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:36:48.924681 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:36:48.982006 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.056 seconds
[0m16:36:48.986282 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m16:36:48.988406 [debug] [ThreadPool]: On list_db_dev: Close
[0m16:36:49.014320 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:49.015632 [debug] [MainThread]: On master: BEGIN
[0m16:36:49.016705 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:49.039508 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m16:36:49.042293 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:49.047804 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:36:49.133523 [debug] [MainThread]: SQL status: SELECT 0 in 0.083 seconds
[0m16:36:49.144606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccec69b2-f5f2-4ceb-92f5-59c428e1f940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e4098176b0>]}
[0m16:36:49.146588 [debug] [MainThread]: On master: ROLLBACK
[0m16:36:49.148833 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:49.151545 [debug] [MainThread]: On master: BEGIN
[0m16:36:49.154387 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:36:49.156172 [debug] [MainThread]: On master: COMMIT
[0m16:36:49.157753 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:49.159263 [debug] [MainThread]: On master: COMMIT
[0m16:36:49.161758 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:36:49.165092 [debug] [MainThread]: On master: Close
[0m16:36:49.195269 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m16:36:49.203385 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m16:36:49.205871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m16:36:49.213644 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m16:36:49.258043 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m16:36:49.260544 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m16:36:49.424409 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m16:36:49.427726 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:36:49.428957 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m16:36:49.429939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:49.482797 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m16:36:49.484911 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:36:49.486156 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m16:36:49.609625 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.122 seconds
[0m16:36:49.645856 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:36:49.648017 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m16:36:49.653878 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:36:49.664948 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:36:49.666807 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m16:36:49.670963 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:36:49.788993 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:36:49.790581 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:36:49.792323 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:36:49.800556 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m16:36:49.849588 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m16:36:49.891061 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:36:49.892557 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m16:36:49.916574 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.022 seconds
[0m16:36:49.924044 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m16:36:49.929906 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccec69b2-f5f2-4ceb-92f5-59c428e1f940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e40b483d10>]}
[0m16:36:49.932378 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.72s]
[0m16:36:49.937622 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m16:36:49.946633 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m16:36:49.949897 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m16:36:49.956676 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m16:36:49.952493 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m16:36:49.959406 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m16:36:49.962845 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m16:36:49.965472 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m16:36:49.967694 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m16:36:49.991765 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m16:36:50.009461 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m16:36:50.013339 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m16:36:50.016444 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m16:36:50.037253 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m16:36:50.050781 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m16:36:50.053990 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:36:50.056078 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m16:36:50.057651 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:36:50.059747 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:36:50.061374 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m16:36:50.064602 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:36:50.112799 [debug] [Thread-4 (]: SQL status: BEGIN in 0.053 seconds
[0m16:36:50.115612 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:36:50.117850 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m16:36:50.131039 [debug] [Thread-3 (]: SQL status: BEGIN in 0.066 seconds
[0m16:36:50.133324 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:36:50.135456 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m16:36:50.161336 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.028 seconds
[0m16:36:50.181163 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:36:50.187531 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m16:36:50.195478 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:36:50.209258 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:36:50.217883 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m16:36:50.221277 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:36:50.228676 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:36:50.230224 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:36:50.231996 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:36:50.234371 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.097 seconds
[0m16:36:50.246565 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m16:36:50.270924 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:36:50.288195 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m16:36:50.293942 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m16:36:50.298236 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:36:50.301223 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m16:36:50.304360 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:36:50.320738 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:36:50.322002 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.013 seconds
[0m16:36:50.323923 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m16:36:50.330114 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m16:36:50.332764 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccec69b2-f5f2-4ceb-92f5-59c428e1f940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e40821a0c0>]}
[0m16:36:50.334411 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:36:50.341331 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.37s]
[0m16:36:50.361463 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:36:50.375755 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m16:36:50.369785 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:36:50.382230 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:36:50.393505 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m16:36:50.404827 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m16:36:50.410510 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:36:50.413100 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m16:36:50.425313 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.009 seconds
[0m16:36:50.431852 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m16:36:50.435183 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccec69b2-f5f2-4ceb-92f5-59c428e1f940', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e408b50080>]}
[0m16:36:50.439941 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.47s]
[0m16:36:50.445147 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m16:36:50.466422 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:50.468703 [debug] [MainThread]: On master: BEGIN
[0m16:36:50.470423 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:36:50.497434 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m16:36:50.499148 [debug] [MainThread]: On master: COMMIT
[0m16:36:50.500801 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:50.502116 [debug] [MainThread]: On master: COMMIT
[0m16:36:50.504689 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:36:50.506555 [debug] [MainThread]: On master: Close
[0m16:36:50.512313 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:50.515090 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m16:36:50.518820 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m16:36:50.532129 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m16:36:50.535966 [info ] [MainThread]: 
[0m16:36:50.539099 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.27 seconds (2.27s).
[0m16:36:50.556444 [debug] [MainThread]: Command end result
[0m16:36:50.761045 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:36:50.768693 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:36:50.851574 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:36:50.854922 [info ] [MainThread]: 
[0m16:36:50.857731 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:36:50.859952 [info ] [MainThread]: 
[0m16:36:50.872819 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:36:50.890117 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.54692, "process_in_blocks": "94224", "process_kernel_time": 6.346266, "process_mem_max_rss": "107284", "process_out_blocks": "3392", "process_user_time": 14.310769}
[0m16:36:50.896939 [debug] [MainThread]: Command `dbt run` succeeded at 16:36:50.893255 after 7.56 seconds
[0m16:36:50.908700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e40c8dd100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e40b4afe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70e40b4aedb0>]}
[0m16:36:50.923347 [debug] [MainThread]: Flushing usage events
[0m16:36:51.766512 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:56.855872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e1bdebb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e1bc6c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e1b57be60>]}


============================== 16:40:56.891635 | dbc2d8ac-c394-46a0-b562-de5f93782a1a ==============================
[0m16:40:56.891635 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:40:56.894726 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:40:58.145127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dbc2d8ac-c394-46a0-b562-de5f93782a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e1b24b2c0>]}
[0m16:40:58.436065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dbc2d8ac-c394-46a0-b562-de5f93782a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e1bed7620>]}
[0m16:40:58.441001 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:40:58.788206 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m16:40:59.414276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:40:59.415294 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:40:59.662890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbc2d8ac-c394-46a0-b562-de5f93782a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e199bd310>]}
[0m16:41:00.011608 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:41:00.021581 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:41:00.168299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbc2d8ac-c394-46a0-b562-de5f93782a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e19768bc0>]}
[0m16:41:00.169603 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m16:41:00.171170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbc2d8ac-c394-46a0-b562-de5f93782a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e19a587d0>]}
[0m16:41:00.179429 [info ] [MainThread]: 
[0m16:41:00.181607 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:41:00.183552 [info ] [MainThread]: 
[0m16:41:00.192510 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:41:00.226881 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:41:00.575578 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:41:00.576957 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:41:00.578297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:00.719919 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.141 seconds
[0m16:41:00.723400 [debug] [ThreadPool]: On list_db: Close
[0m16:41:00.728419 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m16:41:00.746841 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:41:00.748145 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m16:41:00.749170 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:41:00.778964 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m16:41:00.780385 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:41:00.781769 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:41:00.826907 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.044 seconds
[0m16:41:00.831128 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m16:41:00.833106 [debug] [ThreadPool]: On list_db_dev: Close
[0m16:41:00.852481 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:00.855260 [debug] [MainThread]: On master: BEGIN
[0m16:41:00.856875 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:41:00.878133 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m16:41:00.879747 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:00.881643 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:41:00.948904 [debug] [MainThread]: SQL status: SELECT 0 in 0.065 seconds
[0m16:41:00.955461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbc2d8ac-c394-46a0-b562-de5f93782a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e189ed670>]}
[0m16:41:00.957434 [debug] [MainThread]: On master: ROLLBACK
[0m16:41:00.959569 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:00.962911 [debug] [MainThread]: On master: BEGIN
[0m16:41:00.967604 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:41:00.969487 [debug] [MainThread]: On master: COMMIT
[0m16:41:00.970988 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:00.972554 [debug] [MainThread]: On master: COMMIT
[0m16:41:00.975057 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:41:00.977294 [debug] [MainThread]: On master: Close
[0m16:41:01.000294 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m16:41:01.004261 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m16:41:01.008456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m16:41:01.013433 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m16:41:01.056901 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m16:41:01.059314 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m16:41:01.179010 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m16:41:01.181600 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:41:01.182843 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m16:41:01.183897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:41:01.204707 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m16:41:01.206454 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:41:01.208132 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m16:41:01.275374 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.066 seconds
[0m16:41:01.294157 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:41:01.295542 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m16:41:01.299873 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:41:01.307374 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:41:01.308769 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m16:41:01.311500 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:41:01.381683 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:41:01.382869 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:41:01.384435 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:41:01.390516 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:41:01.422772 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m16:41:01.473527 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:41:01.476456 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m16:41:01.498285 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.020 seconds
[0m16:41:01.511061 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m16:41:01.520212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbc2d8ac-c394-46a0-b562-de5f93782a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e1bdca690>]}
[0m16:41:01.523277 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.51s]
[0m16:41:01.526619 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m16:41:01.532158 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m16:41:01.537271 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m16:41:01.534531 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m16:41:01.540323 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m16:41:01.544047 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m16:41:01.546160 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m16:41:01.551128 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m16:41:01.566291 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m16:41:01.603469 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m16:41:01.612510 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m16:41:01.615966 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m16:41:01.628572 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m16:41:01.629532 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m16:41:01.642851 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m16:41:01.645363 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:41:01.646779 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:41:01.648237 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m16:41:01.649661 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m16:41:01.650988 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:41:01.652619 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:41:01.677636 [debug] [Thread-3 (]: SQL status: BEGIN in 0.026 seconds
[0m16:41:01.679415 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:41:01.681043 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m16:41:01.684494 [debug] [Thread-4 (]: SQL status: BEGIN in 0.031 seconds
[0m16:41:01.686286 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:41:01.688285 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m16:41:01.710214 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.020 seconds
[0m16:41:01.725856 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.043 seconds
[0m16:41:01.728884 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:41:01.737098 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m16:41:01.741851 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:41:01.743795 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m16:41:01.745226 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:41:01.754233 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m16:41:01.762862 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:41:01.775271 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:41:01.779622 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m16:41:01.781835 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m16:41:01.785835 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:41:01.787367 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:41:01.795076 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:41:01.800763 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:41:01.802404 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:41:01.804090 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:41:01.805719 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:41:01.807353 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:41:01.814517 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m16:41:01.821643 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m16:41:01.823049 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m16:41:01.826280 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:41:01.837761 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m16:41:01.839544 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m16:41:01.843965 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:41:01.846668 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m16:41:01.860467 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m16:41:01.866380 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m16:41:01.868150 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.022 seconds
[0m16:41:01.877995 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbc2d8ac-c394-46a0-b562-de5f93782a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e11750b60>]}
[0m16:41:01.880407 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m16:41:01.882968 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.33s]
[0m16:41:01.888756 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m16:41:01.892636 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbc2d8ac-c394-46a0-b562-de5f93782a1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e18ac7890>]}
[0m16:41:01.898245 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.35s]
[0m16:41:01.909488 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m16:41:01.933260 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:01.935664 [debug] [MainThread]: On master: BEGIN
[0m16:41:01.938538 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:41:01.970028 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m16:41:01.971796 [debug] [MainThread]: On master: COMMIT
[0m16:41:01.973597 [debug] [MainThread]: Using postgres connection "master"
[0m16:41:01.976066 [debug] [MainThread]: On master: COMMIT
[0m16:41:01.979212 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:41:01.982514 [debug] [MainThread]: On master: Close
[0m16:41:01.991219 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:01.993991 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m16:41:01.995935 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m16:41:01.998124 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m16:41:02.001256 [info ] [MainThread]: 
[0m16:41:02.011990 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.81 seconds (1.81s).
[0m16:41:02.018139 [debug] [MainThread]: Command end result
[0m16:41:02.165156 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:41:02.170928 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:41:02.198310 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:41:02.199541 [info ] [MainThread]: 
[0m16:41:02.202092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:41:02.204793 [info ] [MainThread]: 
[0m16:41:02.206830 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:41:02.213945 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.6679564, "process_in_blocks": "119064", "process_kernel_time": 5.299014, "process_mem_max_rss": "107504", "process_out_blocks": "3392", "process_user_time": 10.057976}
[0m16:41:02.221480 [debug] [MainThread]: Command `dbt run` succeeded at 16:41:02.220829 after 5.68 seconds
[0m16:41:02.223352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e1bc6c860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e1b272750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x787e1b2c3e60>]}
[0m16:41:02.225032 [debug] [MainThread]: Flushing usage events
[0m16:41:02.936434 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:43:19.997859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c790ed36b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c7917e46b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c7917e4d70>]}


============================== 16:43:20.098194 | 8e8d777b-f5b6-4823-b468-390cfdd442aa ==============================
[0m16:43:20.098194 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:43:20.110703 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:43:21.333384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e8d777b-f5b6-4823-b468-390cfdd442aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c78f32d220>]}
[0m16:43:21.647181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e8d777b-f5b6-4823-b468-390cfdd442aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c790e0be00>]}
[0m16:43:21.650661 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:43:22.013673 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m16:43:22.630281 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:43:22.631639 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:43:22.789517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e8d777b-f5b6-4823-b468-390cfdd442aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c78f3e0830>]}
[0m16:43:23.166155 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:43:23.177374 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:43:23.314469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e8d777b-f5b6-4823-b468-390cfdd442aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c78f0a4bc0>]}
[0m16:43:23.316837 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m16:43:23.318933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e8d777b-f5b6-4823-b468-390cfdd442aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c78f382b70>]}
[0m16:43:23.330658 [info ] [MainThread]: 
[0m16:43:23.335077 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:43:23.338493 [info ] [MainThread]: 
[0m16:43:23.341976 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:43:23.368685 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:43:23.617077 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:43:23.618474 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:43:23.620743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:23.739826 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.119 seconds
[0m16:43:23.745571 [debug] [ThreadPool]: On list_db: Close
[0m16:43:23.751835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m16:43:23.775621 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:43:23.776933 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m16:43:23.777988 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:43:23.802684 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m16:43:23.804415 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:43:23.805926 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:43:23.852053 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.044 seconds
[0m16:43:23.857538 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m16:43:23.860859 [debug] [ThreadPool]: On list_db_dev: Close
[0m16:43:23.893694 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:23.896839 [debug] [MainThread]: On master: BEGIN
[0m16:43:23.898122 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:43:23.936115 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m16:43:23.940021 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:23.942070 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:43:23.992612 [debug] [MainThread]: SQL status: SELECT 0 in 0.048 seconds
[0m16:43:23.999594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e8d777b-f5b6-4823-b468-390cfdd442aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c78f0a2510>]}
[0m16:43:24.004945 [debug] [MainThread]: On master: ROLLBACK
[0m16:43:24.008827 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:24.011385 [debug] [MainThread]: On master: BEGIN
[0m16:43:24.014165 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:43:24.016305 [debug] [MainThread]: On master: COMMIT
[0m16:43:24.018462 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:24.020184 [debug] [MainThread]: On master: COMMIT
[0m16:43:24.022352 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:43:24.023987 [debug] [MainThread]: On master: Close
[0m16:43:24.047906 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m16:43:24.050348 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m16:43:24.053083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m16:43:24.063916 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m16:43:24.111326 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m16:43:24.119499 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m16:43:24.402272 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m16:43:24.405704 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:43:24.407586 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m16:43:24.409091 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:24.438539 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m16:43:24.440276 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:43:24.442977 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m16:43:24.512528 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.068 seconds
[0m16:43:24.560695 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:43:24.562339 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m16:43:24.567769 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:43:24.592553 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:43:24.595317 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m16:43:24.598821 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:43:24.805136 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:43:24.807734 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:43:24.809988 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:43:24.841041 [debug] [Thread-1 (]: SQL status: COMMIT in 0.017 seconds
[0m16:43:24.908314 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m16:43:24.960736 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:43:24.963001 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m16:43:25.006540 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.041 seconds
[0m16:43:25.028806 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m16:43:25.048960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e8d777b-f5b6-4823-b468-390cfdd442aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c79173a5a0>]}
[0m16:43:25.056280 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.99s]
[0m16:43:25.064001 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m16:43:25.069935 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m16:43:25.073283 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m16:43:25.080195 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m16:43:25.084845 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m16:43:25.088200 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m16:43:25.091082 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m16:43:25.093019 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m16:43:25.101136 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m16:43:25.163504 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m16:43:25.190149 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m16:43:25.195323 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m16:43:25.205624 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m16:43:25.247748 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m16:43:25.269201 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:43:25.271971 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m16:43:25.278246 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:43:25.299123 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m16:43:25.312050 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:43:25.315067 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m16:43:25.317526 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:43:25.381045 [debug] [Thread-4 (]: SQL status: BEGIN in 0.058 seconds
[0m16:43:25.385131 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:43:25.387594 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m16:43:25.462479 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.072 seconds
[0m16:43:25.479728 [debug] [Thread-3 (]: SQL status: BEGIN in 0.205 seconds
[0m16:43:25.497405 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:43:25.499515 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m16:43:25.502466 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:43:25.505309 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m16:43:25.508878 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:43:25.532783 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:43:25.535054 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m16:43:25.548920 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m16:43:25.568201 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:43:25.570273 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:43:25.572873 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:43:25.584667 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.080 seconds
[0m16:43:25.606856 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:43:25.616667 [debug] [Thread-4 (]: SQL status: COMMIT in 0.040 seconds
[0m16:43:25.609516 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m16:43:25.644890 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m16:43:25.647727 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m16:43:25.662447 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:43:25.667307 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:43:25.671146 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m16:43:25.673539 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m16:43:25.677239 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:43:25.689642 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:43:25.692323 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:43:25.694047 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:43:25.704880 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.028 seconds
[0m16:43:25.733705 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m16:43:25.741749 [debug] [Thread-3 (]: SQL status: COMMIT in 0.045 seconds
[0m16:43:25.746612 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e8d777b-f5b6-4823-b468-390cfdd442aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c78c15b8f0>]}
[0m16:43:25.760003 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m16:43:25.764095 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.66s]
[0m16:43:25.768451 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:43:25.774636 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m16:43:25.779421 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m16:43:25.810516 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.026 seconds
[0m16:43:25.816918 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m16:43:25.826648 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e8d777b-f5b6-4823-b468-390cfdd442aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c78e2ea990>]}
[0m16:43:25.830186 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.74s]
[0m16:43:25.834280 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m16:43:25.850078 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:25.851663 [debug] [MainThread]: On master: BEGIN
[0m16:43:25.855171 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:43:25.884818 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m16:43:25.886530 [debug] [MainThread]: On master: COMMIT
[0m16:43:25.888332 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:25.889940 [debug] [MainThread]: On master: COMMIT
[0m16:43:25.892486 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:43:25.893869 [debug] [MainThread]: On master: Close
[0m16:43:25.896130 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:25.897257 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m16:43:25.898453 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m16:43:25.899929 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m16:43:25.901413 [info ] [MainThread]: 
[0m16:43:25.905622 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.56 seconds (2.56s).
[0m16:43:25.910411 [debug] [MainThread]: Command end result
[0m16:43:26.012195 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:43:26.019290 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:43:26.050445 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:43:26.051822 [info ] [MainThread]: 
[0m16:43:26.053483 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:43:26.054976 [info ] [MainThread]: 
[0m16:43:26.056357 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:43:26.060213 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.618262, "process_in_blocks": "92568", "process_kernel_time": 3.493668, "process_mem_max_rss": "107396", "process_out_blocks": "3400", "process_user_time": 11.680015}
[0m16:43:26.061940 [debug] [MainThread]: Command `dbt run` succeeded at 16:43:26.061515 after 6.62 seconds
[0m16:43:26.064010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c791901100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c790c48110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c791758320>]}
[0m16:43:26.065521 [debug] [MainThread]: Flushing usage events
[0m16:43:26.768527 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:46:18.754316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717bb2d11370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717bb172a360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717bb19c9fd0>]}


============================== 16:46:18.805579 | 94109268-3023-4d54-8c89-521a818c0d97 ==============================
[0m16:46:18.805579 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:46:18.812094 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:46:19.769101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94109268-3023-4d54-8c89-521a818c0d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717bb131b440>]}
[0m16:46:20.199233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94109268-3023-4d54-8c89-521a818c0d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717bb2093650>]}
[0m16:46:20.202964 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:46:20.862782 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m16:46:21.454083 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:46:21.455139 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:46:21.686421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94109268-3023-4d54-8c89-521a818c0d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717bb1367b30>]}
[0m16:46:22.118145 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:46:22.124999 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:46:22.253835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94109268-3023-4d54-8c89-521a818c0d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717baf81fb00>]}
[0m16:46:22.256965 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m16:46:22.259593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94109268-3023-4d54-8c89-521a818c0d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717bafb675c0>]}
[0m16:46:22.275466 [info ] [MainThread]: 
[0m16:46:22.285276 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:46:22.288797 [info ] [MainThread]: 
[0m16:46:22.293013 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:46:22.315813 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:46:22.544108 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:46:22.545781 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:46:22.547446 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:22.605826 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.058 seconds
[0m16:46:22.609952 [debug] [ThreadPool]: On list_db: Close
[0m16:46:22.615285 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m16:46:22.646079 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:46:22.648088 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m16:46:22.650920 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:22.685919 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m16:46:22.687727 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:46:22.690108 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:46:22.709667 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.017 seconds
[0m16:46:22.715297 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m16:46:22.717822 [debug] [ThreadPool]: On list_db_dev: Close
[0m16:46:22.737521 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:22.738604 [debug] [MainThread]: On master: BEGIN
[0m16:46:22.739461 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:46:22.759619 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m16:46:22.761261 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:22.763189 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:46:22.850210 [debug] [MainThread]: SQL status: SELECT 0 in 0.085 seconds
[0m16:46:22.864775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94109268-3023-4d54-8c89-521a818c0d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717baf6dbbc0>]}
[0m16:46:22.866882 [debug] [MainThread]: On master: ROLLBACK
[0m16:46:22.869708 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:22.871253 [debug] [MainThread]: On master: BEGIN
[0m16:46:22.874723 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:46:22.876803 [debug] [MainThread]: On master: COMMIT
[0m16:46:22.882570 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:22.889296 [debug] [MainThread]: On master: COMMIT
[0m16:46:22.891782 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:46:22.893981 [debug] [MainThread]: On master: Close
[0m16:46:22.914335 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m16:46:22.917547 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m16:46:22.920455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m16:46:22.921994 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m16:46:22.949102 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m16:46:22.951171 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m16:46:23.157840 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m16:46:23.169993 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:46:23.171828 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m16:46:23.174319 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:23.207033 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m16:46:23.211325 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:46:23.213014 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m16:46:23.250144 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.035 seconds
[0m16:46:23.282802 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:46:23.287981 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m16:46:23.292969 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:46:23.302092 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:46:23.303505 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m16:46:23.306923 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:46:23.424643 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:46:23.428239 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:46:23.431109 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:46:23.442700 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m16:46:23.490678 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m16:46:23.521125 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:46:23.534198 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m16:46:23.547712 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m16:46:23.570473 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m16:46:23.603873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94109268-3023-4d54-8c89-521a818c0d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717bb1eea690>]}
[0m16:46:23.614637 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.67s]
[0m16:46:23.618204 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m16:46:23.636623 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m16:46:23.623398 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m16:46:23.639528 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m16:46:23.645368 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m16:46:23.642440 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m16:46:23.659033 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m16:46:23.672659 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m16:46:23.674684 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m16:46:23.700718 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m16:46:23.705895 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m16:46:23.709920 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m16:46:23.717447 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m16:46:23.730563 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m16:46:23.742159 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m16:46:23.745125 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:46:23.746849 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m16:46:23.748491 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:46:23.751122 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:46:23.753600 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m16:46:23.755348 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:46:23.778743 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m16:46:23.780817 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:46:23.783606 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m16:46:23.803954 [debug] [Thread-4 (]: SQL status: BEGIN in 0.049 seconds
[0m16:46:23.805988 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:46:23.807973 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m16:46:23.827387 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.031 seconds
[0m16:46:23.836872 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.026 seconds
[0m16:46:23.849756 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:46:23.859158 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:46:23.861253 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m16:46:23.863496 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m16:46:23.867592 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:46:23.885581 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m16:46:23.889844 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:46:23.898584 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m16:46:23.901991 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:46:23.914302 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:46:23.917988 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:46:23.919513 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m16:46:23.921899 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:46:23.924024 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:46:23.926225 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:46:23.933908 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:46:23.935812 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m16:46:23.938153 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:46:23.949828 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m16:46:23.953492 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:46:23.956206 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:46:23.959040 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m16:46:23.969782 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m16:46:23.988009 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.027 seconds
[0m16:46:23.991465 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m16:46:23.998255 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m16:46:24.001680 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:46:24.012913 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94109268-3023-4d54-8c89-521a818c0d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717bac10ff50>]}
[0m16:46:24.014927 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m16:46:24.017948 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.35s]
[0m16:46:24.029060 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m16:46:24.039386 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.016 seconds
[0m16:46:24.045858 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m16:46:24.048500 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94109268-3023-4d54-8c89-521a818c0d97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717bae9f1f70>]}
[0m16:46:24.053789 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.40s]
[0m16:46:24.057795 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m16:46:24.067111 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:24.069000 [debug] [MainThread]: On master: BEGIN
[0m16:46:24.075064 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:46:24.104458 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m16:46:24.106365 [debug] [MainThread]: On master: COMMIT
[0m16:46:24.108132 [debug] [MainThread]: Using postgres connection "master"
[0m16:46:24.109791 [debug] [MainThread]: On master: COMMIT
[0m16:46:24.112493 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:46:24.114417 [debug] [MainThread]: On master: Close
[0m16:46:24.116824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:46:24.118769 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m16:46:24.120907 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m16:46:24.122443 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m16:46:24.124986 [info ] [MainThread]: 
[0m16:46:24.126901 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.83 seconds (1.83s).
[0m16:46:24.132905 [debug] [MainThread]: Command end result
[0m16:46:24.257620 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:46:24.265261 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:46:24.306656 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:46:24.308033 [info ] [MainThread]: 
[0m16:46:24.310217 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:46:24.313336 [info ] [MainThread]: 
[0m16:46:24.316336 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:46:24.324265 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.9274383, "process_in_blocks": "0", "process_kernel_time": 2.572019, "process_mem_max_rss": "107724", "process_out_blocks": "3400", "process_user_time": 12.34488}
[0m16:46:24.327335 [debug] [MainThread]: Command `dbt run` succeeded at 16:46:24.326490 after 5.93 seconds
[0m16:46:24.329859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717bb1eea690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717baecdd490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x717bb16012b0>]}
[0m16:46:24.331855 [debug] [MainThread]: Flushing usage events
[0m16:46:25.079166 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:49:07.731650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e3512da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e34c2c5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e3356cb60>]}


============================== 16:49:07.750963 | d793c9ff-5757-48db-a372-e321edde3f3e ==============================
[0m16:49:07.750963 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:49:07.752835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:49:08.527298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd793c9ff-5757-48db-a372-e321edde3f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e33364890>]}
[0m16:49:08.789604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd793c9ff-5757-48db-a372-e321edde3f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e334e9340>]}
[0m16:49:08.793388 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:49:09.162366 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m16:49:09.669631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:49:09.670924 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:49:09.841093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd793c9ff-5757-48db-a372-e321edde3f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e332ed910>]}
[0m16:49:10.167482 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:49:10.178087 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:49:10.318940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd793c9ff-5757-48db-a372-e321edde3f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e31744a10>]}
[0m16:49:10.322897 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m16:49:10.325632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd793c9ff-5757-48db-a372-e321edde3f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e319daff0>]}
[0m16:49:10.332611 [info ] [MainThread]: 
[0m16:49:10.337030 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:49:10.342200 [info ] [MainThread]: 
[0m16:49:10.345613 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:49:10.379888 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:49:10.604133 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:49:10.605733 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:49:10.607111 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:10.653680 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.046 seconds
[0m16:49:10.658215 [debug] [ThreadPool]: On list_db: Close
[0m16:49:10.664573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m16:49:10.685231 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:49:10.686672 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m16:49:10.687777 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:49:10.709187 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m16:49:10.710930 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:49:10.712528 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:49:10.730230 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.016 seconds
[0m16:49:10.734665 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m16:49:10.737027 [debug] [ThreadPool]: On list_db_dev: Close
[0m16:49:10.794441 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:10.796266 [debug] [MainThread]: On master: BEGIN
[0m16:49:10.798374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:49:10.838778 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m16:49:10.840183 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:10.842174 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:49:10.894216 [debug] [MainThread]: SQL status: SELECT 0 in 0.050 seconds
[0m16:49:10.899548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd793c9ff-5757-48db-a372-e321edde3f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e3322f320>]}
[0m16:49:10.901485 [debug] [MainThread]: On master: ROLLBACK
[0m16:49:10.903715 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:10.905219 [debug] [MainThread]: On master: BEGIN
[0m16:49:10.911216 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:49:10.913101 [debug] [MainThread]: On master: COMMIT
[0m16:49:10.915355 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:10.917301 [debug] [MainThread]: On master: COMMIT
[0m16:49:10.919886 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:49:10.923397 [debug] [MainThread]: On master: Close
[0m16:49:10.939623 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m16:49:10.944306 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m16:49:10.948320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m16:49:10.950303 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m16:49:11.003550 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m16:49:11.006403 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m16:49:11.138956 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m16:49:11.141977 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:49:11.143619 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m16:49:11.145068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:11.165077 [debug] [Thread-1 (]: SQL status: BEGIN in 0.020 seconds
[0m16:49:11.166824 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:49:11.168657 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m16:49:11.193361 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.022 seconds
[0m16:49:11.217346 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:49:11.218723 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m16:49:11.221069 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:49:11.232023 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:49:11.234445 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m16:49:11.237472 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:49:11.315645 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:49:11.317070 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:49:11.318558 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:49:11.325119 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:49:11.346624 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m16:49:11.364101 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:49:11.365913 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m16:49:11.375877 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.008 seconds
[0m16:49:11.384691 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m16:49:11.390703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd793c9ff-5757-48db-a372-e321edde3f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e33db2870>]}
[0m16:49:11.394254 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.44s]
[0m16:49:11.397650 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m16:49:11.401925 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m16:49:11.406261 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m16:49:11.411299 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m16:49:11.408533 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m16:49:11.413527 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m16:49:11.416600 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m16:49:11.419716 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m16:49:11.426328 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m16:49:11.456397 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m16:49:11.463835 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m16:49:11.469233 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m16:49:11.483021 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m16:49:11.486082 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m16:49:11.498635 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m16:49:11.502122 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:49:11.504943 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:49:11.506828 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m16:49:11.508641 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m16:49:11.510627 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:49:11.512886 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:49:11.536677 [debug] [Thread-4 (]: SQL status: BEGIN in 0.026 seconds
[0m16:49:11.538954 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:49:11.540949 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m16:49:11.542944 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m16:49:11.545844 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:49:11.547650 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m16:49:11.578194 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.030 seconds
[0m16:49:11.593527 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.043 seconds
[0m16:49:11.592393 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:49:11.607615 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:49:11.609401 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m16:49:11.611384 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m16:49:11.614958 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:49:11.616767 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:49:11.634865 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:49:11.638683 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:49:11.640087 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m16:49:11.642377 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m16:49:11.645319 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:49:11.646881 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:49:11.653829 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:49:11.662890 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:49:11.665024 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:49:11.667173 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:49:11.669294 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:49:11.671175 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:49:11.678629 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m16:49:11.688573 [debug] [Thread-3 (]: SQL status: COMMIT in 0.015 seconds
[0m16:49:11.690764 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m16:49:11.698747 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m16:49:11.702104 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:49:11.704658 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:49:11.706765 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m16:49:11.708580 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m16:49:11.718398 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m16:49:11.724201 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m16:49:11.726046 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.015 seconds
[0m16:49:11.728304 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd793c9ff-5757-48db-a372-e321edde3f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e30a5b6b0>]}
[0m16:49:11.734028 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m16:49:11.737282 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.31s]
[0m16:49:11.740799 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd793c9ff-5757-48db-a372-e321edde3f3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e29747e90>]}
[0m16:49:11.744124 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m16:49:11.749933 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.33s]
[0m16:49:11.758292 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m16:49:11.767384 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:11.776243 [debug] [MainThread]: On master: BEGIN
[0m16:49:11.778628 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:49:11.847725 [debug] [MainThread]: SQL status: BEGIN in 0.069 seconds
[0m16:49:11.850353 [debug] [MainThread]: On master: COMMIT
[0m16:49:11.866604 [debug] [MainThread]: Using postgres connection "master"
[0m16:49:11.868286 [debug] [MainThread]: On master: COMMIT
[0m16:49:11.876010 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:49:11.878864 [debug] [MainThread]: On master: Close
[0m16:49:11.882598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:11.884163 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m16:49:11.896925 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m16:49:11.899409 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m16:49:11.904887 [info ] [MainThread]: 
[0m16:49:11.912967 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.56 seconds (1.56s).
[0m16:49:11.919774 [debug] [MainThread]: Command end result
[0m16:49:12.088195 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:49:12.096514 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:49:12.129934 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:49:12.131661 [info ] [MainThread]: 
[0m16:49:12.133360 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:49:12.136545 [info ] [MainThread]: 
[0m16:49:12.139523 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:49:12.143905 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.588489, "process_in_blocks": "0", "process_kernel_time": 1.694222, "process_mem_max_rss": "107788", "process_out_blocks": "3392", "process_user_time": 8.932805}
[0m16:49:12.146543 [debug] [MainThread]: Command `dbt run` succeeded at 16:49:12.145988 after 4.59 seconds
[0m16:49:12.148306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e345bd250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e341c3740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x777e33a09370>]}
[0m16:49:12.150736 [debug] [MainThread]: Flushing usage events
[0m16:49:12.784790 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:54:08.580110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48e8c0a6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48ea094140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48e85910a0>]}


============================== 16:54:08.613054 | 2d82bd82-e842-4aef-82db-c1d2c136dfc9 ==============================
[0m16:54:08.613054 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:54:08.616820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:54:09.509499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2d82bd82-e842-4aef-82db-c1d2c136dfc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48e8acaf00>]}
[0m16:54:09.757055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2d82bd82-e842-4aef-82db-c1d2c136dfc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48e881f800>]}
[0m16:54:09.760032 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:54:10.247237 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m16:54:10.881631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:54:10.883295 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:54:11.044598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d82bd82-e842-4aef-82db-c1d2c136dfc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48e8c90860>]}
[0m16:54:11.568604 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:54:11.608060 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:54:11.782147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d82bd82-e842-4aef-82db-c1d2c136dfc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48e6548050>]}
[0m16:54:11.784604 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m16:54:11.787116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d82bd82-e842-4aef-82db-c1d2c136dfc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48e6852b70>]}
[0m16:54:11.814236 [info ] [MainThread]: 
[0m16:54:11.826794 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:54:11.831111 [info ] [MainThread]: 
[0m16:54:11.836750 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:54:11.891858 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:54:12.277543 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:54:12.282819 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:54:12.284451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:12.505128 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.218 seconds
[0m16:54:12.510432 [debug] [ThreadPool]: On list_db: Close
[0m16:54:12.521060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m16:54:12.546890 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:54:12.548442 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m16:54:12.550436 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:12.573595 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m16:54:12.575483 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:54:12.577047 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:54:12.607602 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.029 seconds
[0m16:54:12.622354 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m16:54:12.626656 [debug] [ThreadPool]: On list_db_dev: Close
[0m16:54:12.681780 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:12.684194 [debug] [MainThread]: On master: BEGIN
[0m16:54:12.685860 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:54:12.710961 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m16:54:12.712840 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:12.714504 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:54:12.779917 [debug] [MainThread]: SQL status: SELECT 0 in 0.063 seconds
[0m16:54:12.785751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d82bd82-e842-4aef-82db-c1d2c136dfc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48e682f3e0>]}
[0m16:54:12.795033 [debug] [MainThread]: On master: ROLLBACK
[0m16:54:12.797545 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:12.800164 [debug] [MainThread]: On master: BEGIN
[0m16:54:12.803745 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:54:12.805541 [debug] [MainThread]: On master: COMMIT
[0m16:54:12.807097 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:12.808988 [debug] [MainThread]: On master: COMMIT
[0m16:54:12.811365 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:54:12.813325 [debug] [MainThread]: On master: Close
[0m16:54:12.838354 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m16:54:12.843347 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m16:54:12.851338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m16:54:12.853506 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m16:54:12.909671 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m16:54:12.919701 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m16:54:13.162621 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m16:54:13.172094 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:54:13.175048 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m16:54:13.178693 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:13.227705 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m16:54:13.229401 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:54:13.231589 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m16:54:13.292841 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.058 seconds
[0m16:54:13.332527 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:54:13.335257 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m16:54:13.340457 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:54:13.352252 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:54:13.354696 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m16:54:13.359394 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:54:13.491230 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:54:13.494447 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:54:13.496618 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:54:13.507721 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m16:54:13.539088 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m16:54:13.559875 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:54:13.561232 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m16:54:13.574353 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m16:54:13.585513 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m16:54:13.604712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d82bd82-e842-4aef-82db-c1d2c136dfc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48e9e12300>]}
[0m16:54:13.607342 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.74s]
[0m16:54:13.611223 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m16:54:13.618514 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m16:54:13.620619 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m16:54:13.624798 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m16:54:13.633106 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m16:54:13.640918 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m16:54:13.648695 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m16:54:13.651287 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m16:54:13.653588 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m16:54:13.711756 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m16:54:13.714932 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m16:54:13.720801 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m16:54:13.722624 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m16:54:13.739182 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m16:54:13.753171 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m16:54:13.758148 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:54:13.760217 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:54:13.761990 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m16:54:13.763919 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m16:54:13.766061 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:54:13.768053 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:54:13.866564 [debug] [Thread-4 (]: SQL status: BEGIN in 0.098 seconds
[0m16:54:13.868158 [debug] [Thread-3 (]: SQL status: BEGIN in 0.102 seconds
[0m16:54:13.870318 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:54:13.872258 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:54:13.877063 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m16:54:13.880100 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m16:54:13.918386 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.036 seconds
[0m16:54:13.931389 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:54:13.932963 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.050 seconds
[0m16:54:13.934981 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m16:54:13.947422 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:54:13.950520 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m16:54:13.952776 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:54:13.962982 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m16:54:13.968934 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:54:13.983323 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:54:13.985102 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m16:54:13.987196 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m16:54:13.990555 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:54:13.991787 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:54:13.999709 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:54:14.005521 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:54:14.008895 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:54:14.010602 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:54:14.012808 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:54:14.014399 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:54:14.022894 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m16:54:14.024393 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m16:54:14.032549 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m16:54:14.040160 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m16:54:14.042298 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:54:14.044212 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:54:14.045710 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m16:54:14.047126 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m16:54:14.056679 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.008 seconds
[0m16:54:14.060335 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m16:54:14.061514 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.013 seconds
[0m16:54:14.067462 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m16:54:14.069202 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d82bd82-e842-4aef-82db-c1d2c136dfc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48e4601310>]}
[0m16:54:14.075618 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d82bd82-e842-4aef-82db-c1d2c136dfc9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48e4601310>]}
[0m16:54:14.072155 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.43s]
[0m16:54:14.078873 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.43s]
[0m16:54:14.082270 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m16:54:14.085421 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m16:54:14.104596 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:14.113021 [debug] [MainThread]: On master: BEGIN
[0m16:54:14.116688 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:54:14.140174 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m16:54:14.141760 [debug] [MainThread]: On master: COMMIT
[0m16:54:14.143184 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:14.144374 [debug] [MainThread]: On master: COMMIT
[0m16:54:14.146153 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:54:14.147388 [debug] [MainThread]: On master: Close
[0m16:54:14.149220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:14.152204 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m16:54:14.154592 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m16:54:14.156893 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m16:54:14.165722 [info ] [MainThread]: 
[0m16:54:14.168306 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m16:54:14.179369 [debug] [MainThread]: Command end result
[0m16:54:14.279656 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:54:14.290826 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:54:14.309755 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:54:14.310843 [info ] [MainThread]: 
[0m16:54:14.312278 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:54:14.314193 [info ] [MainThread]: 
[0m16:54:14.317353 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:54:14.364323 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.3682566, "process_in_blocks": "197920", "process_kernel_time": 3.759345, "process_mem_max_rss": "93484", "process_out_blocks": "1816", "process_user_time": 9.563742}
[0m16:54:14.379367 [debug] [MainThread]: Command `dbt run` succeeded at 16:54:14.378340 after 6.39 seconds
[0m16:54:14.383477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48e84683e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48e8692510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a48e653d2b0>]}
[0m16:54:14.386867 [debug] [MainThread]: Flushing usage events
[0m16:54:15.373257 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:58:16.495777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef3da5b5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef3da33fb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef3da3ebce0>]}


============================== 16:58:16.528406 | b70f4718-ae5e-46a7-a0d0-00259d8f011e ==============================
[0m16:58:16.528406 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:58:16.538205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:58:18.048553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b70f4718-ae5e-46a7-a0d0-00259d8f011e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef3dd876870>]}
[0m16:58:18.620212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b70f4718-ae5e-46a7-a0d0-00259d8f011e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef3da16f920>]}
[0m16:58:18.630945 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:58:19.876400 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m16:58:20.914127 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:58:20.930017 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:58:21.139644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b70f4718-ae5e-46a7-a0d0-00259d8f011e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef3d88307d0>]}
[0m16:58:21.548980 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:58:21.625693 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:58:21.754923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b70f4718-ae5e-46a7-a0d0-00259d8f011e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef3d85379b0>]}
[0m16:58:21.756435 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m16:58:21.757955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b70f4718-ae5e-46a7-a0d0-00259d8f011e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef3d884ed80>]}
[0m16:58:21.769087 [info ] [MainThread]: 
[0m16:58:21.771595 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:58:21.773434 [info ] [MainThread]: 
[0m16:58:21.776849 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:58:21.819861 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:58:22.097441 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:58:22.100581 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:58:22.102154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:58:22.396412 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.290 seconds
[0m16:58:22.403096 [debug] [ThreadPool]: On list_db: Close
[0m16:58:22.416265 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m16:58:22.473920 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:58:22.476308 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m16:58:22.478321 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:58:22.529313 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m16:58:22.531227 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:58:22.534368 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:58:22.600513 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.052 seconds
[0m16:58:22.607603 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m16:58:22.612308 [debug] [ThreadPool]: On list_db_dev: Close
[0m16:58:22.665960 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:22.668512 [debug] [MainThread]: On master: BEGIN
[0m16:58:22.677962 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:58:22.826058 [debug] [MainThread]: SQL status: BEGIN in 0.148 seconds
[0m16:58:22.827772 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:22.829582 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:58:22.963328 [debug] [MainThread]: SQL status: SELECT 0 in 0.120 seconds
[0m16:58:22.980574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b70f4718-ae5e-46a7-a0d0-00259d8f011e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef3dbecc470>]}
[0m16:58:22.992326 [debug] [MainThread]: On master: ROLLBACK
[0m16:58:22.994688 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:23.000710 [debug] [MainThread]: On master: BEGIN
[0m16:58:23.005574 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:58:23.007856 [debug] [MainThread]: On master: COMMIT
[0m16:58:23.009894 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:23.011591 [debug] [MainThread]: On master: COMMIT
[0m16:58:23.016583 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:58:23.023730 [debug] [MainThread]: On master: Close
[0m16:58:23.161557 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m16:58:23.164028 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m16:58:23.166315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m16:58:23.178413 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m16:58:23.271637 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m16:58:23.294714 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m16:58:23.663342 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m16:58:23.677963 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:58:23.680055 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m16:58:23.682890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:58:24.492323 [debug] [Thread-1 (]: SQL status: BEGIN in 0.798 seconds
[0m16:58:24.501164 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:58:24.502952 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m16:58:24.582103 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.075 seconds
[0m16:58:24.623529 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:58:24.625299 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m16:58:24.628912 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:58:24.643948 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:58:24.645456 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m16:58:24.648465 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:58:24.767926 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:58:24.769854 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:58:24.772235 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:58:24.778487 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:58:24.820900 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m16:58:24.859318 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:58:24.861455 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m16:58:24.878674 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.015 seconds
[0m16:58:24.890401 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m16:58:24.919488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b70f4718-ae5e-46a7-a0d0-00259d8f011e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef3dbe22600>]}
[0m16:58:24.924122 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 1.73s]
[0m16:58:24.928114 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m16:58:24.937946 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m16:58:24.940685 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m16:58:24.946077 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m16:58:24.951867 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m16:58:24.955045 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m16:58:24.963880 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m16:58:24.959911 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m16:58:24.965879 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m16:58:24.999934 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m16:58:25.007022 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m16:58:25.024160 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m16:58:25.037933 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m16:58:25.108374 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m16:58:25.113977 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m16:58:25.120936 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:58:25.124140 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m16:58:25.134993 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:58:25.143774 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:58:25.155236 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m16:58:25.157440 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:58:26.189484 [debug] [Thread-3 (]: SQL status: BEGIN in 1.022 seconds
[0m16:58:26.190981 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:58:26.185037 [debug] [Thread-4 (]: SQL status: BEGIN in 1.054 seconds
[0m16:58:26.193221 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m16:58:26.195691 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:58:26.198208 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m16:58:26.224094 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.024 seconds
[0m16:58:26.240953 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.043 seconds
[0m16:58:26.254747 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:58:26.262423 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m16:58:26.265012 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:58:26.268173 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m16:58:26.271099 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:58:26.280198 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m16:58:26.292175 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:58:26.310265 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m16:58:26.314088 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:58:26.316874 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:58:26.328091 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m16:58:26.337523 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:58:26.342029 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:58:26.346441 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m16:58:26.350819 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:58:26.358638 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:58:26.361211 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:58:26.366157 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:58:26.369177 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m16:58:26.386271 [debug] [Thread-3 (]: SQL status: COMMIT in 0.012 seconds
[0m16:58:26.385659 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m16:58:26.399156 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m16:58:26.405841 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:58:26.407903 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m16:58:26.402812 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:58:26.411962 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m16:58:26.424085 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m16:58:26.425551 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.016 seconds
[0m16:58:26.431813 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m16:58:26.438437 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m16:58:26.455390 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b70f4718-ae5e-46a7-a0d0-00259d8f011e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef3d45f3b60>]}
[0m16:58:26.456758 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b70f4718-ae5e-46a7-a0d0-00259d8f011e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef3d45f3e30>]}
[0m16:58:26.462549 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 1.50s]
[0m16:58:26.464971 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 1.48s]
[0m16:58:26.469238 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m16:58:26.472300 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m16:58:26.502156 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:26.506073 [debug] [MainThread]: On master: BEGIN
[0m16:58:26.508191 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:58:26.745851 [debug] [MainThread]: SQL status: BEGIN in 0.237 seconds
[0m16:58:26.747841 [debug] [MainThread]: On master: COMMIT
[0m16:58:26.749978 [debug] [MainThread]: Using postgres connection "master"
[0m16:58:26.752364 [debug] [MainThread]: On master: COMMIT
[0m16:58:26.759268 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:58:26.762818 [debug] [MainThread]: On master: Close
[0m16:58:26.765246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:58:26.771430 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m16:58:26.773413 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m16:58:26.776159 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m16:58:26.786915 [info ] [MainThread]: 
[0m16:58:26.792546 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 5.00 seconds (5.00s).
[0m16:58:26.802148 [debug] [MainThread]: Command end result
[0m16:58:26.941848 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:58:26.960960 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:58:27.004834 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:58:27.006719 [info ] [MainThread]: 
[0m16:58:27.009044 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:58:27.010849 [info ] [MainThread]: 
[0m16:58:27.018172 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:58:27.097916 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.328733, "process_in_blocks": "289072", "process_kernel_time": 3.888428, "process_mem_max_rss": "94664", "process_out_blocks": "1832", "process_user_time": 9.648314}
[0m16:58:27.121094 [debug] [MainThread]: Command `dbt run` succeeded at 16:58:27.118538 after 11.36 seconds
[0m16:58:27.124048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef3da2d4c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef3da0cea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ef3da270a70>]}
[0m16:58:27.127308 [debug] [MainThread]: Flushing usage events
[0m16:58:28.508164 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:56.707549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733436634fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7334373eeb70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7334366378f0>]}


============================== 17:10:56.754726 | c7775384-d1e9-466f-850c-10f65a8742c4 ==============================
[0m17:10:56.754726 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:10:56.756672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:10:58.280362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7775384-d1e9-466f-850c-10f65a8742c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733435c6b380>]}
[0m17:10:58.607469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7775384-d1e9-466f-850c-10f65a8742c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7334360c1370>]}
[0m17:10:58.611878 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:10:59.197560 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:11:00.597265 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:11:00.599011 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:11:00.829480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7775384-d1e9-466f-850c-10f65a8742c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733434245280>]}
[0m17:11:01.331221 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:11:01.351224 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:11:01.619367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7775384-d1e9-466f-850c-10f65a8742c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733433e64f20>]}
[0m17:11:01.621725 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m17:11:01.623266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7775384-d1e9-466f-850c-10f65a8742c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733435a32ae0>]}
[0m17:11:01.630281 [info ] [MainThread]: 
[0m17:11:01.632455 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:11:01.644123 [info ] [MainThread]: 
[0m17:11:01.646900 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:11:01.690488 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m17:11:02.286680 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m17:11:02.290584 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:11:02.293418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:02.703899 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.411 seconds
[0m17:11:02.709589 [debug] [ThreadPool]: On list_db: Close
[0m17:11:02.722277 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m17:11:02.753008 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m17:11:02.754636 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m17:11:02.757104 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:02.851649 [debug] [ThreadPool]: SQL status: BEGIN in 0.095 seconds
[0m17:11:02.853192 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m17:11:02.854741 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m17:11:02.904896 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.049 seconds
[0m17:11:02.910647 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m17:11:02.913836 [debug] [ThreadPool]: On list_db_dev: Close
[0m17:11:02.965555 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:02.967386 [debug] [MainThread]: On master: BEGIN
[0m17:11:02.969135 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:11:03.033463 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m17:11:03.035225 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:03.037598 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:11:03.223024 [debug] [MainThread]: SQL status: SELECT 0 in 0.183 seconds
[0m17:11:03.229550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7775384-d1e9-466f-850c-10f65a8742c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733435a52c00>]}
[0m17:11:03.231662 [debug] [MainThread]: On master: ROLLBACK
[0m17:11:03.234773 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:03.238652 [debug] [MainThread]: On master: BEGIN
[0m17:11:03.241772 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m17:11:03.243425 [debug] [MainThread]: On master: COMMIT
[0m17:11:03.245205 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:03.246715 [debug] [MainThread]: On master: COMMIT
[0m17:11:03.250421 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:11:03.252805 [debug] [MainThread]: On master: Close
[0m17:11:03.276447 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m17:11:03.280905 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m17:11:03.283988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m17:11:03.286272 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m17:11:03.325630 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m17:11:03.330747 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m17:11:03.544052 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m17:11:03.550683 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m17:11:03.552376 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m17:11:03.554029 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:03.612468 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m17:11:03.613855 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m17:11:03.615313 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m17:11:03.746278 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.129 seconds
[0m17:11:03.775447 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m17:11:03.779072 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m17:11:03.785551 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m17:11:03.800492 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m17:11:03.802563 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m17:11:03.805256 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:11:03.899336 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m17:11:03.901233 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m17:11:03.903091 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m17:11:03.909760 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m17:11:03.956172 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m17:11:03.983342 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m17:11:03.986641 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m17:11:04.009294 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.020 seconds
[0m17:11:04.019400 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m17:11:04.028902 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7775384-d1e9-466f-850c-10f65a8742c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73343658a330>]}
[0m17:11:04.032128 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 0.74s]
[0m17:11:04.035277 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m17:11:04.043041 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m17:11:04.046632 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m17:11:04.050097 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m17:11:04.053035 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m17:11:04.055874 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m17:11:04.068377 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m17:11:04.070607 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m17:11:04.074233 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m17:11:04.101923 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m17:11:04.110057 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m17:11:04.114512 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m17:11:04.116189 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m17:11:04.140712 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m17:11:04.151061 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m17:11:04.153898 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:11:04.157189 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m17:11:04.158700 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:11:04.160650 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:11:04.162604 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m17:11:04.164967 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:11:04.190628 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m17:11:04.192288 [debug] [Thread-4 (]: SQL status: BEGIN in 0.027 seconds
[0m17:11:04.195174 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:11:04.197552 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:11:04.200509 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m17:11:04.202859 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m17:11:04.226525 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.020 seconds
[0m17:11:04.241373 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:11:04.243164 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.038 seconds
[0m17:11:04.244516 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m17:11:04.254707 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:11:04.256913 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m17:11:04.258297 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:11:04.267047 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m17:11:04.277834 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:11:04.289017 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:11:04.290259 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m17:11:04.291919 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m17:11:04.296564 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:11:04.298146 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:11:04.304575 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m17:11:04.310247 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m17:11:04.311717 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:11:04.315604 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:11:04.317268 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m17:11:04.318714 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m17:11:04.325252 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m17:11:04.335583 [debug] [Thread-3 (]: SQL status: COMMIT in 0.015 seconds
[0m17:11:04.338008 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m17:11:04.346976 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m17:11:04.349712 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:11:04.352208 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:11:04.354196 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m17:11:04.356401 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m17:11:04.365642 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m17:11:04.369837 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m17:11:04.371396 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.013 seconds
[0m17:11:04.374147 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7775384-d1e9-466f-850c-10f65a8742c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733413f43230>]}
[0m17:11:04.378382 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m17:11:04.381207 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.32s]
[0m17:11:04.384406 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c7775384-d1e9-466f-850c-10f65a8742c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7334330c07a0>]}
[0m17:11:04.387419 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m17:11:04.391039 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.32s]
[0m17:11:04.399883 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m17:11:04.411424 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:04.413837 [debug] [MainThread]: On master: BEGIN
[0m17:11:04.418503 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:11:04.481874 [debug] [MainThread]: SQL status: BEGIN in 0.064 seconds
[0m17:11:04.483579 [debug] [MainThread]: On master: COMMIT
[0m17:11:04.485070 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:04.486439 [debug] [MainThread]: On master: COMMIT
[0m17:11:04.488536 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:11:04.490357 [debug] [MainThread]: On master: Close
[0m17:11:04.501992 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:04.504156 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m17:11:04.505948 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m17:11:04.509780 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m17:11:04.517253 [info ] [MainThread]: 
[0m17:11:04.519280 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m17:11:04.525367 [debug] [MainThread]: Command end result
[0m17:11:04.666054 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:11:04.671162 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:11:04.700819 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m17:11:04.702339 [info ] [MainThread]: 
[0m17:11:04.710679 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:11:04.712893 [info ] [MainThread]: 
[0m17:11:04.715018 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:11:04.728961 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.392639, "process_in_blocks": "115824", "process_kernel_time": 11.222502, "process_mem_max_rss": "107320", "process_out_blocks": "3392", "process_user_time": 12.379067}
[0m17:11:04.731782 [debug] [MainThread]: Command `dbt run` succeeded at 17:11:04.730965 after 8.40 seconds
[0m17:11:04.734322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733435c84b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733433ef2ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7334391f6840>]}
[0m17:11:04.745378 [debug] [MainThread]: Flushing usage events
[0m17:11:05.635736 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:29:16.893545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc48c9d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc31d8ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc2d40c20>]}


============================== 11:29:16.950263 | b27ba3ef-871e-492f-9de5-5481a4ecf20c ==============================
[0m11:29:16.950263 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:29:16.952980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:29:19.479737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b27ba3ef-871e-492f-9de5-5481a4ecf20c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc296bbf0>]}
[0m11:29:20.029418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b27ba3ef-871e-492f-9de5-5481a4ecf20c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc2de48c0>]}
[0m11:29:20.034290 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:29:21.001495 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:29:22.329658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:29:22.331757 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:29:22.696566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b27ba3ef-871e-492f-9de5-5481a4ecf20c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc1204410>]}
[0m11:29:23.626068 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:29:23.658198 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:29:23.963089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b27ba3ef-871e-492f-9de5-5481a4ecf20c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc0f55f70>]}
[0m11:29:23.965587 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m11:29:23.970822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b27ba3ef-871e-492f-9de5-5481a4ecf20c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc2a2d1c0>]}
[0m11:29:23.978202 [info ] [MainThread]: 
[0m11:29:23.980262 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:29:23.984371 [info ] [MainThread]: 
[0m11:29:23.988365 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:29:24.032523 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:29:25.237774 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:29:25.248887 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:29:25.256190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:29:28.561104 [debug] [ThreadPool]: SQL status: SELECT 5 in 3.306 seconds
[0m11:29:28.569458 [debug] [ThreadPool]: On list_db: Close
[0m11:29:28.582289 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:29:28.636866 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:29:28.641385 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:29:28.648975 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:29:28.752431 [debug] [ThreadPool]: SQL status: BEGIN in 0.103 seconds
[0m11:29:28.754401 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:29:28.756350 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:29:28.979884 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.221 seconds
[0m11:29:28.986235 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:29:28.992990 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:29:29.034390 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:29.036602 [debug] [MainThread]: On master: BEGIN
[0m11:29:29.038722 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:29:29.131312 [debug] [MainThread]: SQL status: BEGIN in 0.092 seconds
[0m11:29:29.133324 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:29.135791 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:29:30.258972 [debug] [MainThread]: SQL status: SELECT 0 in 1.117 seconds
[0m11:29:30.275596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b27ba3ef-871e-492f-9de5-5481a4ecf20c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc0f0c5f0>]}
[0m11:29:30.278484 [debug] [MainThread]: On master: ROLLBACK
[0m11:29:30.282147 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:30.286698 [debug] [MainThread]: On master: BEGIN
[0m11:29:30.293956 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m11:29:30.296055 [debug] [MainThread]: On master: COMMIT
[0m11:29:30.299208 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:30.300987 [debug] [MainThread]: On master: COMMIT
[0m11:29:30.308496 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:29:30.312450 [debug] [MainThread]: On master: Close
[0m11:29:30.434098 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m11:29:30.439008 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m11:29:30.477658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m11:29:30.480827 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m11:29:30.572490 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m11:29:30.581753 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m11:29:31.011683 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m11:29:31.017499 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m11:29:31.020339 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m11:29:31.024572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:29:31.086052 [debug] [Thread-1 (]: SQL status: BEGIN in 0.061 seconds
[0m11:29:31.088715 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m11:29:31.091965 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m11:29:31.298941 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.194 seconds
[0m11:29:31.391934 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m11:29:31.394753 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m11:29:31.414469 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m11:29:31.463323 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m11:29:31.466276 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m11:29:31.488083 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m11:29:31.799864 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m11:29:31.813841 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m11:29:31.816561 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m11:29:31.882903 [debug] [Thread-1 (]: SQL status: COMMIT in 0.055 seconds
[0m11:29:32.004183 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m11:29:32.089528 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m11:29:32.091616 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m11:29:32.271006 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.176 seconds
[0m11:29:32.299740 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m11:29:32.355295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b27ba3ef-871e-492f-9de5-5481a4ecf20c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc3586600>]}
[0m11:29:32.369051 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 1.86s]
[0m11:29:32.387933 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m11:29:32.426606 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m11:29:32.437521 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m11:29:32.468603 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m11:29:32.484896 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m11:29:32.473829 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m11:29:32.511871 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m11:29:32.500220 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m11:29:32.514656 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m11:29:32.594252 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m11:29:32.651458 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m11:29:32.655457 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m11:29:32.658298 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m11:29:32.735204 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m11:29:32.745170 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m11:29:32.764784 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:29:32.767401 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m11:29:32.770167 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:29:32.782774 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:29:32.787505 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m11:29:32.789550 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:29:32.896687 [debug] [Thread-3 (]: SQL status: BEGIN in 0.127 seconds
[0m11:29:32.909555 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:29:32.923139 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m11:29:32.931322 [debug] [Thread-4 (]: SQL status: BEGIN in 0.142 seconds
[0m11:29:32.943930 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:29:32.946540 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m11:29:33.057270 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.107 seconds
[0m11:29:33.087455 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:29:33.089636 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m11:29:33.101453 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:29:33.131197 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:29:33.144831 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m11:29:33.150920 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m11:29:33.176773 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:29:33.184293 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:29:33.187126 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:29:33.203811 [debug] [Thread-4 (]: SQL status: COMMIT in 0.014 seconds
[0m11:29:33.240292 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m11:29:33.253836 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:29:33.256392 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m11:29:33.269524 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.343 seconds
[0m11:29:33.302115 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.030 seconds
[0m11:29:33.310670 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:29:33.329243 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m11:29:33.331445 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m11:29:33.340157 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m11:29:33.343188 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b27ba3ef-871e-492f-9de5-5481a4ecf20c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc00aa720>]}
[0m11:29:33.395536 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:29:33.396471 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.86s]
[0m11:29:33.410979 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m11:29:33.414866 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m11:29:33.430553 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:29:33.470551 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m11:29:33.472865 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:29:33.485540 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m11:29:33.549285 [debug] [Thread-3 (]: SQL status: COMMIT in 0.062 seconds
[0m11:29:33.567280 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m11:29:33.583185 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:29:33.585576 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m11:29:33.606088 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.018 seconds
[0m11:29:33.624799 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m11:29:33.628167 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b27ba3ef-871e-492f-9de5-5481a4ecf20c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc0082630>]}
[0m11:29:33.630886 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 1.12s]
[0m11:29:33.646157 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m11:29:33.667621 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:33.669734 [debug] [MainThread]: On master: BEGIN
[0m11:29:33.678631 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:29:33.755572 [debug] [MainThread]: SQL status: BEGIN in 0.077 seconds
[0m11:29:33.765812 [debug] [MainThread]: On master: COMMIT
[0m11:29:33.767687 [debug] [MainThread]: Using postgres connection "master"
[0m11:29:33.769279 [debug] [MainThread]: On master: COMMIT
[0m11:29:33.772962 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:29:33.775435 [debug] [MainThread]: On master: Close
[0m11:29:33.781543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:29:33.783712 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m11:29:33.785336 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m11:29:33.786413 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m11:29:33.787876 [info ] [MainThread]: 
[0m11:29:33.790501 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 9.80 seconds (9.80s).
[0m11:29:33.797359 [debug] [MainThread]: Command end result
[0m11:29:34.050275 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:29:34.071868 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:29:34.144064 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:29:34.146042 [info ] [MainThread]: 
[0m11:29:34.148923 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:29:34.162291 [info ] [MainThread]: 
[0m11:29:34.164738 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:29:34.190439 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.675907, "process_in_blocks": "115640", "process_kernel_time": 22.45065, "process_mem_max_rss": "106892", "process_out_blocks": "3392", "process_user_time": 20.907698}
[0m11:29:34.194157 [debug] [MainThread]: Command `dbt run` succeeded at 11:29:34.193089 after 17.69 seconds
[0m11:29:34.208758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc2dbcc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc2dbd130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cc1219760>]}
[0m11:29:34.213471 [debug] [MainThread]: Flushing usage events
[0m11:29:35.634373 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:45:59.519642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79fe6b490320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79fe6c002f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79fe6b44fa10>]}


============================== 11:45:59.673355 | 3d7b2b15-de94-4ca0-9124-2cf0606b6fd0 ==============================
[0m11:45:59.673355 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:45:59.694460 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:46:03.431053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d7b2b15-de94-4ca0-9124-2cf0606b6fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79fe6d3835f0>]}
[0m11:46:04.198933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d7b2b15-de94-4ca0-9124-2cf0606b6fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79fe6bf20da0>]}
[0m11:46:04.211102 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:46:05.941886 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:46:08.127416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:46:08.134309 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:46:08.747786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d7b2b15-de94-4ca0-9124-2cf0606b6fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79fe69bcfd40>]}
[0m11:46:09.939823 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:46:09.981469 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:46:10.690096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d7b2b15-de94-4ca0-9124-2cf0606b6fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79fe698f4ad0>]}
[0m11:46:10.692508 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m11:46:10.704834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d7b2b15-de94-4ca0-9124-2cf0606b6fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79fe69c02030>]}
[0m11:46:10.726631 [info ] [MainThread]: 
[0m11:46:10.729849 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:46:10.731989 [info ] [MainThread]: 
[0m11:46:10.734478 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:46:10.789315 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:46:12.116695 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:46:12.121236 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:46:12.123735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:46:12.905203 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.781 seconds
[0m11:46:12.955637 [debug] [ThreadPool]: On list_db: Close
[0m11:46:12.978585 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:46:13.044533 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:46:13.051738 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:46:13.059744 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:46:13.134770 [debug] [ThreadPool]: SQL status: BEGIN in 0.074 seconds
[0m11:46:13.150140 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:46:13.152678 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:46:13.627664 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.461 seconds
[0m11:46:13.645734 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:46:13.672269 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:46:13.742863 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:13.744829 [debug] [MainThread]: On master: BEGIN
[0m11:46:13.747162 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:46:13.826641 [debug] [MainThread]: SQL status: BEGIN in 0.079 seconds
[0m11:46:13.828427 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:13.837096 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:46:13.981950 [debug] [MainThread]: SQL status: SELECT 0 in 0.142 seconds
[0m11:46:13.988658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d7b2b15-de94-4ca0-9124-2cf0606b6fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79fe69777b90>]}
[0m11:46:13.991211 [debug] [MainThread]: On master: ROLLBACK
[0m11:46:13.998315 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:14.001617 [debug] [MainThread]: On master: BEGIN
[0m11:46:14.005716 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m11:46:14.007750 [debug] [MainThread]: On master: COMMIT
[0m11:46:14.009623 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:14.015318 [debug] [MainThread]: On master: COMMIT
[0m11:46:14.020171 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m11:46:14.022864 [debug] [MainThread]: On master: Close
[0m11:46:14.052113 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m11:46:14.056157 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m11:46:14.059160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m11:46:14.070670 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m11:46:14.146106 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m11:46:14.153837 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m11:46:14.498426 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m11:46:14.506451 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m11:46:14.508875 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m11:46:14.511333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:46:14.550348 [debug] [Thread-1 (]: SQL status: BEGIN in 0.039 seconds
[0m11:46:14.552923 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m11:46:14.554846 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m11:46:14.799559 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.243 seconds
[0m11:46:14.858105 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m11:46:14.864438 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m11:46:14.879386 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m11:46:14.907531 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m11:46:14.909777 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m11:46:14.921212 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m11:46:15.094341 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m11:46:15.099808 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m11:46:15.108451 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m11:46:15.117110 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m11:46:15.161841 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m11:46:15.204602 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m11:46:15.207907 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m11:46:15.240072 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.030 seconds
[0m11:46:15.262206 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m11:46:15.283318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d7b2b15-de94-4ca0-9124-2cf0606b6fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79fe6d3826f0>]}
[0m11:46:15.294686 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 1[0m in 1.21s]
[0m11:46:15.298071 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m11:46:15.308477 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m11:46:15.312147 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m11:46:15.315477 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m11:46:15.318900 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m11:46:15.336180 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m11:46:15.353474 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m11:46:15.361916 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m11:46:15.374838 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m11:46:15.438148 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m11:46:15.453656 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m11:46:15.459328 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m11:46:15.461582 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m11:46:15.516345 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m11:46:15.523707 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m11:46:15.529513 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:46:15.535346 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m11:46:15.545289 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:46:15.543364 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:46:15.548223 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m11:46:15.551271 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:46:15.593114 [debug] [Thread-3 (]: SQL status: BEGIN in 0.047 seconds
[0m11:46:15.595602 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:46:15.599292 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m11:46:15.601995 [debug] [Thread-4 (]: SQL status: BEGIN in 0.051 seconds
[0m11:46:15.612075 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:46:15.614530 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m11:46:15.683456 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.064 seconds
[0m11:46:15.725743 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:46:15.737816 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m11:46:15.740460 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.133 seconds
[0m11:46:15.742559 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:46:15.798322 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:46:15.810431 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m11:46:15.814913 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:46:15.828260 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m11:46:15.830702 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m11:46:15.843234 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m11:46:15.846889 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:46:15.868928 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:46:15.876383 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:46:15.879518 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:46:15.883222 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m11:46:15.891385 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m11:46:15.916293 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.030 seconds
[0m11:46:15.922723 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m11:46:15.941431 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:46:15.944235 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m11:46:15.946758 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m11:46:15.949431 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:46:15.959581 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m11:46:15.972279 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.016 seconds
[0m11:46:15.975017 [debug] [Thread-3 (]: SQL status: COMMIT in 0.012 seconds
[0m11:46:15.982851 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m11:46:16.001869 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d7b2b15-de94-4ca0-9124-2cf0606b6fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79fe68a8a780>]}
[0m11:46:15.997399 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m11:46:16.015427 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:46:16.017538 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m11:46:16.007956 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 1[0m in 0.66s]
[0m11:46:16.023522 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m11:46:16.033961 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.012 seconds
[0m11:46:16.049450 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m11:46:16.053909 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d7b2b15-de94-4ca0-9124-2cf0606b6fd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79fe68a99010>]}
[0m11:46:16.069726 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 1[0m in 0.73s]
[0m11:46:16.082686 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m11:46:16.094109 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:16.096633 [debug] [MainThread]: On master: BEGIN
[0m11:46:16.102820 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:46:16.160296 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m11:46:16.162145 [debug] [MainThread]: On master: COMMIT
[0m11:46:16.164198 [debug] [MainThread]: Using postgres connection "master"
[0m11:46:16.165908 [debug] [MainThread]: On master: COMMIT
[0m11:46:16.172173 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m11:46:16.178933 [debug] [MainThread]: On master: Close
[0m11:46:16.181689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:46:16.183417 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m11:46:16.185130 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m11:46:16.187964 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m11:46:16.198884 [info ] [MainThread]: 
[0m11:46:16.202827 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 5.46 seconds (5.46s).
[0m11:46:16.219327 [debug] [MainThread]: Command end result
[0m11:46:16.455760 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:46:16.464610 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:46:16.530639 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:46:16.534534 [info ] [MainThread]: 
[0m11:46:16.537038 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:46:16.539598 [info ] [MainThread]: 
[0m11:46:16.541763 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:46:16.568775 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.197996, "process_in_blocks": "118880", "process_kernel_time": 13.291045, "process_mem_max_rss": "107288", "process_out_blocks": "3384", "process_user_time": 24.0164}
[0m11:46:16.577907 [debug] [MainThread]: Command `dbt run` succeeded at 11:46:16.573140 after 18.20 seconds
[0m11:46:16.581043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79fe6b4910a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79fe6b490140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79fe699826f0>]}
[0m11:46:16.593551 [debug] [MainThread]: Flushing usage events
[0m11:46:17.545689 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:20:05.530181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d280e20c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d280e20d280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d280fcabfb0>]}


============================== 12:20:05.547949 | 6c6de53a-d4c8-4df4-9697-9cb199d3cd1a ==============================
[0m12:20:05.547949 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:20:05.549983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:20:06.362073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c6de53a-d4c8-4df4-9697-9cb199d3cd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d280c57ecf0>]}
[0m12:20:06.603484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c6de53a-d4c8-4df4-9697-9cb199d3cd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d280f06ac90>]}
[0m12:20:06.607190 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:20:06.970725 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:20:07.585150 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:20:07.586619 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:20:07.691314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c6de53a-d4c8-4df4-9697-9cb199d3cd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d280c57f230>]}
[0m12:20:07.952545 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:20:07.967363 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:20:08.063748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c6de53a-d4c8-4df4-9697-9cb199d3cd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d280c120260>]}
[0m12:20:08.065124 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:20:08.066523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c6de53a-d4c8-4df4-9697-9cb199d3cd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d280c409910>]}
[0m12:20:08.074193 [info ] [MainThread]: 
[0m12:20:08.076201 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:20:08.078201 [info ] [MainThread]: 
[0m12:20:08.087758 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:20:08.116141 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:20:08.419974 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:20:08.421537 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:20:08.422937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:08.619205 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.196 seconds
[0m12:20:08.636803 [debug] [ThreadPool]: On list_db: Close
[0m12:20:08.643447 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:20:08.679157 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:20:08.680803 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:20:08.684240 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:20:08.721715 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m12:20:08.723616 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:20:08.725466 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:20:08.791056 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.063 seconds
[0m12:20:08.797737 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:20:08.802387 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:20:08.837758 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:08.839481 [debug] [MainThread]: On master: BEGIN
[0m12:20:08.840942 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:20:08.868324 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m12:20:08.873930 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:08.876528 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:20:08.949890 [debug] [MainThread]: SQL status: SELECT 0 in 0.070 seconds
[0m12:20:08.965633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c6de53a-d4c8-4df4-9697-9cb199d3cd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d280c1157f0>]}
[0m12:20:08.969935 [debug] [MainThread]: On master: ROLLBACK
[0m12:20:08.979300 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:08.981139 [debug] [MainThread]: On master: BEGIN
[0m12:20:08.987562 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m12:20:08.992835 [debug] [MainThread]: On master: COMMIT
[0m12:20:08.997009 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:08.998695 [debug] [MainThread]: On master: COMMIT
[0m12:20:09.001289 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:20:09.005172 [debug] [MainThread]: On master: Close
[0m12:20:09.057912 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m12:20:09.064965 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m12:20:09.067805 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m12:20:09.071682 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m12:20:09.136632 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m12:20:09.149779 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m12:20:09.393910 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m12:20:09.400785 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m12:20:09.402832 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m12:20:09.404542 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:20:09.427526 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m12:20:09.429112 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m12:20:09.430944 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m12:20:09.509420 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.077 seconds
[0m12:20:09.537920 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m12:20:09.539587 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m12:20:09.543892 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:20:09.555606 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m12:20:09.556740 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m12:20:09.559460 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:20:09.643101 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m12:20:09.644170 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m12:20:09.645728 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m12:20:09.652133 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m12:20:09.673360 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m12:20:09.695641 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m12:20:09.697018 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m12:20:09.712595 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m12:20:09.719323 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m12:20:09.725356 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c6de53a-d4c8-4df4-9697-9cb199d3cd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d280fa42330>]}
[0m12:20:09.727579 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 5[0m in 0.65s]
[0m12:20:09.730515 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m12:20:09.734751 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:20:09.736467 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:20:09.739002 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:20:09.745119 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:20:09.746854 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:20:09.742057 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:20:09.770057 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:20:09.773595 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:20:09.776377 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:20:09.789744 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:20:09.802142 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:20:09.818051 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:20:09.820532 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:20:09.833509 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:20:09.838493 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:20:09.840000 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:20:09.841992 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:20:09.844601 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:20:09.846413 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:20:09.848106 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:20:09.870104 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m12:20:09.872101 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:20:09.874470 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m12:20:09.876738 [debug] [Thread-4 (]: SQL status: BEGIN in 0.029 seconds
[0m12:20:09.878934 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:20:09.881207 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m12:20:09.921449 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.043 seconds
[0m12:20:09.934249 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:20:09.935914 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.049 seconds
[0m12:20:09.937626 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:20:09.950931 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:20:09.955903 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:20:09.958389 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:20:09.967426 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m12:20:09.981680 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:20:09.991637 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:20:09.993387 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:20:09.994913 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:20:09.996098 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:20:10.001098 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:20:10.002459 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:20:10.003598 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:20:10.007543 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:20:10.008854 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:20:10.010127 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:20:10.011764 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:20:10.015783 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m12:20:10.085767 [debug] [Thread-4 (]: SQL status: COMMIT in 0.012 seconds
[0m12:20:10.084047 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:20:10.094754 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:20:10.097255 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:20:10.099954 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:20:10.101317 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:20:10.102844 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:20:10.110689 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:20:10.114682 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:20:10.115920 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.011 seconds
[0m12:20:10.120319 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:20:10.122108 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c6de53a-d4c8-4df4-9697-9cb199d3cd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d280b3d2ed0>]}
[0m12:20:10.124197 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.38s]
[0m12:20:10.126218 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c6de53a-d4c8-4df4-9697-9cb199d3cd1a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d280b3c52b0>]}
[0m12:20:10.128475 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:20:10.130824 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 5[0m in 0.35s]
[0m12:20:10.135630 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:20:10.143736 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:10.145584 [debug] [MainThread]: On master: BEGIN
[0m12:20:10.146916 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:20:10.180701 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m12:20:10.182931 [debug] [MainThread]: On master: COMMIT
[0m12:20:10.185995 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:10.188503 [debug] [MainThread]: On master: COMMIT
[0m12:20:10.199281 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:20:10.200940 [debug] [MainThread]: On master: Close
[0m12:20:10.203397 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:20:10.205144 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m12:20:10.206819 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:20:10.212562 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:20:10.217158 [info ] [MainThread]: 
[0m12:20:10.219893 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.13 seconds (2.13s).
[0m12:20:10.228038 [debug] [MainThread]: Command end result
[0m12:20:10.382205 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:20:10.387780 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:20:10.411045 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:20:10.412642 [info ] [MainThread]: 
[0m12:20:10.414538 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:20:10.416447 [info ] [MainThread]: 
[0m12:20:10.418918 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:20:10.426255 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.1828146, "process_in_blocks": "113624", "process_kernel_time": 2.70365, "process_mem_max_rss": "106784", "process_out_blocks": "1800", "process_user_time": 7.970762}
[0m12:20:10.429827 [debug] [MainThread]: Command `dbt run` succeeded at 12:20:10.428923 after 5.19 seconds
[0m12:20:10.432174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d280fcabfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d280e1df560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d280c40a930>]}
[0m12:20:10.434818 [debug] [MainThread]: Flushing usage events
[0m12:20:11.074678 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:26:34.081094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377edec10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377ecc28590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377eb965820>]}


============================== 12:26:34.159332 | bef9623d-e307-4612-88bc-bdf96c256d72 ==============================
[0m12:26:34.159332 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:26:34.163205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:26:36.111127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bef9623d-e307-4612-88bc-bdf96c256d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377e9375460>]}
[0m12:26:36.484450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bef9623d-e307-4612-88bc-bdf96c256d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377eabb3d40>]}
[0m12:26:36.497699 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:26:37.722896 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:26:38.978935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:26:39.006082 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:26:39.327650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bef9623d-e307-4612-88bc-bdf96c256d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377e942c470>]}
[0m12:26:39.961266 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:26:40.080622 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:26:40.691556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bef9623d-e307-4612-88bc-bdf96c256d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377e9178170>]}
[0m12:26:40.734592 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:26:40.737665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bef9623d-e307-4612-88bc-bdf96c256d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377e91ec9b0>]}
[0m12:26:40.757261 [info ] [MainThread]: 
[0m12:26:40.774414 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:26:40.776071 [info ] [MainThread]: 
[0m12:26:40.785090 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:26:40.904650 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:26:41.677832 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:26:41.702323 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:26:41.706574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:42.569134 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.311 seconds
[0m12:26:42.580950 [debug] [ThreadPool]: On list_db: Close
[0m12:26:42.594994 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev'
[0m12:26:42.645114 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:26:42.648693 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:26:42.650220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:43.127083 [debug] [ThreadPool]: SQL status: BEGIN in 0.466 seconds
[0m12:26:43.134593 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:26:43.136514 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:26:43.166741 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.029 seconds
[0m12:26:43.179196 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:26:43.183238 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:26:43.224971 [debug] [MainThread]: Using postgres connection "master"
[0m12:26:43.227688 [debug] [MainThread]: On master: BEGIN
[0m12:26:43.229419 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:26:43.936916 [debug] [MainThread]: SQL status: BEGIN in 0.688 seconds
[0m12:26:43.956334 [debug] [MainThread]: Using postgres connection "master"
[0m12:26:43.958371 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:26:44.068157 [debug] [MainThread]: SQL status: SELECT 0 in 0.107 seconds
[0m12:26:44.080757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bef9623d-e307-4612-88bc-bdf96c256d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377eac1cf20>]}
[0m12:26:44.086786 [debug] [MainThread]: On master: ROLLBACK
[0m12:26:44.091890 [debug] [MainThread]: Using postgres connection "master"
[0m12:26:44.093646 [debug] [MainThread]: On master: BEGIN
[0m12:26:44.098088 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m12:26:44.099764 [debug] [MainThread]: On master: COMMIT
[0m12:26:44.101242 [debug] [MainThread]: Using postgres connection "master"
[0m12:26:44.102489 [debug] [MainThread]: On master: COMMIT
[0m12:26:44.104624 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:26:44.106675 [debug] [MainThread]: On master: Close
[0m12:26:44.159130 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m12:26:44.166565 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m12:26:44.169912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m12:26:44.173141 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m12:26:44.256263 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m12:26:44.279769 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m12:26:44.650259 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m12:26:44.660956 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m12:26:44.664896 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m12:26:44.667178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:26:45.763182 [debug] [Thread-1 (]: SQL status: BEGIN in 1.080 seconds
[0m12:26:45.773036 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m12:26:45.778394 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m12:26:45.867579 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.086 seconds
[0m12:26:45.897604 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m12:26:45.900122 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m12:26:45.903641 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:26:45.924755 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m12:26:45.926484 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m12:26:45.937258 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:26:46.113001 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m12:26:46.123091 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m12:26:46.127224 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m12:26:46.143900 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m12:26:46.205061 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m12:26:46.245843 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m12:26:46.251580 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m12:26:46.286059 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.027 seconds
[0m12:26:46.304164 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m12:26:46.379704 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bef9623d-e307-4612-88bc-bdf96c256d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377ecbaa780>]}
[0m12:26:46.385260 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 5[0m in 2.14s]
[0m12:26:46.388838 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m12:26:46.407902 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:26:46.413983 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:26:46.416288 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:26:46.411795 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:26:46.424662 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:26:46.428244 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:26:46.419806 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:26:46.430527 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:26:46.460540 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:26:46.463784 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:26:46.478606 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:26:46.481249 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:26:46.531650 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:26:46.534403 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:26:46.539033 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:26:46.541319 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:26:46.543320 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:26:46.545584 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:26:46.552373 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:26:46.549581 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:26:47.280097 [debug] [Thread-4 (]: SQL status: BEGIN in 0.713 seconds
[0m12:26:47.292621 [debug] [Thread-3 (]: SQL status: BEGIN in 0.706 seconds
[0m12:26:47.299262 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:26:47.304420 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:26:47.309812 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m12:26:47.312164 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m12:26:47.360960 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.046 seconds
[0m12:26:47.388931 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.074 seconds
[0m12:26:47.392613 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:26:47.408426 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:26:47.420521 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m12:26:47.424832 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:26:47.438583 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:26:47.451254 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m12:26:47.461998 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:26:47.469022 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:26:47.470802 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:26:47.484858 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:26:47.474949 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:26:47.499771 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:26:47.506206 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:26:47.508081 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:26:47.510368 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:26:47.529083 [debug] [Thread-4 (]: SQL status: COMMIT in 0.019 seconds
[0m12:26:47.543874 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:26:47.545619 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:26:47.548187 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:26:47.549813 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:26:47.553773 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:26:47.560037 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:26:47.565730 [debug] [Thread-3 (]: SQL status: COMMIT in 0.014 seconds
[0m12:26:47.582116 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:26:47.585310 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.020 seconds
[0m12:26:47.593110 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:26:47.605893 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:26:47.611520 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:26:47.634306 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.019 seconds
[0m12:26:47.642343 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bef9623d-e307-4612-88bc-bdf96c256d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377e82891c0>]}
[0m12:26:47.645242 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:26:47.651243 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bef9623d-e307-4612-88bc-bdf96c256d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377e81ab6b0>]}
[0m12:26:47.660929 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 1.24s]
[0m12:26:47.667298 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:26:47.669564 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 5[0m in 1.19s]
[0m12:26:47.675545 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:26:47.697166 [debug] [MainThread]: Using postgres connection "master"
[0m12:26:47.699206 [debug] [MainThread]: On master: BEGIN
[0m12:26:47.701366 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:26:48.355420 [debug] [MainThread]: SQL status: BEGIN in 0.648 seconds
[0m12:26:48.368751 [debug] [MainThread]: On master: COMMIT
[0m12:26:48.370266 [debug] [MainThread]: Using postgres connection "master"
[0m12:26:48.371984 [debug] [MainThread]: On master: COMMIT
[0m12:26:48.382674 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m12:26:48.384870 [debug] [MainThread]: On master: Close
[0m12:26:48.388625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:48.394030 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m12:26:48.399907 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m12:26:48.401553 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:26:48.403118 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:26:48.418688 [info ] [MainThread]: 
[0m12:26:48.420763 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 7.63 seconds (7.63s).
[0m12:26:48.436665 [debug] [MainThread]: Command end result
[0m12:26:48.590356 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:26:48.614653 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:26:48.659757 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:26:48.664294 [info ] [MainThread]: 
[0m12:26:48.672508 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:26:48.674508 [info ] [MainThread]: 
[0m12:26:48.676675 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:26:48.752234 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.648717, "process_in_blocks": "424720", "process_kernel_time": 6.493395, "process_mem_max_rss": "95436", "process_out_blocks": "3448", "process_user_time": 14.469697}
[0m12:26:48.765943 [debug] [MainThread]: Command `dbt run` succeeded at 12:26:48.765357 after 15.67 seconds
[0m12:26:48.770347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377eb8d2ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377e917ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7377e917b5f0>]}
[0m12:26:48.775798 [debug] [MainThread]: Flushing usage events
[0m12:26:54.377007 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:36:59.644709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2dd51c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2d24cb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2dae4ce0>]}


============================== 12:36:59.715303 | 46e647cd-a28b-4318-bed6-2e50e5423a92 ==============================
[0m12:36:59.715303 [info ] [MainThread]: Running with dbt=1.9.0
[0m12:36:59.718145 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:37:01.343815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46e647cd-a28b-4318-bed6-2e50e5423a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2ced2ed0>]}
[0m12:37:01.583203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46e647cd-a28b-4318-bed6-2e50e5423a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2d91db80>]}
[0m12:37:01.588334 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:37:02.000996 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m12:37:02.721612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:37:02.722664 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:37:02.767490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46e647cd-a28b-4318-bed6-2e50e5423a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2b57c830>]}
[0m12:37:03.139268 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:37:03.146799 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:37:03.307909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46e647cd-a28b-4318-bed6-2e50e5423a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2b28ca10>]}
[0m12:37:03.309741 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m12:37:03.311312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46e647cd-a28b-4318-bed6-2e50e5423a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2b576b70>]}
[0m12:37:03.318132 [info ] [MainThread]: 
[0m12:37:03.319907 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:37:03.328921 [info ] [MainThread]: 
[0m12:37:03.333208 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:37:03.378005 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m12:37:03.740411 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m12:37:03.741465 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m12:37:03.742285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:37:04.173365 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.431 seconds
[0m12:37:04.179854 [debug] [ThreadPool]: On list_db: Close
[0m12:37:04.190450 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m12:37:04.227238 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:37:04.229299 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m12:37:04.231413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:37:04.315785 [debug] [ThreadPool]: SQL status: BEGIN in 0.085 seconds
[0m12:37:04.317588 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m12:37:04.319260 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m12:37:04.510433 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.188 seconds
[0m12:37:04.521807 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m12:37:04.524664 [debug] [ThreadPool]: On list_db_dev: Close
[0m12:37:04.561762 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:04.563538 [debug] [MainThread]: On master: BEGIN
[0m12:37:04.565412 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:37:04.647901 [debug] [MainThread]: SQL status: BEGIN in 0.082 seconds
[0m12:37:04.651167 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:04.654543 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:37:04.861645 [debug] [MainThread]: SQL status: SELECT 0 in 0.204 seconds
[0m12:37:04.869129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46e647cd-a28b-4318-bed6-2e50e5423a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2b57fe90>]}
[0m12:37:04.874423 [debug] [MainThread]: On master: ROLLBACK
[0m12:37:04.879923 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:04.883163 [debug] [MainThread]: On master: BEGIN
[0m12:37:04.887430 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m12:37:04.890533 [debug] [MainThread]: On master: COMMIT
[0m12:37:04.893275 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:04.895363 [debug] [MainThread]: On master: COMMIT
[0m12:37:04.899846 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m12:37:04.902291 [debug] [MainThread]: On master: Close
[0m12:37:04.929497 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m12:37:04.936995 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m12:37:04.940162 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m12:37:04.942957 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m12:37:05.002842 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m12:37:05.017000 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m12:37:05.249003 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m12:37:05.263215 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m12:37:05.265972 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m12:37:05.268141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:37:05.302061 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m12:37:05.304188 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m12:37:05.309503 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m12:37:05.406566 [debug] [Thread-1 (]: SQL status: SELECT 5 in 0.093 seconds
[0m12:37:05.432247 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m12:37:05.434577 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m12:37:05.441486 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m12:37:05.456188 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m12:37:05.458050 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m12:37:05.461705 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:37:05.572047 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m12:37:05.573468 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m12:37:05.574725 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m12:37:05.581283 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m12:37:05.604845 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m12:37:05.627504 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m12:37:05.628983 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m12:37:05.642266 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.012 seconds
[0m12:37:05.648832 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m12:37:05.655301 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46e647cd-a28b-4318-bed6-2e50e5423a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2d91e840>]}
[0m12:37:05.658034 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 5[0m in 0.71s]
[0m12:37:05.663153 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m12:37:05.667618 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m12:37:05.670227 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m12:37:05.676470 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m12:37:05.678972 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m12:37:05.672744 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m12:37:05.683578 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m12:37:05.686060 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m12:37:05.680917 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m12:37:05.704782 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m12:37:05.719436 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m12:37:05.723465 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m12:37:05.725537 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m12:37:05.739709 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m12:37:05.749183 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m12:37:05.752771 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:37:05.754369 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:37:05.755903 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m12:37:05.757479 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m12:37:05.759015 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:37:05.760721 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:37:05.781412 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m12:37:05.783898 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:37:05.785923 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m12:37:05.799205 [debug] [Thread-4 (]: SQL status: BEGIN in 0.038 seconds
[0m12:37:05.800988 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:37:05.808605 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m12:37:05.848710 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.037 seconds
[0m12:37:05.861470 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:37:05.863035 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.075 seconds
[0m12:37:05.864521 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m12:37:05.876449 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:37:05.878536 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m12:37:05.879659 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:37:05.889236 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m12:37:05.899399 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:37:05.904866 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:37:05.906049 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m12:37:05.907611 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m12:37:05.910219 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:37:05.911626 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:37:05.916717 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:37:05.921893 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:37:05.923481 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:37:05.925246 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:37:05.926822 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m12:37:05.928216 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m12:37:05.934018 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m12:37:05.942121 [debug] [Thread-3 (]: SQL status: COMMIT in 0.012 seconds
[0m12:37:05.942940 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m12:37:05.952598 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m12:37:05.954865 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m12:37:05.957042 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m12:37:05.958496 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m12:37:05.959866 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m12:37:05.967192 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.006 seconds
[0m12:37:05.972998 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m12:37:05.975035 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.013 seconds
[0m12:37:05.977833 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46e647cd-a28b-4318-bed6-2e50e5423a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2a42a540>]}
[0m12:37:05.983712 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m12:37:05.987423 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 5[0m in 0.30s]
[0m12:37:05.998626 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46e647cd-a28b-4318-bed6-2e50e5423a92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2a4cc110>]}
[0m12:37:06.002214 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m12:37:06.005978 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.32s]
[0m12:37:06.010222 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m12:37:06.019733 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:06.022711 [debug] [MainThread]: On master: BEGIN
[0m12:37:06.029186 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:37:06.056184 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m12:37:06.057910 [debug] [MainThread]: On master: COMMIT
[0m12:37:06.059422 [debug] [MainThread]: Using postgres connection "master"
[0m12:37:06.061551 [debug] [MainThread]: On master: COMMIT
[0m12:37:06.063677 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:37:06.064993 [debug] [MainThread]: On master: Close
[0m12:37:06.067482 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:37:06.069224 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m12:37:06.070260 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m12:37:06.071761 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m12:37:06.073764 [info ] [MainThread]: 
[0m12:37:06.081354 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m12:37:06.091696 [debug] [MainThread]: Command end result
[0m12:37:06.206860 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m12:37:06.211538 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m12:37:06.236168 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m12:37:06.237642 [info ] [MainThread]: 
[0m12:37:06.240164 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:37:06.243179 [info ] [MainThread]: 
[0m12:37:06.246047 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m12:37:06.253675 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.005006, "process_in_blocks": "114632", "process_kernel_time": 7.732538, "process_mem_max_rss": "107316", "process_out_blocks": "3392", "process_user_time": 10.79798}
[0m12:37:06.255871 [debug] [MainThread]: Command `dbt run` succeeded at 12:37:06.255335 after 7.01 seconds
[0m12:37:06.258507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2d0b06e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2b315580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2ec89f40>]}
[0m12:37:06.263916 [debug] [MainThread]: Flushing usage events
[0m12:37:06.969708 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:13:32.035238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7240d297fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7240d24246e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7240d21bca70>]}


============================== 13:13:32.062317 | f397f59b-de33-4df3-abd8-1962cd253765 ==============================
[0m13:13:32.062317 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:13:32.064442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:13:33.121849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f397f59b-de33-4df3-abd8-1962cd253765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7240d3d735c0>]}
[0m13:13:33.408296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f397f59b-de33-4df3-abd8-1962cd253765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7240d2424920>]}
[0m13:13:33.411031 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:13:33.819570 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:13:34.497495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:13:34.498877 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:13:34.643083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f397f59b-de33-4df3-abd8-1962cd253765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7240d05dc290>]}
[0m13:13:35.001092 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:13:35.020869 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:13:35.255898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f397f59b-de33-4df3-abd8-1962cd253765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7240d02e48c0>]}
[0m13:13:35.263095 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:13:35.264845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f397f59b-de33-4df3-abd8-1962cd253765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7240d03b0b60>]}
[0m13:13:35.271579 [info ] [MainThread]: 
[0m13:13:35.284841 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:13:35.286556 [info ] [MainThread]: 
[0m13:13:35.288706 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:13:35.333363 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:13:35.705635 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:13:35.706915 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:13:35.708190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:35.822067 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.114 seconds
[0m13:13:35.825801 [debug] [ThreadPool]: On list_db: Close
[0m13:13:35.830195 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m13:13:35.847753 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:13:35.848966 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m13:13:35.850093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:35.878996 [debug] [ThreadPool]: SQL status: BEGIN in 0.029 seconds
[0m13:13:35.880234 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:13:35.881394 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:13:35.922037 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.040 seconds
[0m13:13:35.925533 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m13:13:35.927372 [debug] [ThreadPool]: On list_db_dev: Close
[0m13:13:35.947756 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:35.949346 [debug] [MainThread]: On master: BEGIN
[0m13:13:35.950914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:13:35.970992 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m13:13:35.972605 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:35.974035 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:13:36.018722 [debug] [MainThread]: SQL status: SELECT 0 in 0.043 seconds
[0m13:13:36.023502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f397f59b-de33-4df3-abd8-1962cd253765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7240d23ca990>]}
[0m13:13:36.025305 [debug] [MainThread]: On master: ROLLBACK
[0m13:13:36.027157 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:36.028586 [debug] [MainThread]: On master: BEGIN
[0m13:13:36.031106 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:13:36.032719 [debug] [MainThread]: On master: COMMIT
[0m13:13:36.033899 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:36.036164 [debug] [MainThread]: On master: COMMIT
[0m13:13:36.038390 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:13:36.040705 [debug] [MainThread]: On master: Close
[0m13:13:36.053924 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m13:13:36.059296 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m13:13:36.063087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m13:13:36.065105 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m13:13:36.092369 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m13:13:36.099888 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m13:13:36.215752 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m13:13:36.221186 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:13:36.222852 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m13:13:36.224572 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:13:36.250999 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m13:13:36.252670 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:13:36.254182 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m13:13:36.337992 [debug] [Thread-1 (]: SQL status: SELECT 6 in 0.083 seconds
[0m13:13:36.375099 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:13:36.376555 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m13:13:36.379882 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:13:36.394441 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:13:36.396249 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m13:13:36.398935 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:13:36.484509 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:13:36.485946 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:13:36.487189 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:13:36.493855 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:13:36.518955 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m13:13:36.538506 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:13:36.541144 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m13:13:36.555185 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m13:13:36.564639 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m13:13:36.575341 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f397f59b-de33-4df3-abd8-1962cd253765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7240d0167ad0>]}
[0m13:13:36.578074 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 6[0m in 0.50s]
[0m13:13:36.581458 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m13:13:36.595619 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m13:13:36.597224 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m13:13:36.599040 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m13:13:36.600981 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m13:13:36.609961 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m13:13:36.620169 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m13:13:36.622905 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m13:13:36.627901 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m13:13:36.629970 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m13:13:36.656913 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m13:13:36.665823 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m13:13:36.688392 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m13:13:36.687309 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m13:13:36.703069 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m13:13:36.707193 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:13:36.711438 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m13:13:36.714787 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:13:36.716563 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:13:36.718607 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m13:13:36.721057 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:13:36.737398 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m13:13:36.738989 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:13:36.740795 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m13:13:36.748875 [debug] [Thread-4 (]: SQL status: BEGIN in 0.028 seconds
[0m13:13:36.753011 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:13:36.754969 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m13:13:36.780003 [debug] [Thread-4 (]: SQL status: SELECT 6 in 0.023 seconds
[0m13:13:36.805379 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.063 seconds
[0m13:13:36.804367 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:13:36.820863 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m13:13:36.819442 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:13:36.823562 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m13:13:36.825201 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:13:36.834399 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m13:13:36.840597 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:13:36.850191 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:13:36.851675 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m13:13:36.853612 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m13:13:36.858728 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:13:36.870631 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:13:36.872963 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:13:36.874738 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:13:36.877167 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m13:13:36.882668 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:13:36.884168 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:13:36.886870 [debug] [Thread-4 (]: SQL status: COMMIT in 0.010 seconds
[0m13:13:36.888831 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:13:36.898421 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m13:13:36.903021 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:13:36.904775 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m13:13:36.908559 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m13:13:36.925296 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.019 seconds
[0m13:13:36.930267 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m13:13:36.922106 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m13:13:36.933025 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f397f59b-de33-4df3-abd8-1962cd253765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7240cc34bd40>]}
[0m13:13:36.938467 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:13:36.948467 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m13:13:36.944914 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 6[0m in 0.31s]
[0m13:13:36.951388 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m13:13:36.958462 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.008 seconds
[0m13:13:36.968019 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m13:13:36.970487 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f397f59b-de33-4df3-abd8-1962cd253765', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7240cc39bfb0>]}
[0m13:13:36.972869 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.37s]
[0m13:13:36.977695 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m13:13:36.992606 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:36.995270 [debug] [MainThread]: On master: BEGIN
[0m13:13:36.996897 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:13:37.035863 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m13:13:37.038139 [debug] [MainThread]: On master: COMMIT
[0m13:13:37.041020 [debug] [MainThread]: Using postgres connection "master"
[0m13:13:37.045065 [debug] [MainThread]: On master: COMMIT
[0m13:13:37.054830 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:13:37.056870 [debug] [MainThread]: On master: Close
[0m13:13:37.059433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:37.060900 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m13:13:37.065288 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m13:13:37.068705 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m13:13:37.073797 [info ] [MainThread]: 
[0m13:13:37.075968 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.79 seconds (1.79s).
[0m13:13:37.085722 [debug] [MainThread]: Command end result
[0m13:13:37.218722 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:13:37.225073 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:13:37.246370 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:13:37.247883 [info ] [MainThread]: 
[0m13:13:37.249860 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:13:37.251625 [info ] [MainThread]: 
[0m13:13:37.253708 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:13:37.260201 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.463634, "process_in_blocks": "116736", "process_kernel_time": 2.930218, "process_mem_max_rss": "107432", "process_out_blocks": "3392", "process_user_time": 8.929413}
[0m13:13:37.262306 [debug] [MainThread]: Command `dbt run` succeeded at 13:13:37.261813 after 5.47 seconds
[0m13:13:37.264686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7240d24246e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7240d297c6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7240d297c140>]}
[0m13:13:37.267852 [debug] [MainThread]: Flushing usage events
[0m13:13:37.951094 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:22:53.847910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e76787a0770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7678c67620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e767a45b980>]}


============================== 13:22:53.894465 | b29f50a4-c440-46f2-99a8-e87517dff94e ==============================
[0m13:22:53.894465 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:22:53.897017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:22:55.891721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b29f50a4-c440-46f2-99a8-e87517dff94e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e76786598b0>]}
[0m13:22:56.320743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b29f50a4-c440-46f2-99a8-e87517dff94e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7678313740>]}
[0m13:22:56.328884 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:22:56.923590 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:22:57.901588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:22:57.904637 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:22:58.113113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b29f50a4-c440-46f2-99a8-e87517dff94e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7676b269c0>]}
[0m13:22:58.637158 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:22:58.652516 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:22:59.002384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b29f50a4-c440-46f2-99a8-e87517dff94e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e76767eb290>]}
[0m13:22:59.004717 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:22:59.007075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b29f50a4-c440-46f2-99a8-e87517dff94e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e767680ff80>]}
[0m13:22:59.015851 [info ] [MainThread]: 
[0m13:22:59.022466 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:22:59.024286 [info ] [MainThread]: 
[0m13:22:59.027291 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:22:59.069015 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:22:59.354729 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:22:59.355993 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:22:59.357082 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:59.495792 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.138 seconds
[0m13:22:59.509301 [debug] [ThreadPool]: On list_db: Close
[0m13:22:59.517734 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m13:22:59.550751 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:22:59.552870 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m13:22:59.556241 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:22:59.579301 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m13:22:59.580801 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:22:59.582475 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:22:59.632564 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.049 seconds
[0m13:22:59.636944 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m13:22:59.639035 [debug] [ThreadPool]: On list_db_dev: Close
[0m13:22:59.664261 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:59.666630 [debug] [MainThread]: On master: BEGIN
[0m13:22:59.668053 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:22:59.691874 [debug] [MainThread]: SQL status: BEGIN in 0.024 seconds
[0m13:22:59.694569 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:59.696467 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:22:59.765506 [debug] [MainThread]: SQL status: SELECT 0 in 0.066 seconds
[0m13:22:59.771129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b29f50a4-c440-46f2-99a8-e87517dff94e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7678916e10>]}
[0m13:22:59.773104 [debug] [MainThread]: On master: ROLLBACK
[0m13:22:59.775782 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:59.777300 [debug] [MainThread]: On master: BEGIN
[0m13:22:59.783793 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m13:22:59.786199 [debug] [MainThread]: On master: COMMIT
[0m13:22:59.788009 [debug] [MainThread]: Using postgres connection "master"
[0m13:22:59.789580 [debug] [MainThread]: On master: COMMIT
[0m13:22:59.792299 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:22:59.794615 [debug] [MainThread]: On master: Close
[0m13:22:59.812821 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m13:22:59.817084 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m13:22:59.820370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m13:22:59.822154 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m13:22:59.869515 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m13:22:59.876784 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m13:23:00.099387 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m13:23:00.112599 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:23:00.114541 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m13:23:00.116146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:23:00.149362 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m13:23:00.151445 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:23:00.153169 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m13:23:00.279819 [debug] [Thread-1 (]: SQL status: SELECT 7 in 0.124 seconds
[0m13:23:00.323182 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:23:00.324730 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m13:23:00.333658 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m13:23:00.348740 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:23:00.355838 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m13:23:00.359365 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:23:00.508931 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:23:00.510826 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:23:00.512396 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:23:00.534711 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m13:23:00.592560 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m13:23:00.634020 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:23:00.635893 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m13:23:00.654179 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.016 seconds
[0m13:23:00.668281 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m13:23:00.679212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29f50a4-c440-46f2-99a8-e87517dff94e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7678ec63f0>]}
[0m13:23:00.682548 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 7[0m in 0.85s]
[0m13:23:00.694433 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m13:23:00.699603 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m13:23:00.702071 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m13:23:00.708798 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m13:23:00.711509 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m13:23:00.704357 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m13:23:00.713283 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m13:23:00.716104 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m13:23:00.741570 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m13:23:00.740669 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m13:23:00.760066 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m13:23:00.765699 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m13:23:00.781663 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m13:23:00.784690 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m13:23:00.800848 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:23:00.804349 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m13:23:00.806859 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m13:23:00.810110 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:23:00.813559 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:23:00.815641 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m13:23:00.817368 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:23:00.839839 [debug] [Thread-4 (]: SQL status: BEGIN in 0.030 seconds
[0m13:23:00.841408 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:23:00.843565 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m13:23:00.845552 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m13:23:00.852636 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:23:00.854501 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m13:23:00.894657 [debug] [Thread-4 (]: SQL status: SELECT 7 in 0.044 seconds
[0m13:23:00.907499 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:23:00.908805 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.053 seconds
[0m13:23:00.910718 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m13:23:00.927208 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:23:00.930550 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:23:00.942139 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:23:00.943359 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m13:23:00.944802 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m13:23:00.948115 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:23:00.955763 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m13:23:00.961072 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:23:00.971240 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:23:00.973569 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m13:23:00.975763 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:23:00.978404 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:23:00.980148 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:23:00.986632 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:23:00.988907 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m13:23:00.990680 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:23:01.001018 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m13:23:01.002970 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:23:01.008829 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:23:01.011105 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m13:23:01.015099 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m13:23:01.025038 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.012 seconds
[0m13:23:01.024209 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m13:23:01.031133 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m13:23:01.034186 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:23:01.039887 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m13:23:01.037603 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29f50a4-c440-46f2-99a8-e87517dff94e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e76740d3da0>]}
[0m13:23:01.045648 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 7[0m in 0.33s]
[0m13:23:01.052436 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m13:23:01.059638 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.018 seconds
[0m13:23:01.077851 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m13:23:01.082393 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b29f50a4-c440-46f2-99a8-e87517dff94e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7675a4b200>]}
[0m13:23:01.090990 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.37s]
[0m13:23:01.096491 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m13:23:01.108125 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:01.110204 [debug] [MainThread]: On master: BEGIN
[0m13:23:01.111894 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:23:01.145636 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m13:23:01.147385 [debug] [MainThread]: On master: COMMIT
[0m13:23:01.149033 [debug] [MainThread]: Using postgres connection "master"
[0m13:23:01.150726 [debug] [MainThread]: On master: COMMIT
[0m13:23:01.152913 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:23:01.154686 [debug] [MainThread]: On master: Close
[0m13:23:01.159507 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:23:01.162070 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m13:23:01.164277 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m13:23:01.166482 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m13:23:01.168704 [info ] [MainThread]: 
[0m13:23:01.170725 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.14 seconds (2.14s).
[0m13:23:01.185922 [debug] [MainThread]: Command end result
[0m13:23:01.329713 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:23:01.337577 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:23:01.364430 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:23:01.365727 [info ] [MainThread]: 
[0m13:23:01.369474 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:23:01.371665 [info ] [MainThread]: 
[0m13:23:01.376705 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:23:01.391633 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.837738, "process_in_blocks": "116352", "process_kernel_time": 5.714559, "process_mem_max_rss": "106964", "process_out_blocks": "3392", "process_user_time": 13.58721}
[0m13:23:01.397136 [debug] [MainThread]: Command `dbt run` succeeded at 13:23:01.396258 after 7.84 seconds
[0m13:23:01.402213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e76790c0590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e7679727c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e76797247a0>]}
[0m13:23:01.412582 [debug] [MainThread]: Flushing usage events
[0m13:23:02.226373 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:46:40.328826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cee98ebec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ceeb8ac3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cee98ebf50>]}


============================== 13:46:40.372944 | 85cd6911-4d0d-499e-8688-49dc2c18636e ==============================
[0m13:46:40.372944 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:46:40.376224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:46:41.667679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85cd6911-4d0d-499e-8688-49dc2c18636e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ceeb817200>]}
[0m13:46:42.145614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85cd6911-4d0d-499e-8688-49dc2c18636e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cee9acff80>]}
[0m13:46:42.159898 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:46:42.680333 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:46:43.590146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:46:43.593327 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:46:43.920604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85cd6911-4d0d-499e-8688-49dc2c18636e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cee809d280>]}
[0m13:46:44.630014 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:46:44.651991 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:46:44.821975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85cd6911-4d0d-499e-8688-49dc2c18636e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cee7d84a70>]}
[0m13:46:44.824485 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:46:44.826907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85cd6911-4d0d-499e-8688-49dc2c18636e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cee809efc0>]}
[0m13:46:44.834619 [info ] [MainThread]: 
[0m13:46:44.841685 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:46:44.846275 [info ] [MainThread]: 
[0m13:46:44.848883 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:46:44.894282 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:46:45.295231 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:46:45.296984 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:46:45.298807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:45.507714 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.209 seconds
[0m13:46:45.512720 [debug] [ThreadPool]: On list_db: Close
[0m13:46:45.519342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m13:46:45.549043 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:46:45.550537 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m13:46:45.552423 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:45.582889 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m13:46:45.587645 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:46:45.589154 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:46:45.661171 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.070 seconds
[0m13:46:45.667359 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m13:46:45.679102 [debug] [ThreadPool]: On list_db_dev: Close
[0m13:46:45.712281 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:45.713746 [debug] [MainThread]: On master: BEGIN
[0m13:46:45.715006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:46:45.750536 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m13:46:45.751974 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:45.754074 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:46:45.818118 [debug] [MainThread]: SQL status: SELECT 0 in 0.062 seconds
[0m13:46:45.824240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85cd6911-4d0d-499e-8688-49dc2c18636e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cee7c03b00>]}
[0m13:46:45.826997 [debug] [MainThread]: On master: ROLLBACK
[0m13:46:45.830806 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:45.832257 [debug] [MainThread]: On master: BEGIN
[0m13:46:45.835274 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:46:45.838553 [debug] [MainThread]: On master: COMMIT
[0m13:46:45.840115 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:45.841228 [debug] [MainThread]: On master: COMMIT
[0m13:46:45.843281 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:46:45.845096 [debug] [MainThread]: On master: Close
[0m13:46:45.867864 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m13:46:45.873123 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m13:46:45.881652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m13:46:45.883958 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m13:46:45.925330 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m13:46:45.928060 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m13:46:46.090351 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m13:46:46.093272 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:46:46.094653 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m13:46:46.096275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:46.118711 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m13:46:46.120690 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:46:46.122666 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m13:46:46.211270 [debug] [Thread-1 (]: SQL status: SELECT 9 in 0.087 seconds
[0m13:46:46.246393 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:46:46.250173 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m13:46:46.258044 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:46:46.281585 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:46:46.283534 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m13:46:46.298182 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:46:46.412488 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:46:46.414992 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:46:46.417266 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:46:46.424471 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:46:46.459179 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m13:46:46.483314 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:46:46.485236 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m13:46:46.502785 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.016 seconds
[0m13:46:46.510917 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m13:46:46.519123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85cd6911-4d0d-499e-8688-49dc2c18636e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ceea3f22d0>]}
[0m13:46:46.524626 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 9[0m in 0.63s]
[0m13:46:46.527544 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m13:46:46.532242 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m13:46:46.534560 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m13:46:46.536688 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m13:46:46.539890 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m13:46:46.542832 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m13:46:46.551300 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m13:46:46.554026 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m13:46:46.556536 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m13:46:46.590652 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m13:46:46.599983 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m13:46:46.604075 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m13:46:46.606247 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m13:46:46.617561 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m13:46:46.629347 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m13:46:46.633367 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:46:46.635088 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m13:46:46.636943 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:46:46.638314 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:46:46.641170 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m13:46:46.642752 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:46:46.663206 [debug] [Thread-4 (]: SQL status: BEGIN in 0.026 seconds
[0m13:46:46.665153 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:46:46.667001 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m13:46:46.670559 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m13:46:46.672266 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:46:46.674078 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m13:46:46.696437 [debug] [Thread-4 (]: SQL status: SELECT 9 in 0.027 seconds
[0m13:46:46.728631 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:46:46.733518 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m13:46:46.736922 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:46:46.746778 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.071 seconds
[0m13:46:46.750682 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:46:46.764471 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:46:46.766606 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m13:46:46.768804 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m13:46:46.772278 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:46:46.774005 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:46:46.795151 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:46:46.811825 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:46:46.831033 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:46:46.828092 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:46:46.834078 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m13:46:46.837198 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:46:46.852401 [debug] [Thread-4 (]: SQL status: COMMIT in 0.019 seconds
[0m13:46:46.850554 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:46:46.863155 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:46:46.868174 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m13:46:46.870090 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:46:46.876114 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:46:46.878673 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m13:46:46.886104 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m13:46:46.896383 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.016 seconds
[0m13:46:46.895455 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m13:46:46.902237 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m13:46:46.905723 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:46:46.908883 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85cd6911-4d0d-499e-8688-49dc2c18636e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cee709bc80>]}
[0m13:46:46.910669 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m13:46:46.914643 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 9[0m in 0.36s]
[0m13:46:46.922971 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m13:46:46.932067 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.014 seconds
[0m13:46:46.938093 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m13:46:46.941983 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85cd6911-4d0d-499e-8688-49dc2c18636e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cee46589b0>]}
[0m13:46:46.944382 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.40s]
[0m13:46:46.951382 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m13:46:46.971316 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:46.977262 [debug] [MainThread]: On master: BEGIN
[0m13:46:46.983150 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:46:47.022345 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m13:46:47.024424 [debug] [MainThread]: On master: COMMIT
[0m13:46:47.025852 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:47.027531 [debug] [MainThread]: On master: COMMIT
[0m13:46:47.030244 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:46:47.032004 [debug] [MainThread]: On master: Close
[0m13:46:47.034502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:47.036622 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m13:46:47.038246 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m13:46:47.039659 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m13:46:47.041479 [info ] [MainThread]: 
[0m13:46:47.045529 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.19 seconds (2.19s).
[0m13:46:47.051340 [debug] [MainThread]: Command end result
[0m13:46:47.205641 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:46:47.212604 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:46:47.239612 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:46:47.240881 [info ] [MainThread]: 
[0m13:46:47.242546 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:46:47.245039 [info ] [MainThread]: 
[0m13:46:47.246621 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:46:47.255708 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.1979322, "process_in_blocks": "115144", "process_kernel_time": 4.729252, "process_mem_max_rss": "107252", "process_out_blocks": "3384", "process_user_time": 11.696527}
[0m13:46:47.260310 [debug] [MainThread]: Command `dbt run` succeeded at 13:46:47.259334 after 7.20 seconds
[0m13:46:47.262318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cee98ebec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cee98ebe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cee71e3ce0>]}
[0m13:46:47.264626 [debug] [MainThread]: Flushing usage events
[0m13:46:48.082083 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:00.413165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7161634f5ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7161631bd370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7161621afce0>]}


============================== 13:55:00.603766 | 53bfb0c2-bcc1-4aa1-b206-4612cf28a24a ==============================
[0m13:55:00.603766 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:55:00.617903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:55:06.730971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53bfb0c2-bcc1-4aa1-b206-4612cf28a24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7161635a71a0>]}
[0m13:55:07.660841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53bfb0c2-bcc1-4aa1-b206-4612cf28a24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x716161762e10>]}
[0m13:55:07.674551 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:55:08.674893 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:55:10.566413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:10.568741 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:10.845356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53bfb0c2-bcc1-4aa1-b206-4612cf28a24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71615fe0c050>]}
[0m13:55:11.463140 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:55:11.490702 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:55:11.758573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53bfb0c2-bcc1-4aa1-b206-4612cf28a24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71615fb34800>]}
[0m13:55:11.761611 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:55:11.770505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53bfb0c2-bcc1-4aa1-b206-4612cf28a24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71615fe419d0>]}
[0m13:55:11.788663 [info ] [MainThread]: 
[0m13:55:11.791343 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:55:11.793647 [info ] [MainThread]: 
[0m13:55:11.800709 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:55:11.843133 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:55:12.442307 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:55:12.444440 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:55:12.448265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:12.794625 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.346 seconds
[0m13:55:12.807469 [debug] [ThreadPool]: On list_db: Close
[0m13:55:12.816139 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev'
[0m13:55:12.850557 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:55:12.858491 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m13:55:12.860083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:12.900585 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m13:55:12.903380 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:55:12.905077 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:55:13.025333 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.117 seconds
[0m13:55:13.042864 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m13:55:13.045218 [debug] [ThreadPool]: On list_db_dev: Close
[0m13:55:13.096572 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:13.098886 [debug] [MainThread]: On master: BEGIN
[0m13:55:13.106959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:13.147140 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m13:55:13.151349 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:13.156977 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:55:13.333365 [debug] [MainThread]: SQL status: SELECT 0 in 0.170 seconds
[0m13:55:13.342579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53bfb0c2-bcc1-4aa1-b206-4612cf28a24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71615fc78ce0>]}
[0m13:55:13.346647 [debug] [MainThread]: On master: ROLLBACK
[0m13:55:13.354861 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:13.356811 [debug] [MainThread]: On master: BEGIN
[0m13:55:13.360703 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m13:55:13.368164 [debug] [MainThread]: On master: COMMIT
[0m13:55:13.373152 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:13.375717 [debug] [MainThread]: On master: COMMIT
[0m13:55:13.380423 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:55:13.383368 [debug] [MainThread]: On master: Close
[0m13:55:13.463157 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m13:55:13.467179 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m13:55:13.470290 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m13:55:13.473605 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m13:55:13.506116 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m13:55:13.534219 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m13:55:13.855217 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m13:55:13.879906 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:55:13.881726 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m13:55:13.883384 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:13.940376 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m13:55:13.942329 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:55:13.943762 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m13:55:14.141820 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.176 seconds
[0m13:55:14.210906 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:55:14.212546 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m13:55:14.217680 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:55:14.267162 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:55:14.268785 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m13:55:14.272817 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:55:14.443991 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:55:14.447221 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:55:14.453660 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:55:14.463572 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m13:55:14.531721 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m13:55:14.576287 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:55:14.578092 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m13:55:14.624640 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.044 seconds
[0m13:55:14.641331 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m13:55:14.674545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53bfb0c2-bcc1-4aa1-b206-4612cf28a24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7161635a6240>]}
[0m13:55:14.677435 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 10[0m in 1.17s]
[0m13:55:14.680954 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m13:55:14.686642 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m13:55:14.692373 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m13:55:14.690002 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m13:55:14.700704 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m13:55:14.695615 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m13:55:14.711543 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m13:55:14.708018 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m13:55:14.713644 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m13:55:14.750996 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m13:55:14.755155 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m13:55:14.770982 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m13:55:14.784506 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m13:55:14.818342 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m13:55:14.829428 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m13:55:14.843216 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:55:14.847995 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:55:14.852106 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m13:55:14.854647 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:55:14.850006 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m13:55:14.858870 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:55:14.910311 [debug] [Thread-4 (]: SQL status: BEGIN in 0.056 seconds
[0m13:55:14.911656 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:55:14.913121 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m13:55:14.915373 [debug] [Thread-3 (]: SQL status: BEGIN in 0.056 seconds
[0m13:55:14.918373 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:55:14.920200 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m13:55:14.963674 [debug] [Thread-4 (]: SQL status: SELECT 10 in 0.046 seconds
[0m13:55:14.975666 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:55:14.979130 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m13:55:14.982679 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:55:14.993090 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.070 seconds
[0m13:55:15.007363 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:55:15.010103 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m13:55:15.018419 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:55:15.020745 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m13:55:15.024428 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:55:15.032636 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m13:55:15.031140 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:55:15.044391 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:55:15.046790 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:55:15.056969 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:55:15.058959 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m13:55:15.062741 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m13:55:15.083689 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m13:55:15.086784 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:55:15.088083 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m13:55:15.090410 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m13:55:15.101819 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:55:15.104467 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:55:15.106789 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:55:15.116107 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m13:55:15.126401 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.023 seconds
[0m13:55:15.134526 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m13:55:15.143754 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m13:55:15.160182 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:55:15.162293 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m13:55:15.168272 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53bfb0c2-bcc1-4aa1-b206-4612cf28a24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71615ece8290>]}
[0m13:55:15.171764 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 10[0m in 0.46s]
[0m13:55:15.179305 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m13:55:15.195160 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.031 seconds
[0m13:55:15.202100 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m13:55:15.207280 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '53bfb0c2-bcc1-4aa1-b206-4612cf28a24a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71615ecd9a90>]}
[0m13:55:15.211548 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.51s]
[0m13:55:15.218788 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m13:55:15.231947 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:15.235541 [debug] [MainThread]: On master: BEGIN
[0m13:55:15.237951 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:15.263292 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m13:55:15.264872 [debug] [MainThread]: On master: COMMIT
[0m13:55:15.267967 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:15.269989 [debug] [MainThread]: On master: COMMIT
[0m13:55:15.273310 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:55:15.277081 [debug] [MainThread]: On master: Close
[0m13:55:15.291388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:15.304891 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m13:55:15.307020 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m13:55:15.308878 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m13:55:15.310646 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m13:55:15.317490 [info ] [MainThread]: 
[0m13:55:15.319880 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 3.51 seconds (3.51s).
[0m13:55:15.327296 [debug] [MainThread]: Command end result
[0m13:55:15.537478 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:55:15.556878 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:55:15.593589 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:55:15.595105 [info ] [MainThread]: 
[0m13:55:15.597074 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:15.599979 [info ] [MainThread]: 
[0m13:55:15.603385 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:55:15.625167 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 16.309387, "process_in_blocks": "122592", "process_kernel_time": 9.557191, "process_mem_max_rss": "100344", "process_out_blocks": "3408", "process_user_time": 20.781069}
[0m13:55:15.634747 [debug] [MainThread]: Command `dbt run` succeeded at 13:55:15.633929 after 16.32 seconds
[0m13:55:15.636839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71616308df40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7161617618e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71616160e720>]}
[0m13:55:15.638891 [debug] [MainThread]: Flushing usage events
[0m13:55:17.103229 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:21:02.576754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac5a792480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac5a3f9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac5a791ee0>]}


============================== 14:21:02.855854 | c6742a1f-3d6e-4649-8e81-f8e233ea0014 ==============================
[0m14:21:02.855854 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:21:02.861926 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:21:08.822833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c6742a1f-3d6e-4649-8e81-f8e233ea0014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac5a3b2150>]}
[0m14:21:10.289762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c6742a1f-3d6e-4649-8e81-f8e233ea0014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac5a1316d0>]}
[0m14:21:10.304870 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:21:12.262809 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:21:15.464762 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:21:15.467295 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:21:16.055580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c6742a1f-3d6e-4649-8e81-f8e233ea0014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac589906b0>]}
[0m14:21:17.184747 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:21:17.230846 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:21:17.638732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c6742a1f-3d6e-4649-8e81-f8e233ea0014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac586dfad0>]}
[0m14:21:17.641722 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m14:21:17.643847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6742a1f-3d6e-4649-8e81-f8e233ea0014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac5894ab70>]}
[0m14:21:17.661569 [info ] [MainThread]: 
[0m14:21:17.663663 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:21:17.666051 [info ] [MainThread]: 
[0m14:21:17.680109 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:21:17.736232 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:21:19.456480 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:21:19.461949 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:21:19.464619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:20.756250 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.291 seconds
[0m14:21:20.770432 [debug] [ThreadPool]: On list_db: Close
[0m14:21:20.793713 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m14:21:20.894244 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:21:20.902191 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m14:21:20.905667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:21:21.020717 [debug] [ThreadPool]: SQL status: BEGIN in 0.116 seconds
[0m14:21:21.022772 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:21:21.026576 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:21:21.450295 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.417 seconds
[0m14:21:21.468345 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m14:21:21.486872 [debug] [ThreadPool]: On list_db_dev: Close
[0m14:21:21.549999 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:21.552059 [debug] [MainThread]: On master: BEGIN
[0m14:21:21.553998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:21:22.165881 [debug] [MainThread]: SQL status: BEGIN in 0.599 seconds
[0m14:21:22.168687 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:22.185798 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:21:22.617801 [debug] [MainThread]: SQL status: SELECT 0 in 0.428 seconds
[0m14:21:22.626066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c6742a1f-3d6e-4649-8e81-f8e233ea0014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac58616990>]}
[0m14:21:22.630639 [debug] [MainThread]: On master: ROLLBACK
[0m14:21:22.643347 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:22.645708 [debug] [MainThread]: On master: BEGIN
[0m14:21:22.660380 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:21:22.662348 [debug] [MainThread]: On master: COMMIT
[0m14:21:22.664041 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:22.676433 [debug] [MainThread]: On master: COMMIT
[0m14:21:22.680276 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:21:22.682396 [debug] [MainThread]: On master: Close
[0m14:21:22.727973 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m14:21:22.731800 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m14:21:22.744860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m14:21:22.747404 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m14:21:22.836982 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m14:21:22.855527 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m14:21:23.219304 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m14:21:23.237509 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:21:23.239488 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m14:21:23.247775 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:23.317449 [debug] [Thread-1 (]: SQL status: BEGIN in 0.069 seconds
[0m14:21:23.320323 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:21:23.322635 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m14:21:23.849583 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.525 seconds
[0m14:21:23.910198 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:21:23.922834 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m14:21:23.929039 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:21:23.980510 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:21:23.995556 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m14:21:24.001957 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:21:24.580352 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m14:21:24.592683 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:21:24.595152 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m14:21:24.613218 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m14:21:24.780255 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m14:21:24.873746 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:21:24.877075 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m14:21:24.936893 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.057 seconds
[0m14:21:24.965658 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m14:21:24.978918 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6742a1f-3d6e-4649-8e81-f8e233ea0014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac5ace22d0>]}
[0m14:21:24.987789 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 10[0m in 2.23s]
[0m14:21:24.991755 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m14:21:25.018242 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m14:21:25.038216 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m14:21:25.069443 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m14:21:25.073872 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m14:21:25.079445 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m14:21:25.083157 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m14:21:25.097442 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m14:21:25.100258 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m14:21:25.174521 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m14:21:25.189558 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m14:21:25.199903 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m14:21:25.193809 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m14:21:25.260529 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m14:21:25.267544 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m14:21:25.273883 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:21:25.276330 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m14:21:25.278657 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:21:25.282321 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:21:25.292280 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m14:21:25.299808 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:21:25.335335 [debug] [Thread-4 (]: SQL status: BEGIN in 0.057 seconds
[0m14:21:25.344745 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:21:25.347798 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m14:21:25.403234 [debug] [Thread-4 (]: SQL status: SELECT 10 in 0.053 seconds
[0m14:21:25.427350 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:21:25.440939 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m14:21:25.443899 [debug] [Thread-3 (]: SQL status: BEGIN in 0.149 seconds
[0m14:21:25.446163 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:21:25.448250 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m14:21:25.460259 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m14:21:25.489819 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:21:25.500751 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m14:21:25.510015 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m14:21:25.525244 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:21:25.527537 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:21:25.529760 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:21:25.548430 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.071 seconds
[0m14:21:25.559706 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:21:25.561892 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m14:21:25.565779 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:21:25.580104 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:21:25.582357 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m14:21:25.586065 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:21:25.593590 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m14:21:25.596106 [debug] [Thread-4 (]: SQL status: COMMIT in 0.064 seconds
[0m14:21:25.598587 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:21:25.617563 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m14:21:25.619697 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m14:21:25.623235 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:21:25.626935 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m14:21:25.632974 [debug] [Thread-3 (]: SQL status: COMMIT in 0.007 seconds
[0m14:21:25.657388 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m14:21:25.671691 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:21:25.659911 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.025 seconds
[0m14:21:25.674207 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m14:21:25.692433 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m14:21:25.726203 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6742a1f-3d6e-4649-8e81-f8e233ea0014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac584b9ee0>]}
[0m14:21:25.740376 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.039 seconds
[0m14:21:25.789295 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m14:21:25.805779 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 10[0m in 0.62s]
[0m14:21:25.831005 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m14:21:25.853225 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c6742a1f-3d6e-4649-8e81-f8e233ea0014', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac578d68d0>]}
[0m14:21:25.866163 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.78s]
[0m14:21:25.880635 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m14:21:25.909064 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:25.912473 [debug] [MainThread]: On master: BEGIN
[0m14:21:25.926265 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:21:26.054176 [debug] [MainThread]: SQL status: BEGIN in 0.128 seconds
[0m14:21:26.063504 [debug] [MainThread]: On master: COMMIT
[0m14:21:26.064733 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:26.066946 [debug] [MainThread]: On master: COMMIT
[0m14:21:26.068880 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:21:26.070882 [debug] [MainThread]: On master: Close
[0m14:21:26.086254 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:26.088273 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m14:21:26.090430 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m14:21:26.104654 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m14:21:26.121610 [info ] [MainThread]: 
[0m14:21:26.123434 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 8.43 seconds (8.43s).
[0m14:21:26.140574 [debug] [MainThread]: Command end result
[0m14:21:26.372277 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:21:26.384502 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:21:26.431084 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:21:26.432590 [info ] [MainThread]: 
[0m14:21:26.434866 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:21:26.441142 [info ] [MainThread]: 
[0m14:21:26.443371 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:21:26.458209 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 25.051981, "process_in_blocks": "115712", "process_kernel_time": 20.118473, "process_mem_max_rss": "107140", "process_out_blocks": "3392", "process_user_time": 26.450878}
[0m14:21:26.461562 [debug] [MainThread]: Command `dbt run` succeeded at 14:21:26.460602 after 25.06 seconds
[0m14:21:26.464033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac5a7ed730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac585e4fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ac5a3b2000>]}
[0m14:21:26.475789 [debug] [MainThread]: Flushing usage events
[0m14:21:27.634768 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:27:01.435722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713549541880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7135498f7500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713549c4f0e0>]}


============================== 14:27:01.583825 | 9f1f4c97-9235-49e9-ab43-fa08580973d4 ==============================
[0m14:27:01.583825 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:27:01.591048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:27:04.810215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f1f4c97-9235-49e9-ab43-fa08580973d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713548f3b620>]}
[0m14:27:05.861681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9f1f4c97-9235-49e9-ab43-fa08580973d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71354972e180>]}
[0m14:27:05.923599 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:27:09.363133 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:27:11.668882 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:27:11.720415 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:27:12.488332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9f1f4c97-9235-49e9-ab43-fa08580973d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7135476ebfb0>]}
[0m14:27:14.208055 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:27:14.567671 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:27:15.187432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9f1f4c97-9235-49e9-ab43-fa08580973d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713547460d40>]}
[0m14:27:15.216422 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m14:27:15.219258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f1f4c97-9235-49e9-ab43-fa08580973d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71354776fdd0>]}
[0m14:27:15.256725 [info ] [MainThread]: 
[0m14:27:15.273796 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:27:15.277040 [info ] [MainThread]: 
[0m14:27:15.287157 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:27:15.375527 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:27:16.280589 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:27:16.298623 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:27:16.301870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:17.235192 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.921 seconds
[0m14:27:17.257782 [debug] [ThreadPool]: On list_db: Close
[0m14:27:17.322674 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev'
[0m14:27:17.382161 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:27:17.396201 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m14:27:17.398293 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:18.248094 [debug] [ThreadPool]: SQL status: BEGIN in 0.836 seconds
[0m14:27:18.262043 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:27:18.266448 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:27:18.321876 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.051 seconds
[0m14:27:18.332473 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m14:27:18.339684 [debug] [ThreadPool]: On list_db_dev: Close
[0m14:27:18.383335 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:18.386930 [debug] [MainThread]: On master: BEGIN
[0m14:27:18.390465 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:19.352034 [debug] [MainThread]: SQL status: BEGIN in 0.927 seconds
[0m14:27:19.393031 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:19.396249 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:27:19.540069 [debug] [MainThread]: SQL status: SELECT 0 in 0.134 seconds
[0m14:27:19.547755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9f1f4c97-9235-49e9-ab43-fa08580973d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7135475a0c50>]}
[0m14:27:19.572971 [debug] [MainThread]: On master: ROLLBACK
[0m14:27:19.580807 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:19.591519 [debug] [MainThread]: On master: BEGIN
[0m14:27:19.595448 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:27:19.611541 [debug] [MainThread]: On master: COMMIT
[0m14:27:19.623265 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:19.625323 [debug] [MainThread]: On master: COMMIT
[0m14:27:19.640458 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:27:19.643148 [debug] [MainThread]: On master: Close
[0m14:27:19.801465 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m14:27:19.820923 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m14:27:19.836011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m14:27:19.838327 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m14:27:19.946854 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m14:27:19.971092 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m14:27:20.400649 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m14:27:20.419919 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:27:20.422353 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m14:27:20.425794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:28.222819 [debug] [Thread-1 (]: SQL status: BEGIN in 8.883 seconds
[0m14:27:28.237508 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:27:28.239875 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m14:27:28.432913 [debug] [Thread-1 (]: SQL status: SELECT 11 in 0.190 seconds
[0m14:27:28.505364 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:27:28.508225 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m14:27:28.534082 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m14:27:28.551746 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:27:28.554079 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m14:27:28.558246 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:27:28.833302 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m14:27:28.835535 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:27:28.837919 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m14:27:28.854378 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m14:27:28.973819 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m14:27:29.061644 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:27:29.078730 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m14:27:29.174959 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.094 seconds
[0m14:27:29.216828 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m14:27:29.292327 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f1f4c97-9235-49e9-ab43-fa08580973d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713549ada6c0>]}
[0m14:27:29.328568 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 11[0m in 9.39s]
[0m14:27:29.339033 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m14:27:29.394917 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m14:27:29.398311 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m14:27:29.415226 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m14:27:29.418546 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m14:27:29.428455 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m14:27:29.432328 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m14:27:29.435004 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m14:27:29.446928 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m14:27:29.470936 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m14:27:29.504567 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m14:27:29.515038 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m14:27:29.538215 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m14:27:29.557425 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m14:27:29.585746 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m14:27:29.596428 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:27:29.600289 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m14:27:29.602742 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:27:29.607221 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:27:29.625269 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m14:27:29.633015 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:27:30.352949 [debug] [Thread-4 (]: SQL status: BEGIN in 0.735 seconds
[0m14:27:30.371279 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:27:30.355662 [debug] [Thread-3 (]: SQL status: BEGIN in 0.710 seconds
[0m14:27:30.375372 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m14:27:30.379393 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:27:30.383468 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m14:27:30.430763 [debug] [Thread-4 (]: SQL status: SELECT 11 in 0.049 seconds
[0m14:27:30.451969 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:27:30.455171 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m14:27:30.465063 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m14:27:30.480599 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:27:30.482808 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m14:27:30.487019 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.097 seconds
[0m14:27:30.489288 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:27:30.515234 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:27:30.530532 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:27:30.540187 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m14:27:30.550403 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:27:30.558064 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:27:30.570823 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.017 seconds
[0m14:27:30.587974 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m14:27:30.597069 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:27:30.616423 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m14:27:30.618950 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m14:27:30.623170 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:27:30.631239 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m14:27:30.634757 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m14:27:30.658503 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.025 seconds
[0m14:27:30.657417 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m14:27:30.671768 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m14:27:30.675504 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:27:30.695275 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m14:27:30.703976 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f1f4c97-9235-49e9-ab43-fa08580973d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713544517ce0>]}
[0m14:27:30.718402 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 11[0m in 1.25s]
[0m14:27:30.728107 [debug] [Thread-3 (]: SQL status: COMMIT in 0.021 seconds
[0m14:27:30.722289 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m14:27:30.775173 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m14:27:30.779385 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:27:30.781455 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m14:27:30.800063 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.016 seconds
[0m14:27:30.807682 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m14:27:30.812126 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9f1f4c97-9235-49e9-ab43-fa08580973d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7135466907d0>]}
[0m14:27:30.818364 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 1.41s]
[0m14:27:30.822533 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m14:27:30.852801 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:30.854790 [debug] [MainThread]: On master: BEGIN
[0m14:27:30.863587 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:27:31.796110 [debug] [MainThread]: SQL status: BEGIN in 0.900 seconds
[0m14:27:31.811287 [debug] [MainThread]: On master: COMMIT
[0m14:27:31.813642 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:31.815168 [debug] [MainThread]: On master: COMMIT
[0m14:27:31.819787 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m14:27:31.822377 [debug] [MainThread]: On master: Close
[0m14:27:31.831994 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:31.838337 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m14:27:31.841782 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m14:27:31.844579 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m14:27:31.846689 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m14:27:31.873963 [info ] [MainThread]: 
[0m14:27:31.876890 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 16.56 seconds (16.56s).
[0m14:27:31.889293 [debug] [MainThread]: Command end result
[0m14:27:32.106644 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:27:32.140734 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:27:32.209923 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:27:32.212132 [info ] [MainThread]: 
[0m14:27:32.214289 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:32.217341 [info ] [MainThread]: 
[0m14:27:32.222531 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:27:32.332785 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 32.967022, "process_in_blocks": "498416", "process_kernel_time": 10.057436, "process_mem_max_rss": "94836", "process_out_blocks": "3496", "process_user_time": 17.195509}
[0m14:27:32.349107 [debug] [MainThread]: Command `dbt run` succeeded at 14:27:32.347425 after 33.00 seconds
[0m14:27:32.356944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71354999bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71354743f2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713548fd3ce0>]}
[0m14:27:32.363060 [debug] [MainThread]: Flushing usage events
[0m14:27:38.207753 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:30:27.276491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794876965ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794874f3dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794874da89b0>]}


============================== 14:30:27.424713 | 7943a211-e019-4f37-926a-c7894c34df53 ==============================
[0m14:30:27.424713 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:30:27.434344 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:30:29.990814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7943a211-e019-4f37-926a-c7894c34df53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794874b96540>]}
[0m14:30:30.412992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7943a211-e019-4f37-926a-c7894c34df53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794874a99d30>]}
[0m14:30:30.466949 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:30:32.113546 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:30:34.100941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:30:34.176211 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:30:34.490924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7943a211-e019-4f37-926a-c7894c34df53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79487328cad0>]}
[0m14:30:35.106135 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:30:35.247788 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:30:35.686118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7943a211-e019-4f37-926a-c7894c34df53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7948732c9100>]}
[0m14:30:35.711470 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m14:30:35.713426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7943a211-e019-4f37-926a-c7894c34df53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79487328d640>]}
[0m14:30:35.745841 [info ] [MainThread]: 
[0m14:30:35.754589 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:30:35.756163 [info ] [MainThread]: 
[0m14:30:35.759368 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:30:35.809589 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:30:36.716895 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:30:36.747532 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:30:36.749317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:49.171674 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Temporary failure in name resolution

[0m14:31:06.170195 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:31:13.319141 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m14:31:13.336114 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m14:31:13.338208 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m14:31:13.350505 [debug] [ThreadPool]: On list_db: No close available on handle
[0m14:31:13.390596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:31:13.396387 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m14:31:13.514237 [info ] [MainThread]: 
[0m14:31:13.528537 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 37.64 seconds (37.64s).
[0m14:31:13.547067 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Temporary failure in name resolution
  
[0m14:31:13.820205 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 48.39694, "process_in_blocks": "883848", "process_kernel_time": 11.265463, "process_mem_max_rss": "91072", "process_out_blocks": "2528", "process_user_time": 13.826917}
[0m14:31:14.060726 [debug] [MainThread]: Command `dbt run` failed at 14:31:14.041303 after 48.67 seconds
[0m14:31:14.078508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794876965ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794872f959d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794872140050>]}
[0m14:31:14.084838 [debug] [MainThread]: Flushing usage events
[0m14:31:23.189954 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:33:17.038817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4fa35e90d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4fa35ea720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4fa35e88c0>]}


============================== 14:33:17.097330 | e059dea7-4cfe-4d6d-8c88-b3b11a063a05 ==============================
[0m14:33:17.097330 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:33:17.100474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:33:18.837795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e059dea7-4cfe-4d6d-8c88-b3b11a063a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4fa4f636b0>]}
[0m14:33:19.458242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e059dea7-4cfe-4d6d-8c88-b3b11a063a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4fa3cb29f0>]}
[0m14:33:19.487299 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:33:22.902813 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:33:30.534418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:33:30.624711 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:33:31.081603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e059dea7-4cfe-4d6d-8c88-b3b11a063a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4fa3be5490>]}
[0m14:33:34.912081 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:33:35.684759 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:33:41.164695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e059dea7-4cfe-4d6d-8c88-b3b11a063a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4fa16ed1c0>]}
[0m14:33:43.292000 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m14:33:42.892087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e059dea7-4cfe-4d6d-8c88-b3b11a063a05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4fa14aa090>]}
[0m14:33:42.988866 [info ] [MainThread]: 
[0m14:33:42.997216 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:33:43.004365 [info ] [MainThread]: 
[0m14:33:43.063545 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:33:43.407069 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:33:44.818137 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:33:44.843925 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:33:44.850962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:55.339679 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
could not translate host name "db" to address: Temporary failure in name resolution

[0m14:34:05.601112 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:34:05.621333 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m14:34:05.624603 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m14:34:05.630535 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m14:34:05.634545 [debug] [ThreadPool]: On list_db: No close available on handle
[0m14:34:05.644857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:34:05.647960 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m14:34:05.659829 [info ] [MainThread]: 
[0m14:34:05.671890 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 22.64 seconds (22.64s).
[0m14:34:05.683406 [error] [MainThread]: Encountered an error:
Database Error
  could not translate host name "db" to address: Temporary failure in name resolution
  
[0m14:34:05.790603 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 50.403618, "process_in_blocks": "634584", "process_kernel_time": 11.252399, "process_mem_max_rss": "90452", "process_out_blocks": "2568", "process_user_time": 13.102667}
[0m14:34:05.912077 [debug] [MainThread]: Command `dbt run` failed at 14:34:05.903506 after 50.53 seconds
[0m14:34:05.928674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4fa3b3b740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4fa148acc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4fa14a9cd0>]}
[0m14:34:05.932267 [debug] [MainThread]: Flushing usage events
[0m14:34:15.206070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:39:57.132460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ea3ab31fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ea38d9b7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ea396acd70>]}


============================== 14:39:57.253744 | e93f90a0-d8c4-4aa0-8f01-8ef1480336c0 ==============================
[0m14:39:57.253744 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:39:57.260354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:39:59.254450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e93f90a0-d8c4-4aa0-8f01-8ef1480336c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ea3aa26fc0>]}
[0m14:39:59.785986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e93f90a0-d8c4-4aa0-8f01-8ef1480336c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ea38b3c230>]}
[0m14:39:59.817655 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:40:01.259835 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:40:02.459483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:40:02.485706 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:40:02.878652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e93f90a0-d8c4-4aa0-8f01-8ef1480336c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ea37298200>]}
[0m14:40:03.871994 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:40:04.003521 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:40:04.571006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e93f90a0-d8c4-4aa0-8f01-8ef1480336c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ea39e5d340>]}
[0m14:40:04.597151 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m14:40:04.598542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e93f90a0-d8c4-4aa0-8f01-8ef1480336c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ea370242f0>]}
[0m14:40:04.629856 [info ] [MainThread]: 
[0m14:40:04.645449 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:40:04.647347 [info ] [MainThread]: 
[0m14:40:04.658282 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:40:04.810330 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:40:05.476910 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:40:05.519098 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:40:05.521386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:08.777568 [debug] [ThreadPool]: SQL status: SELECT 5 in 3.238 seconds
[0m14:40:08.803976 [debug] [ThreadPool]: On list_db: Close
[0m14:40:08.863058 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db_dev'
[0m14:40:08.902160 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:40:08.904499 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m14:40:08.909204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:11.851224 [debug] [ThreadPool]: SQL status: BEGIN in 4.170 seconds
[0m14:40:11.857333 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:40:11.858718 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:40:11.916393 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.056 seconds
[0m14:40:11.923775 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m14:40:11.925838 [debug] [ThreadPool]: On list_db_dev: Close
[0m14:40:11.958804 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:11.960589 [debug] [MainThread]: On master: BEGIN
[0m14:40:11.962161 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:40:12.685217 [debug] [MainThread]: SQL status: BEGIN in 0.704 seconds
[0m14:40:12.694343 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:12.704776 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:40:12.839289 [debug] [MainThread]: SQL status: SELECT 0 in 0.131 seconds
[0m14:40:12.849273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e93f90a0-d8c4-4aa0-8f01-8ef1480336c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ea36f94440>]}
[0m14:40:12.854317 [debug] [MainThread]: On master: ROLLBACK
[0m14:40:12.856667 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:12.860192 [debug] [MainThread]: On master: BEGIN
[0m14:40:12.863373 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:40:12.865790 [debug] [MainThread]: On master: COMMIT
[0m14:40:12.868890 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:12.870700 [debug] [MainThread]: On master: COMMIT
[0m14:40:12.872969 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:40:12.874560 [debug] [MainThread]: On master: Close
[0m14:40:12.912707 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m14:40:12.915583 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m14:40:12.917494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m14:40:12.919760 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m14:40:12.973192 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m14:40:12.987048 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m14:40:13.245936 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m14:40:13.257666 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:40:13.260132 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m14:40:13.263477 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:40:13.712272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.436 seconds
[0m14:40:13.721350 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:40:13.724661 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m14:40:13.822301 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.095 seconds
[0m14:40:13.853512 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:40:13.855592 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m14:40:13.860208 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:40:13.878126 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:40:13.881381 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m14:40:13.885368 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:40:14.014325 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m14:40:14.017093 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:40:14.023057 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m14:40:14.033465 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m14:40:14.129311 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m14:40:14.168351 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:40:14.171029 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m14:40:14.252188 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.077 seconds
[0m14:40:14.266680 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m14:40:14.373773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e93f90a0-d8c4-4aa0-8f01-8ef1480336c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ea39602690>]}
[0m14:40:14.393035 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 12[0m in 1.36s]
[0m14:40:14.397044 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m14:40:14.427314 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m14:40:14.444466 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m14:40:14.461243 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m14:40:14.456894 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m14:40:14.464986 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m14:40:14.477474 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m14:40:14.474450 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m14:40:14.493430 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m14:40:14.513435 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m14:40:14.519147 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m14:40:14.529177 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m14:40:14.544381 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m14:40:14.563934 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m14:40:14.576579 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m14:40:14.579541 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:40:14.580982 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m14:40:14.582646 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:40:14.585871 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:40:14.599049 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m14:40:14.600744 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:40:16.041166 [debug] [Thread-3 (]: SQL status: BEGIN in 1.415 seconds
[0m14:40:16.069530 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:40:16.043754 [debug] [Thread-4 (]: SQL status: BEGIN in 1.426 seconds
[0m14:40:16.073052 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m14:40:16.083326 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:40:16.106649 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m14:40:16.336702 [debug] [Thread-4 (]: SQL status: SELECT 12 in 0.225 seconds
[0m14:40:16.357276 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.261 seconds
[0m14:40:16.605793 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:40:16.624704 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m14:40:16.616003 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:40:16.636765 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m14:40:16.790311 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.078 seconds
[0m14:40:16.791777 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.141 seconds
[0m14:40:16.880630 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:40:16.905958 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m14:40:16.902944 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:40:16.935928 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m14:40:16.939098 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m14:40:16.952135 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:40:16.969950 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m14:40:16.972054 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:40:16.974358 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m14:40:16.980852 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:40:16.988524 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:40:16.991565 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:40:16.997630 [debug] [Thread-3 (]: SQL status: COMMIT in 0.015 seconds
[0m14:40:17.004905 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m14:40:17.055816 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m14:40:17.073441 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m14:40:17.111085 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:40:17.122261 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m14:40:17.117272 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:40:17.126689 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m14:40:17.230426 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.100 seconds
[0m14:40:17.254978 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.130 seconds
[0m14:40:17.259162 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m14:40:17.268097 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m14:40:17.304623 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e93f90a0-d8c4-4aa0-8f01-8ef1480336c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ea34047350>]}
[0m14:40:17.316119 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e93f90a0-d8c4-4aa0-8f01-8ef1480336c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ea361cf2f0>]}
[0m14:40:17.329470 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 2.82s]
[0m14:40:17.345030 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 12[0m in 2.82s]
[0m14:40:17.351011 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m14:40:17.361575 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m14:40:17.438543 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:17.440789 [debug] [MainThread]: On master: BEGIN
[0m14:40:17.443131 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:40:18.460536 [debug] [MainThread]: SQL status: BEGIN in 0.998 seconds
[0m14:40:18.471983 [debug] [MainThread]: On master: COMMIT
[0m14:40:18.473423 [debug] [MainThread]: Using postgres connection "master"
[0m14:40:18.477634 [debug] [MainThread]: On master: COMMIT
[0m14:40:18.489579 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m14:40:18.492401 [debug] [MainThread]: On master: Close
[0m14:40:18.502491 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:18.503936 [debug] [MainThread]: Connection 'list_db' was properly closed.
[0m14:40:18.505412 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m14:40:18.506809 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m14:40:18.508215 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m14:40:18.534804 [info ] [MainThread]: 
[0m14:40:18.540310 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 13.86 seconds (13.86s).
[0m14:40:18.546608 [debug] [MainThread]: Command end result
[0m14:40:18.747669 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:40:18.791998 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:40:18.834769 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:40:18.836287 [info ] [MainThread]: 
[0m14:40:18.841308 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:40:18.847223 [info ] [MainThread]: 
[0m14:40:18.849676 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:40:18.911224 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 23.497976, "process_in_blocks": "543872", "process_kernel_time": 6.95374, "process_mem_max_rss": "94836", "process_out_blocks": "3456", "process_user_time": 14.146167}
[0m14:40:18.924991 [debug] [MainThread]: Command `dbt run` succeeded at 14:40:18.924333 after 23.52 seconds
[0m14:40:18.937538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ea3ab31fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ea36f93e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78ea37229580>]}
[0m14:40:18.940711 [debug] [MainThread]: Flushing usage events
[0m14:40:28.444667 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:46:14.073655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abd6eebe870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abd708a8140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abd6eebf5f0>]}


============================== 14:46:14.099526 | b58868de-2d2f-4c08-b3d8-038d73a6e9d1 ==============================
[0m14:46:14.099526 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:46:14.102465 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:46:15.350756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b58868de-2d2f-4c08-b3d8-038d73a6e9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abd6ed569c0>]}
[0m14:46:16.100287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b58868de-2d2f-4c08-b3d8-038d73a6e9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abd702e0aa0>]}
[0m14:46:16.113302 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:46:17.032024 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:46:17.879206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:46:17.881921 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:46:18.239908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b58868de-2d2f-4c08-b3d8-038d73a6e9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abd6d06fda0>]}
[0m14:46:18.346805 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:46:17.575868 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:46:17.784142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b58868de-2d2f-4c08-b3d8-038d73a6e9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abd6cd88ce0>]}
[0m14:46:17.785782 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m14:46:17.787767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b58868de-2d2f-4c08-b3d8-038d73a6e9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abd708a8140>]}
[0m14:46:17.798285 [info ] [MainThread]: 
[0m14:46:17.800511 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:46:17.802440 [info ] [MainThread]: 
[0m14:46:17.811605 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:46:17.845677 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:46:18.122737 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:46:18.124321 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:46:18.125457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:46:18.320496 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.195 seconds
[0m14:46:18.329426 [debug] [ThreadPool]: On list_db: Close
[0m14:46:18.340492 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m14:46:18.373928 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:46:18.376402 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m14:46:18.378247 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:46:18.410965 [debug] [ThreadPool]: SQL status: BEGIN in 0.032 seconds
[0m14:46:18.412623 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:46:18.414437 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:46:18.564132 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.148 seconds
[0m14:46:18.570673 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m14:46:18.574581 [debug] [ThreadPool]: On list_db_dev: Close
[0m14:46:18.601752 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:18.603893 [debug] [MainThread]: On master: BEGIN
[0m14:46:18.606100 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:46:18.638067 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m14:46:18.639939 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:18.642582 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:46:18.734054 [debug] [MainThread]: SQL status: SELECT 0 in 0.089 seconds
[0m14:46:18.741661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b58868de-2d2f-4c08-b3d8-038d73a6e9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abd6cc07950>]}
[0m14:46:18.745937 [debug] [MainThread]: On master: ROLLBACK
[0m14:46:18.755810 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:18.758198 [debug] [MainThread]: On master: BEGIN
[0m14:46:18.761913 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m14:46:18.770081 [debug] [MainThread]: On master: COMMIT
[0m14:46:18.774469 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:18.777168 [debug] [MainThread]: On master: COMMIT
[0m14:46:18.784905 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m14:46:18.792345 [debug] [MainThread]: On master: Close
[0m14:46:18.831085 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m14:46:18.834352 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m14:46:18.837528 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m14:46:18.840995 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m14:46:18.896888 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m14:46:18.916566 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m14:46:19.306868 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m14:46:19.315857 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:46:19.321946 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m14:46:19.326526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:46:19.358731 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m14:46:19.360478 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:46:19.362328 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m14:46:19.475516 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.111 seconds
[0m14:46:19.520737 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:46:19.522884 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m14:46:19.527787 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:46:19.553036 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:46:19.556975 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m14:46:19.560479 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:46:19.689784 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m14:46:19.691611 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:46:19.693348 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m14:46:19.703930 [debug] [Thread-1 (]: SQL status: COMMIT in 0.009 seconds
[0m14:46:19.736491 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m14:46:19.759491 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:46:19.761332 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m14:46:19.775778 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m14:46:19.783945 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m14:46:19.792208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b58868de-2d2f-4c08-b3d8-038d73a6e9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abd6f3f6030>]}
[0m14:46:19.796125 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 12[0m in 0.95s]
[0m14:46:19.798670 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m14:46:19.803177 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m14:46:19.805104 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m14:46:19.808585 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m14:46:19.815981 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m14:46:19.814036 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m14:46:19.818597 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m14:46:19.821997 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m14:46:19.840119 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m14:46:19.856410 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m14:46:19.867921 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m14:46:19.872719 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m14:46:19.881459 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m14:46:19.906092 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m14:46:19.908959 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m14:46:19.924655 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:46:19.926156 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:46:19.928079 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m14:46:19.930177 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m14:46:19.933887 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:46:19.943254 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:46:19.972861 [debug] [Thread-3 (]: SQL status: BEGIN in 0.030 seconds
[0m14:46:19.975787 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:46:19.977994 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m14:46:19.983739 [debug] [Thread-4 (]: SQL status: BEGIN in 0.050 seconds
[0m14:46:19.985244 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:46:19.987280 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m14:46:20.028563 [debug] [Thread-4 (]: SQL status: SELECT 12 in 0.039 seconds
[0m14:46:20.056947 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.075 seconds
[0m14:46:20.054409 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:46:20.074608 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m14:46:20.079519 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:46:20.082152 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m14:46:20.084202 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:46:20.101400 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m14:46:20.106379 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:46:20.121996 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:46:20.123998 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m14:46:20.126783 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m14:46:20.130618 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:46:20.132448 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:46:20.146495 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:46:20.147734 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m14:46:20.149552 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:46:20.151747 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:46:20.153756 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:46:20.155691 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m14:46:20.162122 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m14:46:20.170076 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m14:46:20.171413 [debug] [Thread-3 (]: SQL status: COMMIT in 0.014 seconds
[0m14:46:20.173858 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:46:20.186448 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m14:46:20.183884 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m14:46:20.193106 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:46:20.195076 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m14:46:20.198158 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.009 seconds
[0m14:46:20.206147 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m14:46:20.207704 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.010 seconds
[0m14:46:20.215916 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b58868de-2d2f-4c08-b3d8-038d73a6e9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abd67f3dd90>]}
[0m14:46:20.217600 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m14:46:20.226142 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b58868de-2d2f-4c08-b3d8-038d73a6e9d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abd6c0f9e80>]}
[0m14:46:20.222378 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 12[0m in 0.39s]
[0m14:46:20.228878 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.41s]
[0m14:46:20.237572 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m14:46:20.241368 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m14:46:20.251565 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:20.258817 [debug] [MainThread]: On master: BEGIN
[0m14:46:20.260972 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:46:20.303333 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m14:46:20.305739 [debug] [MainThread]: On master: COMMIT
[0m14:46:20.315282 [debug] [MainThread]: Using postgres connection "master"
[0m14:46:20.317451 [debug] [MainThread]: On master: COMMIT
[0m14:46:20.323434 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m14:46:20.330660 [debug] [MainThread]: On master: Close
[0m14:46:20.345572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:46:20.349284 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m14:46:20.352192 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m14:46:20.354031 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m14:46:20.356574 [info ] [MainThread]: 
[0m14:46:20.358555 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.55 seconds (2.55s).
[0m14:46:20.372335 [debug] [MainThread]: Command end result
[0m14:46:20.530182 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:46:20.535736 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:46:20.559716 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:46:20.560830 [info ] [MainThread]: 
[0m14:46:20.562381 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:46:20.564511 [info ] [MainThread]: 
[0m14:46:20.566875 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:46:20.574073 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.9643316, "process_in_blocks": "116024", "process_kernel_time": 4.20186, "process_mem_max_rss": "107236", "process_out_blocks": "3392", "process_user_time": 12.565715}
[0m14:46:20.576332 [debug] [MainThread]: Command `dbt run` succeeded at 14:46:20.575904 after 7.97 seconds
[0m14:46:20.578029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abd6e930350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abd6f2340b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7abd6ed006e0>]}
[0m14:46:20.579500 [debug] [MainThread]: Flushing usage events
[0m14:46:21.343970 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:58:02.914895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747a7d5b9cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747a7dcce1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747a7dccc9b0>]}


============================== 14:58:03.001257 | 79ba525d-d5c6-4735-8352-5d83506756ef ==============================
[0m14:58:03.001257 [info ] [MainThread]: Running with dbt=1.9.0
[0m14:58:03.004240 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:58:04.704324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79ba525d-d5c6-4735-8352-5d83506756ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747a7cf3b3b0>]}
[0m14:58:05.088717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79ba525d-d5c6-4735-8352-5d83506756ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747a7d563110>]}
[0m14:58:05.092600 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:58:05.655424 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m14:58:06.432170 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:58:06.433636 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:58:06.599511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79ba525d-d5c6-4735-8352-5d83506756ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747a7b77d010>]}
[0m14:58:07.003741 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:58:07.012202 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:58:07.274420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79ba525d-d5c6-4735-8352-5d83506756ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747a7b45b290>]}
[0m14:58:07.276616 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m14:58:07.279038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79ba525d-d5c6-4735-8352-5d83506756ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747a7b477e30>]}
[0m14:58:07.287366 [info ] [MainThread]: 
[0m14:58:07.289645 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:58:07.291769 [info ] [MainThread]: 
[0m14:58:07.294544 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:58:07.338205 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m14:58:07.951969 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m14:58:07.953564 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m14:58:07.954755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:58:08.096594 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.142 seconds
[0m14:58:08.100118 [debug] [ThreadPool]: On list_db: Close
[0m14:58:08.105868 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m14:58:08.122825 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:58:08.124456 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m14:58:08.126251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:58:08.145915 [debug] [ThreadPool]: SQL status: BEGIN in 0.019 seconds
[0m14:58:08.147652 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m14:58:08.149519 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m14:58:08.220570 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.069 seconds
[0m14:58:08.227535 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m14:58:08.231153 [debug] [ThreadPool]: On list_db_dev: Close
[0m14:58:08.263229 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:08.266324 [debug] [MainThread]: On master: BEGIN
[0m14:58:08.269211 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:58:08.296843 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m14:58:08.298834 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:08.301532 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:58:08.464133 [debug] [MainThread]: SQL status: SELECT 0 in 0.160 seconds
[0m14:58:08.472324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79ba525d-d5c6-4735-8352-5d83506756ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747a7d01afc0>]}
[0m14:58:08.477411 [debug] [MainThread]: On master: ROLLBACK
[0m14:58:08.481466 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:08.485430 [debug] [MainThread]: On master: BEGIN
[0m14:58:08.489125 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:58:08.490852 [debug] [MainThread]: On master: COMMIT
[0m14:58:08.492775 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:08.494396 [debug] [MainThread]: On master: COMMIT
[0m14:58:08.497139 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:58:08.499330 [debug] [MainThread]: On master: Close
[0m14:58:08.526321 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m14:58:08.529067 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m14:58:08.531466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m14:58:08.538221 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m14:58:08.572717 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m14:58:08.575002 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m14:58:08.704117 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m14:58:08.707161 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:58:08.708641 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m14:58:08.710270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:58:08.762259 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m14:58:08.764149 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:58:08.766674 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m14:58:08.891506 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.123 seconds
[0m14:58:08.915855 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:58:08.917648 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m14:58:08.922858 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:58:08.935583 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:58:08.937654 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m14:58:08.941424 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:58:09.026237 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m14:58:09.027974 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:58:09.029742 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m14:58:09.036751 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m14:58:09.066834 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m14:58:09.089330 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m14:58:09.090869 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m14:58:09.110546 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.018 seconds
[0m14:58:09.118663 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m14:58:09.125731 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79ba525d-d5c6-4735-8352-5d83506756ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747a7b757fe0>]}
[0m14:58:09.127938 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 12[0m in 0.59s]
[0m14:58:09.131139 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m14:58:09.134579 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m14:58:09.137175 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m14:58:09.138998 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m14:58:09.146150 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m14:58:09.142335 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m14:58:09.148205 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m14:58:09.154389 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m14:58:09.176720 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m14:58:09.179626 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m14:58:09.195746 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m14:58:09.200763 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m14:58:09.216033 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m14:58:09.217720 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m14:58:09.228137 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m14:58:09.230849 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:58:09.232843 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:58:09.234593 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m14:58:09.236778 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m14:58:09.238324 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:58:09.239861 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:58:09.260942 [debug] [Thread-3 (]: SQL status: BEGIN in 0.022 seconds
[0m14:58:09.263023 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:58:09.264680 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m14:58:09.287647 [debug] [Thread-4 (]: SQL status: BEGIN in 0.047 seconds
[0m14:58:09.291019 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:58:09.292998 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m14:58:09.303342 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.037 seconds
[0m14:58:09.318242 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:58:09.321529 [debug] [Thread-4 (]: SQL status: SELECT 12 in 0.026 seconds
[0m14:58:09.323099 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m14:58:09.336751 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:58:09.339396 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m14:58:09.341879 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:58:09.350059 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m14:58:09.356264 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:58:09.367462 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:58:09.369165 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m14:58:09.370851 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m14:58:09.373870 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:58:09.375185 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:58:09.381361 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m14:58:09.386789 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:58:09.388255 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:58:09.390260 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:58:09.391818 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m14:58:09.393541 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m14:58:09.400233 [debug] [Thread-3 (]: SQL status: COMMIT in 0.005 seconds
[0m14:58:09.408841 [debug] [Thread-4 (]: SQL status: COMMIT in 0.013 seconds
[0m14:58:09.407967 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m14:58:09.418335 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m14:58:09.421134 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m14:58:09.424063 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m14:58:09.426101 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m14:58:09.427793 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m14:58:09.436942 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.007 seconds
[0m14:58:09.442851 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m14:58:09.444326 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.014 seconds
[0m14:58:09.449926 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m14:58:09.452000 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79ba525d-d5c6-4735-8352-5d83506756ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747a7a6ad400>]}
[0m14:58:09.455147 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79ba525d-d5c6-4735-8352-5d83506756ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747a7a6a8080>]}
[0m14:58:09.458583 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.31s]
[0m14:58:09.471114 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m14:58:09.463987 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 12[0m in 0.30s]
[0m14:58:09.478096 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m14:58:09.502348 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:09.514737 [debug] [MainThread]: On master: BEGIN
[0m14:58:09.519545 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:58:09.549418 [debug] [MainThread]: SQL status: BEGIN in 0.030 seconds
[0m14:58:09.551128 [debug] [MainThread]: On master: COMMIT
[0m14:58:09.552995 [debug] [MainThread]: Using postgres connection "master"
[0m14:58:09.554676 [debug] [MainThread]: On master: COMMIT
[0m14:58:09.556936 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:58:09.558663 [debug] [MainThread]: On master: Close
[0m14:58:09.561877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:58:09.565954 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m14:58:09.574106 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m14:58:09.575822 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m14:58:09.578347 [info ] [MainThread]: 
[0m14:58:09.580555 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.28 seconds (2.28s).
[0m14:58:09.598392 [debug] [MainThread]: Command end result
[0m14:58:09.807029 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m14:58:09.813173 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m14:58:09.853258 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m14:58:09.854918 [info ] [MainThread]: 
[0m14:58:09.857152 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:58:09.859304 [info ] [MainThread]: 
[0m14:58:09.865528 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:58:09.874845 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.2985754, "process_in_blocks": "116368", "process_kernel_time": 9.661579, "process_mem_max_rss": "107364", "process_out_blocks": "3392", "process_user_time": 12.234784}
[0m14:58:09.878461 [debug] [MainThread]: Command `dbt run` succeeded at 14:58:09.877627 after 7.30 seconds
[0m14:58:09.881907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747a7d940fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747a807828a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x747a7d8f9880>]}
[0m14:58:09.885774 [debug] [MainThread]: Flushing usage events
[0m14:58:10.909434 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:07:41.594257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d808c8bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d809605a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d808c8acc0>]}


============================== 15:07:41.935817 | e550fae5-08dc-4d54-b43d-92e5bce77a09 ==============================
[0m15:07:41.935817 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:07:41.938312 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:07:44.288193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e550fae5-08dc-4d54-b43d-92e5bce77a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d80a06f320>]}
[0m15:07:44.738931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e550fae5-08dc-4d54-b43d-92e5bce77a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d808aeb5c0>]}
[0m15:07:44.749052 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:07:45.898359 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:07:49.020258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:07:49.022310 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:07:49.484646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e550fae5-08dc-4d54-b43d-92e5bce77a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d8068cbcb0>]}
[0m15:07:49.784974 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:07:49.808605 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:07:49.386752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e550fae5-08dc-4d54-b43d-92e5bce77a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d8065b0560>]}
[0m15:07:49.393193 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:07:49.401944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e550fae5-08dc-4d54-b43d-92e5bce77a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d8068fc2c0>]}
[0m15:07:49.423190 [info ] [MainThread]: 
[0m15:07:49.426053 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:07:49.429250 [info ] [MainThread]: 
[0m15:07:49.434673 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:07:49.502825 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:07:50.365482 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:07:50.367569 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:07:50.369404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:50.792707 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.423 seconds
[0m15:07:50.802163 [debug] [ThreadPool]: On list_db: Close
[0m15:07:50.808400 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m15:07:50.849420 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:07:50.851041 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m15:07:50.852783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:50.914038 [debug] [ThreadPool]: SQL status: BEGIN in 0.061 seconds
[0m15:07:50.915766 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:07:50.917882 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:07:50.987128 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.068 seconds
[0m15:07:50.994565 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m15:07:50.997658 [debug] [ThreadPool]: On list_db_dev: Close
[0m15:07:51.038706 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:51.043877 [debug] [MainThread]: On master: BEGIN
[0m15:07:51.045835 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:51.072785 [debug] [MainThread]: SQL status: BEGIN in 0.027 seconds
[0m15:07:51.078026 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:51.080486 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:07:51.168730 [debug] [MainThread]: SQL status: SELECT 0 in 0.082 seconds
[0m15:07:51.185713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e550fae5-08dc-4d54-b43d-92e5bce77a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d8068b4e30>]}
[0m15:07:51.187800 [debug] [MainThread]: On master: ROLLBACK
[0m15:07:51.190553 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:51.192096 [debug] [MainThread]: On master: BEGIN
[0m15:07:51.199646 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:07:51.205088 [debug] [MainThread]: On master: COMMIT
[0m15:07:51.207956 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:51.210028 [debug] [MainThread]: On master: COMMIT
[0m15:07:51.215383 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:07:51.218310 [debug] [MainThread]: On master: Close
[0m15:07:51.243787 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m15:07:51.247535 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m15:07:51.250583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m15:07:51.253906 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m15:07:51.336835 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m15:07:51.344025 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m15:07:51.710344 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m15:07:51.713992 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:07:51.716033 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m15:07:51.718550 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:51.800975 [debug] [Thread-1 (]: SQL status: BEGIN in 0.083 seconds
[0m15:07:51.803376 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:07:51.805668 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m15:07:52.151472 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.337 seconds
[0m15:07:52.190394 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:07:52.193854 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m15:07:52.211934 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:07:52.226912 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:07:52.233767 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m15:07:52.240358 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:07:52.353332 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:07:52.355448 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:07:52.357719 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:07:52.365930 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m15:07:52.398695 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m15:07:52.417284 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:07:52.418858 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m15:07:52.448687 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.028 seconds
[0m15:07:52.456717 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m15:07:52.463978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e550fae5-08dc-4d54-b43d-92e5bce77a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d808c69f70>]}
[0m15:07:52.468450 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 12[0m in 1.21s]
[0m15:07:52.475491 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m15:07:52.482086 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m15:07:52.485694 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m15:07:52.490264 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m15:07:52.506160 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m15:07:52.502321 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m15:07:52.510710 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m15:07:52.514002 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m15:07:52.531641 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m15:07:52.561022 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m15:07:52.576472 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m15:07:52.579758 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m15:07:52.585373 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m15:07:52.623139 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m15:07:52.626641 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m15:07:52.634890 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:07:52.636799 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m15:07:52.638772 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:07:52.640076 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:07:52.641906 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m15:07:52.644229 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:07:52.689857 [debug] [Thread-4 (]: SQL status: BEGIN in 0.050 seconds
[0m15:07:52.691939 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:07:52.694679 [debug] [Thread-3 (]: SQL status: BEGIN in 0.050 seconds
[0m15:07:52.696701 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m15:07:52.698817 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:07:52.702732 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m15:07:52.753285 [debug] [Thread-4 (]: SQL status: SELECT 12 in 0.052 seconds
[0m15:07:52.776684 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:07:52.778560 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m15:07:52.791926 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.087 seconds
[0m15:07:52.794291 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:07:52.816747 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:07:52.831450 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m15:07:52.851426 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m15:07:52.843082 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:07:52.871832 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m15:07:52.870963 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:07:52.883495 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m15:07:52.885509 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m15:07:52.900806 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:07:52.902844 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:07:52.911939 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:07:52.909533 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m15:07:52.922833 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:07:52.929652 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:07:52.932538 [debug] [Thread-4 (]: SQL status: COMMIT in 0.017 seconds
[0m15:07:52.934723 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:07:52.959166 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m15:07:52.962539 [debug] [Thread-3 (]: SQL status: COMMIT in 0.009 seconds
[0m15:07:52.966093 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:07:52.988394 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m15:07:52.990680 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m15:07:52.994161 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:07:52.997116 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m15:07:53.006473 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m15:07:53.015716 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.016 seconds
[0m15:07:53.024424 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m15:07:53.022982 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m15:07:53.028863 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e550fae5-08dc-4d54-b43d-92e5bce77a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d805830500>]}
[0m15:07:53.031615 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e550fae5-08dc-4d54-b43d-92e5bce77a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d8057dd310>]}
[0m15:07:53.045577 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 12[0m in 0.52s]
[0m15:07:53.049382 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.53s]
[0m15:07:53.066720 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m15:07:53.063745 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m15:07:53.102979 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:53.104971 [debug] [MainThread]: On master: BEGIN
[0m15:07:53.106707 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:07:53.164190 [debug] [MainThread]: SQL status: BEGIN in 0.057 seconds
[0m15:07:53.167388 [debug] [MainThread]: On master: COMMIT
[0m15:07:53.170168 [debug] [MainThread]: Using postgres connection "master"
[0m15:07:53.176339 [debug] [MainThread]: On master: COMMIT
[0m15:07:53.179292 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:07:53.181165 [debug] [MainThread]: On master: Close
[0m15:07:53.183427 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:53.185013 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m15:07:53.187492 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m15:07:53.189023 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m15:07:53.196187 [info ] [MainThread]: 
[0m15:07:53.198235 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 3.76 seconds (3.76s).
[0m15:07:53.209154 [debug] [MainThread]: Command end result
[0m15:07:53.334791 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:07:53.342121 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:07:53.378363 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:07:53.379827 [info ] [MainThread]: 
[0m15:07:53.381799 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:07:53.383637 [info ] [MainThread]: 
[0m15:07:53.385435 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:07:53.396058 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.300884, "process_in_blocks": "116136", "process_kernel_time": 14.800902, "process_mem_max_rss": "107468", "process_out_blocks": "3400", "process_user_time": 15.469845}
[0m15:07:53.404670 [debug] [MainThread]: Command `dbt run` succeeded at 15:07:53.404128 after 14.31 seconds
[0m15:07:53.407522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d8086c2db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d80871a450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d808718770>]}
[0m15:07:53.419878 [debug] [MainThread]: Flushing usage events
[0m15:07:54.392075 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:11:38.725991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b67bd8ad7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b67bd8834d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b67bd6198e0>]}


============================== 15:11:38.790629 | 329804cf-5c89-433a-8e6f-f4cd5de3ddeb ==============================
[0m15:11:38.790629 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:11:38.793610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:11:39.805915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '329804cf-5c89-433a-8e6f-f4cd5de3ddeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b67bb9b0e90>]}
[0m15:11:40.325343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '329804cf-5c89-433a-8e6f-f4cd5de3ddeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b67bd263650>]}
[0m15:11:40.328030 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:11:40.999272 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:11:42.291257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:11:42.298528 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:11:42.541064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '329804cf-5c89-433a-8e6f-f4cd5de3ddeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b67bba65d90>]}
[0m15:11:43.226277 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:11:43.243888 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:11:43.402763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '329804cf-5c89-433a-8e6f-f4cd5de3ddeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b67bb758b00>]}
[0m15:11:43.404815 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:11:43.406889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '329804cf-5c89-433a-8e6f-f4cd5de3ddeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b67bb756510>]}
[0m15:11:43.423697 [info ] [MainThread]: 
[0m15:11:43.425857 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:11:43.427925 [info ] [MainThread]: 
[0m15:11:43.438213 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:11:43.482277 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:11:43.813454 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:11:43.826554 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:11:43.828114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:43.908128 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.080 seconds
[0m15:11:43.914220 [debug] [ThreadPool]: On list_db: Close
[0m15:11:43.920474 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m15:11:43.975433 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:11:43.979619 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m15:11:43.981611 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:11:44.011482 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m15:11:44.015023 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:11:44.016751 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:11:44.053129 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.034 seconds
[0m15:11:44.059029 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m15:11:44.061648 [debug] [ThreadPool]: On list_db_dev: Close
[0m15:11:44.087019 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:44.088851 [debug] [MainThread]: On master: BEGIN
[0m15:11:44.090808 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:44.115666 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m15:11:44.119000 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:44.120689 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:11:44.176164 [debug] [MainThread]: SQL status: SELECT 0 in 0.053 seconds
[0m15:11:44.183840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '329804cf-5c89-433a-8e6f-f4cd5de3ddeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b67bd23b440>]}
[0m15:11:44.189676 [debug] [MainThread]: On master: ROLLBACK
[0m15:11:44.200802 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:44.202972 [debug] [MainThread]: On master: BEGIN
[0m15:11:44.206023 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:11:44.207844 [debug] [MainThread]: On master: COMMIT
[0m15:11:44.209669 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:44.211364 [debug] [MainThread]: On master: COMMIT
[0m15:11:44.213909 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:11:44.226774 [debug] [MainThread]: On master: Close
[0m15:11:44.256278 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m15:11:44.259179 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m15:11:44.261477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m15:11:44.263364 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m15:11:44.318333 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m15:11:44.321441 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m15:11:44.544618 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m15:11:44.548033 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:11:44.550192 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m15:11:44.551897 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:44.587182 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m15:11:44.589140 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:11:44.590897 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m15:11:44.633150 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.040 seconds
[0m15:11:44.653760 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:11:44.655461 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m15:11:44.658933 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:11:44.671043 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:11:44.673039 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m15:11:44.676080 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:11:44.786128 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:11:44.788097 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:11:44.790165 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:11:44.799237 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m15:11:44.845306 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m15:11:44.883826 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:11:44.885972 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m15:11:44.898047 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.010 seconds
[0m15:11:44.909011 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m15:11:44.918231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '329804cf-5c89-433a-8e6f-f4cd5de3ddeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b67bddba5d0>]}
[0m15:11:44.922369 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 12[0m in 0.65s]
[0m15:11:44.925504 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m15:11:44.930815 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m15:11:44.943769 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m15:11:44.933017 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m15:11:44.947865 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m15:11:44.963535 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m15:11:44.960649 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m15:11:44.977349 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m15:11:44.984365 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m15:11:45.032330 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m15:11:45.061778 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m15:11:45.064807 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m15:11:45.103207 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m15:11:45.106255 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m15:11:45.131605 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m15:11:45.134203 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:11:45.136168 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m15:11:45.138247 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:11:45.139987 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:11:45.149468 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m15:11:45.152659 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:11:45.185667 [debug] [Thread-3 (]: SQL status: BEGIN in 0.033 seconds
[0m15:11:45.187575 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:11:45.189693 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m15:11:45.193736 [debug] [Thread-4 (]: SQL status: BEGIN in 0.054 seconds
[0m15:11:45.195462 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:11:45.197279 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m15:11:45.223784 [debug] [Thread-4 (]: SQL status: SELECT 12 in 0.024 seconds
[0m15:11:45.236101 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.044 seconds
[0m15:11:45.243101 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:11:45.256872 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m15:11:45.259767 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:11:45.264239 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m15:11:45.266072 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:11:45.274763 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m15:11:45.289575 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:11:45.296963 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:11:45.298751 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m15:11:45.300772 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m15:11:45.304028 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:11:45.306036 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:11:45.312656 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:11:45.319880 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:11:45.323074 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:11:45.325165 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:11:45.327527 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:11:45.329420 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:11:45.336901 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m15:11:45.346463 [debug] [Thread-3 (]: SQL status: COMMIT in 0.013 seconds
[0m15:11:45.356814 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m15:11:45.360775 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m15:11:45.363824 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:11:45.367021 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:11:45.369486 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m15:11:45.371448 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m15:11:45.381967 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m15:11:45.388266 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m15:11:45.390136 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.016 seconds
[0m15:11:45.398879 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m15:11:45.403444 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '329804cf-5c89-433a-8e6f-f4cd5de3ddeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b67a378bef0>]}
[0m15:11:45.406323 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 12[0m in 0.44s]
[0m15:11:45.410492 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m15:11:45.413617 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '329804cf-5c89-433a-8e6f-f4cd5de3ddeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b67ba9040e0>]}
[0m15:11:45.420362 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.46s]
[0m15:11:45.423299 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m15:11:45.438667 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:45.443118 [debug] [MainThread]: On master: BEGIN
[0m15:11:45.444860 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:11:45.500050 [debug] [MainThread]: SQL status: BEGIN in 0.055 seconds
[0m15:11:45.502131 [debug] [MainThread]: On master: COMMIT
[0m15:11:45.503867 [debug] [MainThread]: Using postgres connection "master"
[0m15:11:45.505477 [debug] [MainThread]: On master: COMMIT
[0m15:11:45.507505 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:11:45.509166 [debug] [MainThread]: On master: Close
[0m15:11:45.513655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:45.516146 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m15:11:45.518336 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m15:11:45.519998 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m15:11:45.522123 [info ] [MainThread]: 
[0m15:11:45.524180 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.09 seconds (2.09s).
[0m15:11:45.535275 [debug] [MainThread]: Command end result
[0m15:11:45.656314 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:11:45.669018 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:11:45.692502 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:11:45.694050 [info ] [MainThread]: 
[0m15:11:45.696505 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:11:45.700380 [info ] [MainThread]: 
[0m15:11:45.703228 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:11:45.709689 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.289286, "process_in_blocks": "0", "process_kernel_time": 4.12572, "process_mem_max_rss": "107856", "process_out_blocks": "3400", "process_user_time": 15.793388}
[0m15:11:45.712755 [debug] [MainThread]: Command `dbt run` succeeded at 15:11:45.712141 after 8.29 seconds
[0m15:11:45.715560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b67bd8800b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b67bde0dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b67bb7e5670>]}
[0m15:11:45.717714 [debug] [MainThread]: Flushing usage events
[0m15:11:46.526250 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:16:00.658886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78de0fd531a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78de10be37a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78de0ffdde20>]}


============================== 15:16:00.679432 | 00bfcf0d-3274-46a2-99b2-5ce0ec459f46 ==============================
[0m15:16:00.679432 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:16:00.681340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:16:01.792701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '00bfcf0d-3274-46a2-99b2-5ce0ec459f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78de0f753590>]}
[0m15:16:02.194935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '00bfcf0d-3274-46a2-99b2-5ce0ec459f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78de0fc3c470>]}
[0m15:16:02.207314 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:16:03.235609 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:16:04.296128 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:16:04.310065 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:16:04.843440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '00bfcf0d-3274-46a2-99b2-5ce0ec459f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78de0dfa3950>]}
[0m15:16:05.857960 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:16:05.877107 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:16:06.117855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '00bfcf0d-3274-46a2-99b2-5ce0ec459f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78de0dce7290>]}
[0m15:16:06.121632 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:16:06.125043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00bfcf0d-3274-46a2-99b2-5ce0ec459f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78de0dd21b50>]}
[0m15:16:06.145299 [info ] [MainThread]: 
[0m15:16:06.149393 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:16:06.152410 [info ] [MainThread]: 
[0m15:16:06.161109 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:16:06.199897 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:16:06.578077 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:16:06.591584 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:16:06.593361 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:06.789271 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.196 seconds
[0m15:16:06.798623 [debug] [ThreadPool]: On list_db: Close
[0m15:16:06.807786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m15:16:06.839097 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:16:06.840730 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m15:16:06.842129 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:16:06.903349 [debug] [ThreadPool]: SQL status: BEGIN in 0.061 seconds
[0m15:16:06.904977 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:16:06.907110 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:16:06.993590 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.085 seconds
[0m15:16:07.000185 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m15:16:07.002874 [debug] [ThreadPool]: On list_db_dev: Close
[0m15:16:07.045176 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:07.047127 [debug] [MainThread]: On master: BEGIN
[0m15:16:07.048886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:16:07.097518 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m15:16:07.099283 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:07.100933 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:16:07.196456 [debug] [MainThread]: SQL status: SELECT 0 in 0.094 seconds
[0m15:16:07.211971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '00bfcf0d-3274-46a2-99b2-5ce0ec459f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78de0fdbbce0>]}
[0m15:16:07.215707 [debug] [MainThread]: On master: ROLLBACK
[0m15:16:07.229219 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:07.231955 [debug] [MainThread]: On master: BEGIN
[0m15:16:07.236655 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m15:16:07.239009 [debug] [MainThread]: On master: COMMIT
[0m15:16:07.241141 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:07.255013 [debug] [MainThread]: On master: COMMIT
[0m15:16:07.258946 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:16:07.271819 [debug] [MainThread]: On master: Close
[0m15:16:07.297977 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m15:16:07.312732 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m15:16:07.315713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m15:16:07.328646 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m15:16:07.393754 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m15:16:07.397047 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m15:16:07.574345 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m15:16:07.578704 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:16:07.582436 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m15:16:07.591387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:16:07.620890 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m15:16:07.624368 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:16:07.625672 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m15:16:07.667558 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.040 seconds
[0m15:16:07.697781 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:16:07.703825 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m15:16:07.708602 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:16:07.727806 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:16:07.729551 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m15:16:07.732551 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:16:07.878001 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:16:07.881137 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:16:07.884811 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:16:07.895400 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m15:16:07.974039 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m15:16:08.049382 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:16:08.051758 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m15:16:08.078247 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.016 seconds
[0m15:16:08.096106 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m15:16:08.106910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00bfcf0d-3274-46a2-99b2-5ce0ec459f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78de102f28a0>]}
[0m15:16:08.120768 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 12[0m in 0.79s]
[0m15:16:08.125652 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m15:16:08.138408 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m15:16:08.143502 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m15:16:08.146048 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m15:16:08.151815 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m15:16:08.160746 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m15:16:08.175699 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m15:16:08.186243 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m15:16:08.194852 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m15:16:08.211193 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m15:16:08.229191 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m15:16:08.249895 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m15:16:08.252394 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m15:16:08.307539 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m15:16:08.309378 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m15:16:08.320041 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:16:08.322234 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m15:16:08.313613 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:16:08.328194 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:16:08.330549 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m15:16:08.334156 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:16:08.380022 [debug] [Thread-3 (]: SQL status: BEGIN in 0.052 seconds
[0m15:16:08.381853 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:16:08.384306 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m15:16:08.396325 [debug] [Thread-4 (]: SQL status: BEGIN in 0.062 seconds
[0m15:16:08.398649 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:16:08.413459 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m15:16:08.473044 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.086 seconds
[0m15:16:08.496250 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:16:08.502045 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m15:16:08.504980 [debug] [Thread-4 (]: SQL status: SELECT 12 in 0.088 seconds
[0m15:16:08.521924 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m15:16:08.539226 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:16:08.547282 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m15:16:08.566218 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:16:08.569582 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m15:16:08.572323 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m15:16:08.589122 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m15:16:08.604420 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:16:08.633605 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m15:16:08.639981 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:16:08.626096 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:16:08.653903 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:16:08.657721 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:16:08.661005 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:16:08.664280 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:16:08.668266 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:16:08.683579 [debug] [Thread-3 (]: SQL status: COMMIT in 0.008 seconds
[0m15:16:08.695415 [debug] [Thread-4 (]: SQL status: COMMIT in 0.019 seconds
[0m15:16:08.705939 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m15:16:08.727081 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:16:08.741380 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m15:16:08.743218 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m15:16:08.748086 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:16:08.749929 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m15:16:08.755500 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.010 seconds
[0m15:16:08.764456 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m15:16:08.767190 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.015 seconds
[0m15:16:08.778053 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00bfcf0d-3274-46a2-99b2-5ce0ec459f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78de0ce0d2e0>]}
[0m15:16:08.775762 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m15:16:08.780853 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.62s]
[0m15:16:08.785637 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m15:16:08.788141 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '00bfcf0d-3274-46a2-99b2-5ce0ec459f46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78de0ce39820>]}
[0m15:16:08.792288 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 12[0m in 0.63s]
[0m15:16:08.797216 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m15:16:08.811352 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:08.814152 [debug] [MainThread]: On master: BEGIN
[0m15:16:08.820848 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:16:08.855923 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m15:16:08.858646 [debug] [MainThread]: On master: COMMIT
[0m15:16:08.860902 [debug] [MainThread]: Using postgres connection "master"
[0m15:16:08.863424 [debug] [MainThread]: On master: COMMIT
[0m15:16:08.874669 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m15:16:08.876934 [debug] [MainThread]: On master: Close
[0m15:16:08.880103 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:16:08.881765 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m15:16:08.883388 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m15:16:08.892197 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m15:16:08.897189 [info ] [MainThread]: 
[0m15:16:08.900221 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.74 seconds (2.74s).
[0m15:16:08.919352 [debug] [MainThread]: Command end result
[0m15:16:09.205276 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:16:09.215013 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:16:09.244330 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:16:09.245955 [info ] [MainThread]: 
[0m15:16:09.248364 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:16:09.252987 [info ] [MainThread]: 
[0m15:16:09.263075 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:16:09.283901 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.968209, "process_in_blocks": "0", "process_kernel_time": 2.730191, "process_mem_max_rss": "107756", "process_out_blocks": "3392", "process_user_time": 12.294183}
[0m15:16:09.287963 [debug] [MainThread]: Command `dbt run` succeeded at 15:16:09.287016 after 8.98 seconds
[0m15:16:09.291318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78de104b4bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78de10311100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78de103107a0>]}
[0m15:16:09.294726 [debug] [MainThread]: Flushing usage events
[0m15:16:10.099505 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:27:54.138650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1091072750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1090cdcfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1091071a90>]}


============================== 15:27:54.196830 | 5a86a5bd-d98e-4bb6-8148-dcd4e3a3e13d ==============================
[0m15:27:54.196830 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:27:54.202416 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:27:56.419466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5a86a5bd-d98e-4bb6-8148-dcd4e3a3e13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1090b5d460>]}
[0m15:27:57.011614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5a86a5bd-d98e-4bb6-8148-dcd4e3a3e13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1090e4e780>]}
[0m15:27:57.015933 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:27:57.509372 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:27:58.194166 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:27:58.195745 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:27:58.403747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5a86a5bd-d98e-4bb6-8148-dcd4e3a3e13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a108f260e00>]}
[0m15:27:58.720302 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:27:58.731936 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:27:58.886812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5a86a5bd-d98e-4bb6-8148-dcd4e3a3e13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a108ef79cd0>]}
[0m15:27:58.888290 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:27:58.890054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a86a5bd-d98e-4bb6-8148-dcd4e3a3e13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a108efbe660>]}
[0m15:27:58.896874 [info ] [MainThread]: 
[0m15:27:58.898509 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:27:58.900234 [info ] [MainThread]: 
[0m15:27:58.902506 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:27:58.924553 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:27:59.279981 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:27:59.281394 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:27:59.282664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:27:59.510918 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.228 seconds
[0m15:27:59.515358 [debug] [ThreadPool]: On list_db: Close
[0m15:27:59.521126 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m15:27:59.546381 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:27:59.548529 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m15:27:59.550666 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:27:59.585197 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m15:27:59.586864 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:27:59.599422 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:27:59.691501 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.090 seconds
[0m15:27:59.696050 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m15:27:59.699159 [debug] [ThreadPool]: On list_db_dev: Close
[0m15:27:59.722187 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:59.723636 [debug] [MainThread]: On master: BEGIN
[0m15:27:59.725034 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:27:59.751032 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m15:27:59.752845 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:59.754426 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:27:59.851624 [debug] [MainThread]: SQL status: SELECT 0 in 0.096 seconds
[0m15:27:59.860498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5a86a5bd-d98e-4bb6-8148-dcd4e3a3e13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1091e0ea80>]}
[0m15:27:59.862592 [debug] [MainThread]: On master: ROLLBACK
[0m15:27:59.865427 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:59.866830 [debug] [MainThread]: On master: BEGIN
[0m15:27:59.869509 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:27:59.873522 [debug] [MainThread]: On master: COMMIT
[0m15:27:59.875055 [debug] [MainThread]: Using postgres connection "master"
[0m15:27:59.877085 [debug] [MainThread]: On master: COMMIT
[0m15:27:59.880771 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:27:59.882369 [debug] [MainThread]: On master: Close
[0m15:27:59.900647 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m15:27:59.903366 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m15:27:59.906733 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m15:27:59.908566 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m15:27:59.941419 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m15:27:59.945314 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m15:28:00.104543 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m15:28:00.109604 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:28:00.111974 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m15:28:00.114169 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:28:00.144175 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m15:28:00.149195 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:28:00.151335 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m15:28:00.299819 [debug] [Thread-1 (]: SQL status: SELECT 12 in 0.146 seconds
[0m15:28:00.343578 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:28:00.345722 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m15:28:00.353060 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m15:28:00.383048 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:28:00.385306 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m15:28:00.388731 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:28:00.503567 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:28:00.505486 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:28:00.507214 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:28:00.515633 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m15:28:00.560221 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m15:28:00.593142 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:28:00.594938 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m15:28:00.622103 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.025 seconds
[0m15:28:00.634729 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m15:28:00.647093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a86a5bd-d98e-4bb6-8148-dcd4e3a3e13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a10929ca7e0>]}
[0m15:28:00.649719 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 12[0m in 0.73s]
[0m15:28:00.653076 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m15:28:00.659345 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m15:28:00.661528 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m15:28:00.664187 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m15:28:00.667531 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m15:28:00.670460 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m15:28:00.673051 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m15:28:00.687564 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m15:28:00.692597 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m15:28:00.710674 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m15:28:00.729328 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m15:28:00.732948 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m15:28:00.750376 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m15:28:00.758838 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m15:28:00.776233 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m15:28:00.781336 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:28:00.783494 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:28:00.785100 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m15:28:00.787449 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m15:28:00.789326 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:28:00.791252 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:28:00.814600 [debug] [Thread-4 (]: SQL status: BEGIN in 0.023 seconds
[0m15:28:00.816235 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:28:00.817765 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m15:28:00.821687 [debug] [Thread-3 (]: SQL status: BEGIN in 0.032 seconds
[0m15:28:00.823526 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:28:00.826821 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m15:28:00.843026 [debug] [Thread-4 (]: SQL status: SELECT 12 in 0.023 seconds
[0m15:28:00.870720 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:28:00.875313 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m15:28:00.878581 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:28:00.890532 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.061 seconds
[0m15:28:00.893236 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:28:00.902177 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:28:00.903832 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m15:28:00.905430 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m15:28:00.908522 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:28:00.910194 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:28:00.915415 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:28:00.926284 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:28:00.927642 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:28:00.928907 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m15:28:00.930462 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:28:00.933242 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:28:00.938729 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:28:00.940355 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m15:28:00.941655 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:28:00.949662 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m15:28:00.951133 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:28:00.952878 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:28:00.954446 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m15:28:00.958619 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m15:28:00.965052 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m15:28:00.966438 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.010 seconds
[0m15:28:00.968394 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:28:00.973257 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m15:28:00.974824 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m15:28:00.977465 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a86a5bd-d98e-4bb6-8148-dcd4e3a3e13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a108e0ddbe0>]}
[0m15:28:00.979597 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 12[0m in 0.30s]
[0m15:28:00.983255 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m15:28:00.984685 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.008 seconds
[0m15:28:00.991130 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m15:28:00.994733 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5a86a5bd-d98e-4bb6-8148-dcd4e3a3e13d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1076f3fd40>]}
[0m15:28:00.996563 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.32s]
[0m15:28:00.999060 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m15:28:01.006309 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:01.009300 [debug] [MainThread]: On master: BEGIN
[0m15:28:01.012656 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:28:01.040718 [debug] [MainThread]: SQL status: BEGIN in 0.028 seconds
[0m15:28:01.043031 [debug] [MainThread]: On master: COMMIT
[0m15:28:01.044444 [debug] [MainThread]: Using postgres connection "master"
[0m15:28:01.045665 [debug] [MainThread]: On master: COMMIT
[0m15:28:01.047914 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:28:01.049502 [debug] [MainThread]: On master: Close
[0m15:28:01.052700 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:01.055221 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m15:28:01.056518 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m15:28:01.057799 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m15:28:01.060259 [info ] [MainThread]: 
[0m15:28:01.062516 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.16 seconds (2.16s).
[0m15:28:01.069079 [debug] [MainThread]: Command end result
[0m15:28:01.178984 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:28:01.185807 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:28:01.223091 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:28:01.224808 [info ] [MainThread]: 
[0m15:28:01.229860 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:28:01.234551 [info ] [MainThread]: 
[0m15:28:01.236542 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:28:01.243975 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.301913, "process_in_blocks": "63488", "process_kernel_time": 5.976059, "process_mem_max_rss": "107332", "process_out_blocks": "3400", "process_user_time": 12.25889}
[0m15:28:01.253123 [debug] [MainThread]: Command `dbt run` succeeded at 15:28:01.252100 after 7.31 seconds
[0m15:28:01.255712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1090cdcfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a108eef6990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a10910719a0>]}
[0m15:28:01.258263 [debug] [MainThread]: Flushing usage events
[0m15:28:02.065766 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:41:01.081210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6dd9c3d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6dd9a466c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ddb374b00>]}


============================== 15:41:01.106317 | 277a2e62-7421-477d-a9ef-54dd16f42eab ==============================
[0m15:41:01.106317 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:41:01.108614 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:41:02.260444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '277a2e62-7421-477d-a9ef-54dd16f42eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6dd971a690>]}
[0m15:41:02.646308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '277a2e62-7421-477d-a9ef-54dd16f42eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6dd9dafef0>]}
[0m15:41:02.660080 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:41:03.132378 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:41:03.707921 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:41:03.709618 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:41:04.002397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '277a2e62-7421-477d-a9ef-54dd16f42eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6dd9a81e50>]}
[0m15:41:04.540673 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:41:04.551627 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:41:04.735098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '277a2e62-7421-477d-a9ef-54dd16f42eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6dd9640d10>]}
[0m15:41:04.736977 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:41:04.738842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '277a2e62-7421-477d-a9ef-54dd16f42eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6dd7e1c7d0>]}
[0m15:41:04.746475 [info ] [MainThread]: 
[0m15:41:04.748180 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:41:04.759786 [info ] [MainThread]: 
[0m15:41:04.762766 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:41:04.802471 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:41:05.391713 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:41:05.394320 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:41:05.395687 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:05.619185 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.223 seconds
[0m15:41:05.623349 [debug] [ThreadPool]: On list_db: Close
[0m15:41:05.629388 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m15:41:05.650427 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:41:05.651839 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m15:41:05.652935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:41:05.680612 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m15:41:05.682193 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:41:05.683732 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:41:05.757799 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.069 seconds
[0m15:41:05.764342 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m15:41:05.766800 [debug] [ThreadPool]: On list_db_dev: Close
[0m15:41:05.808721 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:05.811133 [debug] [MainThread]: On master: BEGIN
[0m15:41:05.815128 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:41:05.885355 [debug] [MainThread]: SQL status: BEGIN in 0.072 seconds
[0m15:41:05.887168 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:05.889017 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:41:05.985510 [debug] [MainThread]: SQL status: SELECT 0 in 0.093 seconds
[0m15:41:05.991158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '277a2e62-7421-477d-a9ef-54dd16f42eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6dd9a81dc0>]}
[0m15:41:05.993215 [debug] [MainThread]: On master: ROLLBACK
[0m15:41:05.995715 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:05.998744 [debug] [MainThread]: On master: BEGIN
[0m15:41:06.001857 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:41:06.003489 [debug] [MainThread]: On master: COMMIT
[0m15:41:06.005105 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:06.006916 [debug] [MainThread]: On master: COMMIT
[0m15:41:06.009078 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:41:06.010829 [debug] [MainThread]: On master: Close
[0m15:41:06.026788 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m15:41:06.029671 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m15:41:06.034898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m15:41:06.038846 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m15:41:06.069998 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m15:41:06.079239 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m15:41:06.355938 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m15:41:06.370025 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:41:06.372323 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m15:41:06.375974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:41:06.411092 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m15:41:06.419139 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:41:06.421562 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m15:41:06.778116 [debug] [Thread-1 (]: SQL status: SELECT 13 in 0.354 seconds
[0m15:41:06.815375 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:41:06.818693 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m15:41:06.826075 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m15:41:06.848468 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:41:06.858478 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m15:41:06.861304 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:41:06.986849 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:41:06.988378 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:41:06.990083 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:41:06.998546 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m15:41:07.036768 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m15:41:07.077558 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:41:07.080042 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m15:41:07.099422 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.017 seconds
[0m15:41:07.108718 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m15:41:07.131990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '277a2e62-7421-477d-a9ef-54dd16f42eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6ddb59a390>]}
[0m15:41:07.137979 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 13[0m in 1.08s]
[0m15:41:07.140804 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m15:41:07.145472 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m15:41:07.147606 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m15:41:07.150505 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m15:41:07.156143 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m15:41:07.153270 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m15:41:07.159391 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m15:41:07.161585 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m15:41:07.183860 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m15:41:07.195889 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m15:41:07.213988 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m15:41:07.224585 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m15:41:07.227785 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m15:41:07.255767 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m15:41:07.260582 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m15:41:07.269895 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:41:07.272188 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:41:07.274098 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m15:41:07.276231 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m15:41:07.278099 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:41:07.280133 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:41:07.306482 [debug] [Thread-4 (]: SQL status: BEGIN in 0.028 seconds
[0m15:41:07.308047 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:41:07.310014 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m15:41:07.325219 [debug] [Thread-3 (]: SQL status: BEGIN in 0.045 seconds
[0m15:41:07.326991 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:41:07.332877 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m15:41:07.363805 [debug] [Thread-4 (]: SQL status: SELECT 13 in 0.050 seconds
[0m15:41:07.380834 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:41:07.382603 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m15:41:07.393195 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m15:41:07.415950 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:41:07.418093 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m15:41:07.421717 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:41:07.432943 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.098 seconds
[0m15:41:07.430964 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:41:07.446831 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:41:07.445601 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:41:07.450011 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:41:07.452646 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m15:41:07.457618 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:41:07.466001 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m15:41:07.472399 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:41:07.482129 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m15:41:07.484168 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m15:41:07.490578 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:41:07.493746 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m15:41:07.495600 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:41:07.507588 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:41:07.509346 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.012 seconds
[0m15:41:07.511445 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:41:07.520092 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:41:07.523602 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m15:41:07.527635 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '277a2e62-7421-477d-a9ef-54dd16f42eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6dd6cb0e60>]}
[0m15:41:07.530195 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 13[0m in 0.37s]
[0m15:41:07.532679 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m15:41:07.546915 [debug] [Thread-3 (]: SQL status: COMMIT in 0.022 seconds
[0m15:41:07.560046 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m15:41:07.567167 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:41:07.569455 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m15:41:07.579600 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.009 seconds
[0m15:41:07.588801 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m15:41:07.597568 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '277a2e62-7421-477d-a9ef-54dd16f42eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6dd6cc0c50>]}
[0m15:41:07.599972 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.44s]
[0m15:41:07.603101 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m15:41:07.610906 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:07.612624 [debug] [MainThread]: On master: BEGIN
[0m15:41:07.614648 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:41:07.659837 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m15:41:07.661216 [debug] [MainThread]: On master: COMMIT
[0m15:41:07.662603 [debug] [MainThread]: Using postgres connection "master"
[0m15:41:07.664226 [debug] [MainThread]: On master: COMMIT
[0m15:41:07.666714 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:41:07.670329 [debug] [MainThread]: On master: Close
[0m15:41:07.672624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:07.674475 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m15:41:07.675705 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m15:41:07.677087 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m15:41:07.679178 [info ] [MainThread]: 
[0m15:41:07.681118 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.92 seconds (2.92s).
[0m15:41:07.693861 [debug] [MainThread]: Command end result
[0m15:41:07.829713 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:41:07.848145 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:41:07.901514 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:41:07.904623 [info ] [MainThread]: 
[0m15:41:07.906998 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:41:07.908928 [info ] [MainThread]: 
[0m15:41:07.910935 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:41:07.927814 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.103283, "process_in_blocks": "113928", "process_kernel_time": 5.35632, "process_mem_max_rss": "107396", "process_out_blocks": "3392", "process_user_time": 10.378362}
[0m15:41:07.930358 [debug] [MainThread]: Command `dbt run` succeeded at 15:41:07.929825 after 7.11 seconds
[0m15:41:07.932342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6dd9f22960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6dd7af3530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a6dd9e460f0>]}
[0m15:41:07.934118 [debug] [MainThread]: Flushing usage events
[0m15:41:08.887001 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:56:43.866640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7527c32ef830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7527c4a383e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7527c4b5a7e0>]}


============================== 15:56:43.902546 | ec90e36c-9759-4bf8-95dd-fa1666531471 ==============================
[0m15:56:43.902546 [info ] [MainThread]: Running with dbt=1.9.0
[0m15:56:43.905888 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:56:45.012157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec90e36c-9759-4bf8-95dd-fa1666531471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7527c49a30b0>]}
[0m15:56:45.246083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec90e36c-9759-4bf8-95dd-fa1666531471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7527c2a13950>]}
[0m15:56:45.249176 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:56:45.707737 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m15:56:46.321720 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:56:46.324114 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:56:46.593292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec90e36c-9759-4bf8-95dd-fa1666531471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7527c12510d0>]}
[0m15:56:46.904466 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:56:46.912767 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:56:47.030291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec90e36c-9759-4bf8-95dd-fa1666531471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7527c1250d40>]}
[0m15:56:47.031762 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m15:56:47.033032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec90e36c-9759-4bf8-95dd-fa1666531471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7527c122a7b0>]}
[0m15:56:47.038634 [info ] [MainThread]: 
[0m15:56:47.040158 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:56:47.041913 [info ] [MainThread]: 
[0m15:56:47.050129 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:56:47.072117 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m15:56:47.325202 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m15:56:47.326281 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m15:56:47.327274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:47.472002 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.144 seconds
[0m15:56:47.478386 [debug] [ThreadPool]: On list_db: Close
[0m15:56:47.484741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m15:56:47.504785 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:56:47.506182 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m15:56:47.507324 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:47.535404 [debug] [ThreadPool]: SQL status: BEGIN in 0.028 seconds
[0m15:56:47.537109 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m15:56:47.538645 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m15:56:47.589986 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.050 seconds
[0m15:56:47.594653 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m15:56:47.596849 [debug] [ThreadPool]: On list_db_dev: Close
[0m15:56:47.623001 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:47.629547 [debug] [MainThread]: On master: BEGIN
[0m15:56:47.633653 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:56:47.674465 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m15:56:47.676383 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:47.678185 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:56:47.742548 [debug] [MainThread]: SQL status: SELECT 0 in 0.055 seconds
[0m15:56:47.747250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec90e36c-9759-4bf8-95dd-fa1666531471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7527c0f1c800>]}
[0m15:56:47.748946 [debug] [MainThread]: On master: ROLLBACK
[0m15:56:47.751457 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:47.752967 [debug] [MainThread]: On master: BEGIN
[0m15:56:47.756382 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m15:56:47.757997 [debug] [MainThread]: On master: COMMIT
[0m15:56:47.759720 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:47.760941 [debug] [MainThread]: On master: COMMIT
[0m15:56:47.763102 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:56:47.764376 [debug] [MainThread]: On master: Close
[0m15:56:47.777873 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m15:56:47.780050 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m15:56:47.781698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m15:56:47.783367 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m15:56:47.814898 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m15:56:47.822149 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m15:56:47.962787 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m15:56:47.968222 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:56:47.969611 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m15:56:47.970818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:47.990304 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m15:56:47.991702 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:56:47.992976 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m15:56:48.047439 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.053 seconds
[0m15:56:48.064633 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:56:48.066158 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m15:56:48.068553 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:56:48.075759 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:56:48.076787 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m15:56:48.079012 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:56:48.150003 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:56:48.151755 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:56:48.153401 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m15:56:48.159875 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m15:56:48.199057 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m15:56:48.220331 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m15:56:48.221848 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m15:56:48.237548 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m15:56:48.245256 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m15:56:48.252428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec90e36c-9759-4bf8-95dd-fa1666531471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7527c3596750>]}
[0m15:56:48.254617 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 15[0m in 0.47s]
[0m15:56:48.257559 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m15:56:48.261256 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m15:56:48.263274 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m15:56:48.264983 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m15:56:48.272113 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m15:56:48.278490 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m15:56:48.280537 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m15:56:48.275495 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m15:56:48.293414 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m15:56:48.295415 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m15:56:48.306999 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m15:56:48.308952 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m15:56:48.321604 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m15:56:48.323239 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m15:56:48.332838 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m15:56:48.334734 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:56:48.336050 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m15:56:48.337364 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:56:48.338836 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:56:48.340515 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m15:56:48.342463 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:56:48.359852 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m15:56:48.361801 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:56:48.363521 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m15:56:48.366691 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m15:56:48.368632 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:56:48.370280 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m15:56:48.384462 [debug] [Thread-4 (]: SQL status: SELECT 15 in 0.019 seconds
[0m15:56:48.393603 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:56:48.395084 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m15:56:48.397348 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:56:48.405487 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.033 seconds
[0m15:56:48.409767 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:56:48.417999 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:56:48.419310 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m15:56:48.420632 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m15:56:48.423028 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:56:48.424151 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:56:48.428546 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:56:48.436690 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:56:48.437904 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:56:48.439221 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m15:56:48.440478 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m15:56:48.443223 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:56:48.447540 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:56:48.448706 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m15:56:48.449848 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:56:48.458492 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m15:56:48.460325 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m15:56:48.462759 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m15:56:48.465002 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m15:56:48.468917 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m15:56:48.479514 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.013 seconds
[0m15:56:48.478078 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m15:56:48.484811 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m15:56:48.487117 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m15:56:48.488879 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m15:56:48.491170 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec90e36c-9759-4bf8-95dd-fa1666531471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7527b8f6ea80>]}
[0m15:56:48.494122 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 15[0m in 0.21s]
[0m15:56:48.500695 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m15:56:48.503256 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.010 seconds
[0m15:56:48.509007 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m15:56:48.538849 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec90e36c-9759-4bf8-95dd-fa1666531471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7527c0096120>]}
[0m15:56:48.541597 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.25s]
[0m15:56:48.545020 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m15:56:48.552050 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:48.553995 [debug] [MainThread]: On master: BEGIN
[0m15:56:48.556190 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:56:48.576385 [debug] [MainThread]: SQL status: BEGIN in 0.020 seconds
[0m15:56:48.578160 [debug] [MainThread]: On master: COMMIT
[0m15:56:48.579769 [debug] [MainThread]: Using postgres connection "master"
[0m15:56:48.581334 [debug] [MainThread]: On master: COMMIT
[0m15:56:48.584165 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:56:48.585698 [debug] [MainThread]: On master: Close
[0m15:56:48.588349 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:48.589808 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m15:56:48.591515 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m15:56:48.593081 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m15:56:48.596240 [info ] [MainThread]: 
[0m15:56:48.600303 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.55 seconds (1.55s).
[0m15:56:48.606030 [debug] [MainThread]: Command end result
[0m15:56:48.716982 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m15:56:48.723383 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m15:56:48.754382 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m15:56:48.755944 [info ] [MainThread]: 
[0m15:56:48.757728 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:56:48.759268 [info ] [MainThread]: 
[0m15:56:48.761020 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m15:56:48.766720 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.126778, "process_in_blocks": "116496", "process_kernel_time": 4.642788, "process_mem_max_rss": "107328", "process_out_blocks": "3392", "process_user_time": 10.130791}
[0m15:56:48.769439 [debug] [MainThread]: Command `dbt run` succeeded at 15:56:48.768746 after 5.13 seconds
[0m15:56:48.772496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7527c341bb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7527c2ccd010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7527c3640da0>]}
[0m15:56:48.774219 [debug] [MainThread]: Flushing usage events
[0m15:56:49.536382 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:04:12.978316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73365eff1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73365d37ca70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73365db27140>]}


============================== 16:04:13.004961 | cd18930f-acea-4130-abee-62b4d70bfcae ==============================
[0m16:04:13.004961 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:04:13.007058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:04:14.309735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd18930f-acea-4130-abee-62b4d70bfcae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73365f0af4d0>]}
[0m16:04:14.674224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd18930f-acea-4130-abee-62b4d70bfcae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73365e6ce840>]}
[0m16:04:14.679292 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:04:15.160678 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m16:04:15.742055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:04:15.743610 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:04:15.901081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd18930f-acea-4130-abee-62b4d70bfcae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73365d131f10>]}
[0m16:04:16.503080 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:04:16.516761 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:04:16.699311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd18930f-acea-4130-abee-62b4d70bfcae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73365b671940>]}
[0m16:04:16.705284 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m16:04:16.710315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd18930f-acea-4130-abee-62b4d70bfcae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73365d17bb60>]}
[0m16:04:16.726377 [info ] [MainThread]: 
[0m16:04:16.729314 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:04:16.731269 [info ] [MainThread]: 
[0m16:04:16.734328 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:04:16.778492 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:04:17.141052 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:04:17.142628 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:04:17.144319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:17.373634 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.229 seconds
[0m16:04:17.388330 [debug] [ThreadPool]: On list_db: Close
[0m16:04:17.395179 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m16:04:17.443875 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:04:17.445745 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m16:04:17.447295 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:17.514590 [debug] [ThreadPool]: SQL status: BEGIN in 0.067 seconds
[0m16:04:17.516555 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:04:17.517964 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:04:17.598758 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.079 seconds
[0m16:04:17.603870 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m16:04:17.606893 [debug] [ThreadPool]: On list_db_dev: Close
[0m16:04:17.630715 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:17.631896 [debug] [MainThread]: On master: BEGIN
[0m16:04:17.633250 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:04:17.658745 [debug] [MainThread]: SQL status: BEGIN in 0.025 seconds
[0m16:04:17.660552 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:17.662813 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:04:17.767671 [debug] [MainThread]: SQL status: SELECT 0 in 0.103 seconds
[0m16:04:17.775414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd18930f-acea-4130-abee-62b4d70bfcae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73365e4dec90>]}
[0m16:04:17.778302 [debug] [MainThread]: On master: ROLLBACK
[0m16:04:17.781649 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:17.784287 [debug] [MainThread]: On master: BEGIN
[0m16:04:17.787840 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:04:17.789261 [debug] [MainThread]: On master: COMMIT
[0m16:04:17.790720 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:17.793539 [debug] [MainThread]: On master: COMMIT
[0m16:04:17.799052 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:04:17.803464 [debug] [MainThread]: On master: Close
[0m16:04:17.828575 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m16:04:17.834032 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m16:04:17.842729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m16:04:17.844804 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m16:04:17.905931 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m16:04:17.913273 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m16:04:18.144355 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m16:04:18.150641 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:04:18.152340 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m16:04:18.154382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:18.177319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.023 seconds
[0m16:04:18.180442 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:04:18.181920 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m16:04:18.273621 [debug] [Thread-1 (]: SQL status: SELECT 15 in 0.090 seconds
[0m16:04:18.307544 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:04:18.320019 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m16:04:18.325495 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:04:18.344187 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:04:18.345695 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m16:04:18.348518 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:04:18.438528 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:04:18.441756 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:04:18.443187 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:04:18.450287 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m16:04:18.479558 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m16:04:18.501250 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:04:18.502681 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m16:04:18.516666 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m16:04:18.524436 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m16:04:18.535454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd18930f-acea-4130-abee-62b4d70bfcae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73365dc82000>]}
[0m16:04:18.539001 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 15[0m in 0.69s]
[0m16:04:18.541124 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m16:04:18.545034 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m16:04:18.549091 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m16:04:18.553090 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m16:04:18.567058 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m16:04:18.569686 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m16:04:18.584376 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m16:04:18.571521 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m16:04:18.591824 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m16:04:18.607285 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m16:04:18.629034 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m16:04:18.634030 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m16:04:18.637223 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m16:04:18.661559 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m16:04:18.682063 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m16:04:18.685102 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:04:18.687019 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:04:18.689089 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m16:04:18.690889 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m16:04:18.692599 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:04:18.694511 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:04:18.725946 [debug] [Thread-3 (]: SQL status: BEGIN in 0.032 seconds
[0m16:04:18.727592 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:04:18.729265 [debug] [Thread-4 (]: SQL status: BEGIN in 0.037 seconds
[0m16:04:18.730867 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m16:04:18.732546 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:04:18.734362 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m16:04:18.754725 [debug] [Thread-4 (]: SQL status: SELECT 15 in 0.019 seconds
[0m16:04:18.769818 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:04:18.771455 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m16:04:18.772889 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.039 seconds
[0m16:04:18.781394 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m16:04:18.785143 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:04:18.794816 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:04:18.796629 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m16:04:18.798683 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m16:04:18.802737 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:04:18.810687 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m16:04:18.816888 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:04:18.824273 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:04:18.822772 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:04:18.826853 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:04:18.828822 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m16:04:18.833642 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:04:18.836335 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m16:04:18.842385 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:04:18.857199 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:04:18.852426 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m16:04:18.860089 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:04:18.863115 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:04:18.865997 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m16:04:18.870838 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m16:04:18.887664 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.018 seconds
[0m16:04:18.890004 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m16:04:18.897799 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m16:04:18.901516 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:04:18.904352 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m16:04:18.907549 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd18930f-acea-4130-abee-62b4d70bfcae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x733658696810>]}
[0m16:04:18.910799 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 15[0m in 0.34s]
[0m16:04:18.914068 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m16:04:18.917676 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.008 seconds
[0m16:04:18.926449 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m16:04:18.929085 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd18930f-acea-4130-abee-62b4d70bfcae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73365a84ade0>]}
[0m16:04:18.931735 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.37s]
[0m16:04:18.943798 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m16:04:18.957767 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:18.964920 [debug] [MainThread]: On master: BEGIN
[0m16:04:18.966796 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:04:19.009897 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m16:04:19.011551 [debug] [MainThread]: On master: COMMIT
[0m16:04:19.013233 [debug] [MainThread]: Using postgres connection "master"
[0m16:04:19.014621 [debug] [MainThread]: On master: COMMIT
[0m16:04:19.019055 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:04:19.024338 [debug] [MainThread]: On master: Close
[0m16:04:19.028162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:19.029716 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m16:04:19.031028 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m16:04:19.032645 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m16:04:19.035268 [info ] [MainThread]: 
[0m16:04:19.045698 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m16:04:19.052221 [debug] [MainThread]: Command end result
[0m16:04:19.257755 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:04:19.271445 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:04:19.313106 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:04:19.314822 [info ] [MainThread]: 
[0m16:04:19.316857 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:04:19.318640 [info ] [MainThread]: 
[0m16:04:19.320552 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:04:19.338075 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.632172, "process_in_blocks": "118648", "process_kernel_time": 3.843045, "process_mem_max_rss": "107088", "process_out_blocks": "3416", "process_user_time": 9.840055}
[0m16:04:19.341211 [debug] [MainThread]: Command `dbt run` succeeded at 16:04:19.340545 after 6.64 seconds
[0m16:04:19.343441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73365eff1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73365d9680b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73365d4883b0>]}
[0m16:04:19.347714 [debug] [MainThread]: Flushing usage events
[0m16:04:20.101429 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:25:56.311090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b2117620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b07e5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b020ecc0>]}


============================== 16:25:56.356058 | 344c2b92-f933-48b8-b5d4-6552980577ad ==============================
[0m16:25:56.356058 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:25:56.359039 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:25:57.804923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '344c2b92-f933-48b8-b5d4-6552980577ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b1ce7050>]}
[0m16:25:58.417033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '344c2b92-f933-48b8-b5d4-6552980577ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b050db80>]}
[0m16:25:58.436017 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:25:59.495660 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m16:26:01.026072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:26:01.029217 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:26:01.341873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '344c2b92-f933-48b8-b5d4-6552980577ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1ae6b1730>]}
[0m16:26:02.086754 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:26:02.120810 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:26:02.405300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '344c2b92-f933-48b8-b5d4-6552980577ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1ae3c4140>]}
[0m16:26:02.408214 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m16:26:02.413598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '344c2b92-f933-48b8-b5d4-6552980577ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1ae4993d0>]}
[0m16:26:02.429798 [info ] [MainThread]: 
[0m16:26:02.441831 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:26:02.445242 [info ] [MainThread]: 
[0m16:26:02.448353 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:26:02.531023 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:26:03.467048 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:26:03.475777 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:26:03.482336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:05.323958 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.842 seconds
[0m16:26:05.331213 [debug] [ThreadPool]: On list_db: Close
[0m16:26:05.350878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m16:26:05.437241 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:26:05.439236 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m16:26:05.442093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:05.655965 [debug] [ThreadPool]: SQL status: BEGIN in 0.214 seconds
[0m16:26:05.660850 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:26:05.675662 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:26:05.894959 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.217 seconds
[0m16:26:05.922749 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m16:26:05.925974 [debug] [ThreadPool]: On list_db_dev: Close
[0m16:26:05.978130 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:05.980310 [debug] [MainThread]: On master: BEGIN
[0m16:26:05.982955 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:26:06.065507 [debug] [MainThread]: SQL status: BEGIN in 0.082 seconds
[0m16:26:06.069475 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:06.087110 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:26:06.284246 [debug] [MainThread]: SQL status: SELECT 0 in 0.182 seconds
[0m16:26:06.302478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '344c2b92-f933-48b8-b5d4-6552980577ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1ae3c4e90>]}
[0m16:26:06.305828 [debug] [MainThread]: On master: ROLLBACK
[0m16:26:06.317195 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:06.319434 [debug] [MainThread]: On master: BEGIN
[0m16:26:06.334480 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:26:06.337185 [debug] [MainThread]: On master: COMMIT
[0m16:26:06.350480 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:06.352863 [debug] [MainThread]: On master: COMMIT
[0m16:26:06.368065 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:26:06.371718 [debug] [MainThread]: On master: Close
[0m16:26:06.407309 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m16:26:06.411470 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m16:26:06.414385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m16:26:06.429600 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m16:26:06.534029 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m16:26:06.546717 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m16:26:07.205967 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m16:26:07.223358 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:26:07.246050 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m16:26:07.248038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:07.473428 [debug] [Thread-1 (]: SQL status: BEGIN in 0.225 seconds
[0m16:26:07.475307 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:26:07.482740 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m16:26:07.826662 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.341 seconds
[0m16:26:07.891694 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:26:07.896438 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m16:26:07.908024 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m16:26:07.931811 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:26:07.935266 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m16:26:07.939148 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:26:08.136792 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:26:08.139021 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:26:08.152264 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:26:08.166338 [debug] [Thread-1 (]: SQL status: COMMIT in 0.012 seconds
[0m16:26:08.224817 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m16:26:08.280690 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:26:08.282653 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m16:26:08.354076 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.069 seconds
[0m16:26:08.381233 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m16:26:08.414645 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '344c2b92-f933-48b8-b5d4-6552980577ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b1ce6240>]}
[0m16:26:08.430667 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 16[0m in 1.98s]
[0m16:26:08.447736 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m16:26:08.464097 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m16:26:08.483365 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m16:26:08.480314 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m16:26:08.500330 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m16:26:08.518667 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m16:26:08.486541 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m16:26:08.555996 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m16:26:08.566497 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m16:26:08.561945 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m16:26:08.002815 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m16:26:08.005357 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m16:26:08.044923 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m16:26:08.039928 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m16:26:08.069064 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m16:26:08.074341 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:26:08.077707 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m16:26:08.079451 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:26:08.082576 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:26:08.084361 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m16:26:08.086500 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:26:08.140862 [debug] [Thread-4 (]: SQL status: BEGIN in 0.054 seconds
[0m16:26:08.142693 [debug] [Thread-3 (]: SQL status: BEGIN in 0.063 seconds
[0m16:26:08.144910 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:26:08.147348 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:26:08.149610 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m16:26:08.151902 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m16:26:07.423882 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.130 seconds
[0m16:26:07.464864 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:26:07.478401 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m16:26:07.481776 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.187 seconds
[0m16:26:07.506129 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.021 seconds
[0m16:26:07.539592 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:26:07.548530 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m16:26:07.570618 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:26:07.572633 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:26:07.575340 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m16:26:07.593275 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:26:07.603778 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:26:07.606245 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:26:07.601869 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m16:26:07.626302 [debug] [Thread-4 (]: SQL status: COMMIT in 0.018 seconds
[0m16:26:07.658553 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:26:07.667383 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m16:26:07.669859 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m16:26:07.675274 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:26:07.678477 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m16:26:07.683364 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m16:26:07.698230 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:26:07.706449 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:26:07.708967 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:26:07.721070 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.013 seconds
[0m16:26:07.723507 [debug] [Thread-3 (]: SQL status: COMMIT in 0.012 seconds
[0m16:26:07.732909 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m16:26:07.748795 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m16:26:07.753173 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '344c2b92-f933-48b8-b5d4-6552980577ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1ad76db80>]}
[0m16:26:07.756896 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:26:07.768206 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m16:26:07.761387 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 16[0m in -0.80s]
[0m16:26:07.791280 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m16:26:07.794401 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.021 seconds
[0m16:26:07.812827 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m16:26:07.815885 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '344c2b92-f933-48b8-b5d4-6552980577ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1ac49df40>]}
[0m16:26:07.819327 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in -0.68s]
[0m16:26:07.829588 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m16:26:07.861590 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:07.864103 [debug] [MainThread]: On master: BEGIN
[0m16:26:07.872877 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:26:07.940852 [debug] [MainThread]: SQL status: BEGIN in 0.068 seconds
[0m16:26:07.943406 [debug] [MainThread]: On master: COMMIT
[0m16:26:07.957373 [debug] [MainThread]: Using postgres connection "master"
[0m16:26:07.959812 [debug] [MainThread]: On master: COMMIT
[0m16:26:07.963881 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:26:07.966230 [debug] [MainThread]: On master: Close
[0m16:26:07.979308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:07.981341 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m16:26:07.982769 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m16:26:07.984089 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m16:26:07.994453 [info ] [MainThread]: 
[0m16:26:08.009737 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 5.54 seconds (5.54s).
[0m16:26:08.029562 [debug] [MainThread]: Command end result
[0m16:26:08.269647 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:26:08.285889 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:26:08.380247 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:26:08.386188 [info ] [MainThread]: 
[0m16:26:08.390126 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:26:08.393078 [info ] [MainThread]: 
[0m16:26:08.397543 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:26:08.415916 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.077707, "process_in_blocks": "114832", "process_kernel_time": 11.6328, "process_mem_max_rss": "106548", "process_out_blocks": "1808", "process_user_time": 14.087775}
[0m16:26:08.420488 [debug] [MainThread]: Command `dbt run` succeeded at 16:26:08.419799 after 14.08 seconds
[0m16:26:08.426590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1ad6f0320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1ad6f0110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a1b020ecc0>]}
[0m16:26:08.432864 [debug] [MainThread]: Flushing usage events
[0m16:31:08.443784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79febfb2bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79febfb5e870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79fec0e084d0>]}


============================== 16:31:08.587833 | 966f9e0d-98ca-4374-9ebd-3480fd0b73a4 ==============================
[0m16:31:08.587833 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:31:08.590841 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:31:09.753534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '966f9e0d-98ca-4374-9ebd-3480fd0b73a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79febeeeb440>]}
[0m16:31:10.135333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '966f9e0d-98ca-4374-9ebd-3480fd0b73a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79febf61c680>]}
[0m16:31:10.141638 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:31:11.145687 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m16:31:12.445763 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:31:12.447040 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:31:12.582677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '966f9e0d-98ca-4374-9ebd-3480fd0b73a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79febd5c0f20>]}
[0m16:31:13.076626 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:31:13.088836 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:31:13.442188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '966f9e0d-98ca-4374-9ebd-3480fd0b73a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79febd2d09e0>]}
[0m16:31:13.446350 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m16:31:13.447947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '966f9e0d-98ca-4374-9ebd-3480fd0b73a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79febd2cea50>]}
[0m16:31:13.461319 [info ] [MainThread]: 
[0m16:31:13.464650 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:31:13.466713 [info ] [MainThread]: 
[0m16:31:13.469593 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:31:13.513524 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:31:14.990224 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:31:14.991219 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:31:14.992680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:15.283286 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.291 seconds
[0m16:31:15.289424 [debug] [ThreadPool]: On list_db: Close
[0m16:31:15.296036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m16:31:15.318282 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:31:15.319772 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m16:31:15.321410 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:31:15.404720 [debug] [ThreadPool]: SQL status: BEGIN in 0.084 seconds
[0m16:31:15.406026 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:31:15.407465 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:31:15.521325 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.112 seconds
[0m16:31:15.525714 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m16:31:15.527699 [debug] [ThreadPool]: On list_db_dev: Close
[0m16:31:15.554714 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:15.556760 [debug] [MainThread]: On master: BEGIN
[0m16:31:15.557865 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:31:15.603807 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m16:31:15.605502 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:15.607063 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:31:15.765079 [debug] [MainThread]: SQL status: SELECT 0 in 0.156 seconds
[0m16:31:15.772597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '966f9e0d-98ca-4374-9ebd-3480fd0b73a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79febfa33ce0>]}
[0m16:31:15.774600 [debug] [MainThread]: On master: ROLLBACK
[0m16:31:15.777084 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:15.780378 [debug] [MainThread]: On master: BEGIN
[0m16:31:15.786332 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m16:31:15.788934 [debug] [MainThread]: On master: COMMIT
[0m16:31:15.790778 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:15.792892 [debug] [MainThread]: On master: COMMIT
[0m16:31:15.797692 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m16:31:15.799316 [debug] [MainThread]: On master: Close
[0m16:31:15.834587 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m16:31:15.837063 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m16:31:15.846833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m16:31:15.849900 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m16:31:15.899009 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m16:31:15.913533 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m16:31:16.158463 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m16:31:16.164430 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:31:16.165854 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m16:31:16.167739 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:31:16.338671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.171 seconds
[0m16:31:16.340313 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:31:16.341745 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m16:31:16.525409 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.182 seconds
[0m16:31:16.541113 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:31:16.542817 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m16:31:16.545875 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:31:16.553319 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:31:16.554448 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m16:31:16.556558 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:31:16.610563 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:31:16.611883 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:31:16.612917 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:31:16.620713 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m16:31:16.644766 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m16:31:16.665504 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:31:16.667815 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m16:31:16.688050 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.018 seconds
[0m16:31:16.700630 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m16:31:16.708372 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '966f9e0d-98ca-4374-9ebd-3480fd0b73a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79febf9626c0>]}
[0m16:31:16.711246 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 16[0m in 0.86s]
[0m16:31:16.714394 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m16:31:16.720825 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m16:31:16.723578 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m16:31:16.729590 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m16:31:16.726140 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m16:31:16.732395 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m16:31:16.738485 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m16:31:16.742040 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m16:31:16.744579 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m16:31:16.784704 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m16:31:16.787025 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m16:31:16.791471 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m16:31:16.799267 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m16:31:16.807367 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m16:31:16.817335 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m16:31:16.820519 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:31:16.822580 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:31:16.824819 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m16:31:16.826308 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m16:31:16.827880 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:31:16.829304 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:31:16.858039 [debug] [Thread-4 (]: SQL status: BEGIN in 0.030 seconds
[0m16:31:16.860722 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:31:16.862067 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m16:31:16.868952 [debug] [Thread-3 (]: SQL status: BEGIN in 0.039 seconds
[0m16:31:16.872850 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:31:16.874228 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m16:31:16.885365 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.022 seconds
[0m16:31:16.909103 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:31:16.911436 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m16:31:16.916669 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:31:16.935233 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:31:16.936956 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m16:31:16.939996 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:31:16.947186 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.072 seconds
[0m16:31:16.948768 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:31:16.959402 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:31:16.961011 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:31:16.962293 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m16:31:16.963696 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:31:16.966598 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:31:16.976292 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m16:31:16.982251 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:31:16.993147 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m16:31:16.994668 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m16:31:16.996504 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:31:16.998045 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m16:31:16.999146 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:31:17.005184 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:31:17.006194 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:31:17.007214 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:31:17.008714 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.008 seconds
[0m16:31:17.012924 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m16:31:17.014215 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m16:31:17.021628 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '966f9e0d-98ca-4374-9ebd-3480fd0b73a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79febc38f350>]}
[0m16:31:17.024908 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m16:31:17.027120 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 16[0m in 0.29s]
[0m16:31:17.030365 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:31:17.032846 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m16:31:17.034577 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m16:31:17.046588 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.009 seconds
[0m16:31:17.056715 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m16:31:17.060263 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '966f9e0d-98ca-4374-9ebd-3480fd0b73a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79febc468080>]}
[0m16:31:17.064924 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.32s]
[0m16:31:17.068170 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m16:31:17.075278 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:17.077205 [debug] [MainThread]: On master: BEGIN
[0m16:31:17.079054 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:31:17.149403 [debug] [MainThread]: SQL status: BEGIN in 0.070 seconds
[0m16:31:17.150868 [debug] [MainThread]: On master: COMMIT
[0m16:31:17.152326 [debug] [MainThread]: Using postgres connection "master"
[0m16:31:17.153712 [debug] [MainThread]: On master: COMMIT
[0m16:31:17.156088 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:31:17.157841 [debug] [MainThread]: On master: Close
[0m16:31:17.160589 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:17.162404 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m16:31:17.164227 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m16:31:17.165882 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m16:31:17.173886 [info ] [MainThread]: 
[0m16:31:17.178687 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 3.70 seconds (3.70s).
[0m16:31:17.195799 [debug] [MainThread]: Command end result
[0m16:31:17.298282 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:31:17.302799 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:31:17.323154 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:31:17.324517 [info ] [MainThread]: 
[0m16:31:17.325981 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:31:17.332184 [info ] [MainThread]: 
[0m16:31:17.336443 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:31:17.342918 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.24987, "process_in_blocks": "26432", "process_kernel_time": 7.572846, "process_mem_max_rss": "107296", "process_out_blocks": "3392", "process_user_time": 12.66848}
[0m16:31:17.345476 [debug] [MainThread]: Command `dbt run` succeeded at 16:31:17.344867 after 9.25 seconds
[0m16:31:17.346890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79febfb5e870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79febf1a10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79febf664530>]}
[0m16:31:17.348159 [debug] [MainThread]: Flushing usage events
[0m16:31:18.075775 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:53:19.470440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a975ec86b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a975ec863c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a975ec86c60>]}


============================== 16:53:19.544589 | 1e36c537-eacc-42bd-9590-9d21f9494390 ==============================
[0m16:53:19.544589 [info ] [MainThread]: Running with dbt=1.9.0
[0m16:53:19.547280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:53:21.546307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e36c537-eacc-42bd-9590-9d21f9494390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a975e0b7890>]}
[0m16:53:21.833136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e36c537-eacc-42bd-9590-9d21f9494390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a975e3ff4d0>]}
[0m16:53:21.838198 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:53:22.414373 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m16:53:23.434236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:53:23.447670 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:53:23.783820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e36c537-eacc-42bd-9590-9d21f9494390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a975c8cd310>]}
[0m16:53:24.305654 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:53:24.315381 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:53:24.537307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e36c537-eacc-42bd-9590-9d21f9494390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a975c5d4770>]}
[0m16:53:24.540001 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m16:53:24.542062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e36c537-eacc-42bd-9590-9d21f9494390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a975e3ff5c0>]}
[0m16:53:24.553814 [info ] [MainThread]: 
[0m16:53:24.556289 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:53:24.560706 [info ] [MainThread]: 
[0m16:53:24.568197 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:53:24.610154 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m16:53:25.166886 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m16:53:25.169140 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m16:53:25.170854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:25.778461 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.608 seconds
[0m16:53:25.786449 [debug] [ThreadPool]: On list_db: Close
[0m16:53:25.806299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m16:53:25.866491 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:53:25.880378 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m16:53:25.883174 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:53:26.030899 [debug] [ThreadPool]: SQL status: BEGIN in 0.148 seconds
[0m16:53:26.035950 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m16:53:26.039873 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m16:53:26.302058 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.259 seconds
[0m16:53:26.309181 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m16:53:26.315201 [debug] [ThreadPool]: On list_db_dev: Close
[0m16:53:26.370023 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:26.372101 [debug] [MainThread]: On master: BEGIN
[0m16:53:26.386616 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:53:26.501109 [debug] [MainThread]: SQL status: BEGIN in 0.114 seconds
[0m16:53:26.502871 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:26.517129 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:53:26.795127 [debug] [MainThread]: SQL status: SELECT 0 in 0.275 seconds
[0m16:53:26.808209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e36c537-eacc-42bd-9590-9d21f9494390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a975f4ceb40>]}
[0m16:53:26.811360 [debug] [MainThread]: On master: ROLLBACK
[0m16:53:26.813708 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:26.815485 [debug] [MainThread]: On master: BEGIN
[0m16:53:26.820696 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:53:26.826351 [debug] [MainThread]: On master: COMMIT
[0m16:53:26.830264 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:26.837008 [debug] [MainThread]: On master: COMMIT
[0m16:53:26.842757 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m16:53:26.845510 [debug] [MainThread]: On master: Close
[0m16:53:26.922428 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m16:53:26.928589 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m16:53:26.935211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m16:53:26.936890 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m16:53:26.996986 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m16:53:27.013993 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m16:53:27.269822 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m16:53:27.275682 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:53:27.277180 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m16:53:27.278753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:53:27.311946 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m16:53:27.314352 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:53:27.316723 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m16:53:27.386723 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.068 seconds
[0m16:53:27.417078 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:53:27.419186 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m16:53:27.429852 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m16:53:27.441856 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:53:27.444100 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m16:53:27.447457 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:53:27.555148 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:53:27.560826 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:53:27.563515 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m16:53:27.570894 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m16:53:27.629440 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m16:53:27.692789 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m16:53:27.706230 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m16:53:27.737155 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.028 seconds
[0m16:53:27.752666 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m16:53:27.766397 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e36c537-eacc-42bd-9590-9d21f9494390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a97600862d0>]}
[0m16:53:27.772271 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 16[0m in 0.82s]
[0m16:53:27.777905 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m16:53:27.782756 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m16:53:27.785350 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m16:53:27.794429 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m16:53:27.796774 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m16:53:27.791516 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m16:53:27.798798 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m16:53:27.801006 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m16:53:27.855032 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m16:53:27.856980 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m16:53:27.882814 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m16:53:27.888591 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m16:53:27.926660 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m16:53:27.925400 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m16:53:27.948266 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m16:53:27.955424 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:53:27.956957 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:53:27.964857 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m16:53:27.966836 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m16:53:27.968677 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:53:27.970354 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:53:28.026351 [debug] [Thread-3 (]: SQL status: BEGIN in 0.058 seconds
[0m16:53:28.028205 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:53:28.030122 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m16:53:28.056837 [debug] [Thread-4 (]: SQL status: BEGIN in 0.086 seconds
[0m16:53:28.059222 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:53:28.071390 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m16:53:28.129423 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.055 seconds
[0m16:53:28.144283 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.112 seconds
[0m16:53:28.148305 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:53:28.161356 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:53:28.163285 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m16:53:28.165229 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m16:53:28.169274 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:53:28.170535 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:53:28.182515 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:53:28.196264 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m16:53:28.198585 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:53:28.202098 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m16:53:28.204021 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:53:28.212375 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m16:53:28.214021 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:53:28.220286 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:53:28.222457 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:53:28.231070 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m16:53:28.226122 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:53:28.234772 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m16:53:28.241976 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m16:53:28.254596 [debug] [Thread-3 (]: SQL status: COMMIT in 0.018 seconds
[0m16:53:28.259045 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m16:53:28.297983 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m16:53:28.302089 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m16:53:28.303883 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m16:53:28.307112 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m16:53:28.309453 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m16:53:28.328227 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.019 seconds
[0m16:53:28.330121 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.018 seconds
[0m16:53:28.340021 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m16:53:28.345578 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m16:53:28.349150 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e36c537-eacc-42bd-9590-9d21f9494390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a975b76c0e0>]}
[0m16:53:28.354729 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e36c537-eacc-42bd-9590-9d21f9494390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a975b8145f0>]}
[0m16:53:28.352356 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.55s]
[0m16:53:28.357517 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 16[0m in 0.56s]
[0m16:53:28.363499 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m16:53:28.360857 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m16:53:28.390195 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:28.392849 [debug] [MainThread]: On master: BEGIN
[0m16:53:28.394675 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:53:28.509131 [debug] [MainThread]: SQL status: BEGIN in 0.114 seconds
[0m16:53:28.516770 [debug] [MainThread]: On master: COMMIT
[0m16:53:28.521329 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:28.523171 [debug] [MainThread]: On master: COMMIT
[0m16:53:28.525886 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:53:28.529240 [debug] [MainThread]: On master: Close
[0m16:53:28.533213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:28.534569 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m16:53:28.537146 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m16:53:28.539796 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m16:53:28.541617 [info ] [MainThread]: 
[0m16:53:28.543471 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 3.97 seconds (3.97s).
[0m16:53:28.557880 [debug] [MainThread]: Command end result
[0m16:53:28.691528 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m16:53:28.700179 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m16:53:28.730097 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m16:53:28.731303 [info ] [MainThread]: 
[0m16:53:28.733466 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:53:28.735261 [info ] [MainThread]: 
[0m16:53:28.737099 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:53:28.763388 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.616142, "process_in_blocks": "115744", "process_kernel_time": 14.182265, "process_mem_max_rss": "106984", "process_out_blocks": "3392", "process_user_time": 14.379062}
[0m16:53:28.767276 [debug] [MainThread]: Command `dbt run` succeeded at 16:53:28.766748 after 9.62 seconds
[0m16:53:28.769148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a975c858380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a975c8afe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a975ec84110>]}
[0m16:53:28.772903 [debug] [MainThread]: Flushing usage events
[0m16:53:29.703891 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:03:58.932218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b8faa71cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b8fa8025a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b8fa755b80>]}


============================== 17:03:59.082672 | 93ce0c71-ccff-4dfc-8ca6-0b57f43b04de ==============================
[0m17:03:59.082672 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:03:59.086592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/usr/app/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:04:01.730360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93ce0c71-ccff-4dfc-8ca6-0b57f43b04de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b8fa545be0>]}
[0m17:04:02.507027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93ce0c71-ccff-4dfc-8ca6-0b57f43b04de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b8fafc1c40>]}
[0m17:04:02.512527 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:04:03.661761 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:04:05.872529 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:04:05.875286 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:04:06.187053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93ce0c71-ccff-4dfc-8ca6-0b57f43b04de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b8f8c0e810>]}
[0m17:04:06.966235 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:04:07.000678 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:04:07.413372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93ce0c71-ccff-4dfc-8ca6-0b57f43b04de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b8f8908b60>]}
[0m17:04:07.428289 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m17:04:07.429904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93ce0c71-ccff-4dfc-8ca6-0b57f43b04de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b8fa6d5430>]}
[0m17:04:07.449018 [info ] [MainThread]: 
[0m17:04:07.460644 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:04:07.467591 [info ] [MainThread]: 
[0m17:04:07.470620 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:04:07.525387 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m17:04:07.112497 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m17:04:07.113950 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:04:07.127295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:04:10.243995 [debug] [ThreadPool]: SQL status: SELECT 5 in 3.128 seconds
[0m17:04:10.255729 [debug] [ThreadPool]: On list_db: Close
[0m17:04:10.271960 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m17:04:10.358647 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m17:04:10.369443 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m17:04:10.370844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:04:10.536537 [debug] [ThreadPool]: SQL status: BEGIN in 0.164 seconds
[0m17:04:10.538511 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m17:04:10.551036 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m17:04:10.795458 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.243 seconds
[0m17:04:10.801113 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m17:04:10.804468 [debug] [ThreadPool]: On list_db_dev: Close
[0m17:04:10.855302 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:10.857017 [debug] [MainThread]: On master: BEGIN
[0m17:04:10.858935 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:04:10.967377 [debug] [MainThread]: SQL status: BEGIN in 0.108 seconds
[0m17:04:10.971664 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:10.974218 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:04:11.739965 [debug] [MainThread]: SQL status: SELECT 0 in 0.762 seconds
[0m17:04:11.758771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93ce0c71-ccff-4dfc-8ca6-0b57f43b04de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b8fa68fe00>]}
[0m17:04:11.761067 [debug] [MainThread]: On master: ROLLBACK
[0m17:04:11.764114 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:11.766280 [debug] [MainThread]: On master: BEGIN
[0m17:04:11.778361 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m17:04:11.779994 [debug] [MainThread]: On master: COMMIT
[0m17:04:11.781352 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:11.783063 [debug] [MainThread]: On master: COMMIT
[0m17:04:11.785651 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:04:11.787678 [debug] [MainThread]: On master: Close
[0m17:04:11.840260 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m17:04:11.842885 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m17:04:11.846276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m17:04:11.859459 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m17:04:11.913284 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m17:04:11.944721 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m17:04:12.443623 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m17:04:12.476932 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m17:04:12.480935 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m17:04:12.485147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:04:12.579343 [debug] [Thread-1 (]: SQL status: BEGIN in 0.095 seconds
[0m17:04:12.582549 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m17:04:12.591507 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m17:04:12.835322 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.242 seconds
[0m17:04:12.895504 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m17:04:12.897464 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m17:04:12.919731 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.020 seconds
[0m17:04:12.960782 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m17:04:12.963097 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m17:04:12.966061 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:04:13.187964 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m17:04:13.189851 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m17:04:13.197097 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m17:04:13.210003 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m17:04:13.279439 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m17:04:13.337756 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m17:04:13.339639 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m17:04:13.407933 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.066 seconds
[0m17:04:13.439285 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m17:04:13.460935 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ce0c71-ccff-4dfc-8ca6-0b57f43b04de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b8fafc2930>]}
[0m17:04:13.474990 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 16[0m in 1.60s]
[0m17:04:13.478208 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m17:04:13.515113 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m17:04:13.519390 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m17:04:13.541112 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m17:04:13.545268 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m17:04:13.547616 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m17:04:13.527650 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m17:04:13.558282 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m17:04:13.560311 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m17:04:13.625368 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m17:04:13.629269 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m17:04:13.637664 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m17:04:13.668514 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m17:04:13.704099 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m17:04:13.710048 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m17:04:13.721737 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:04:13.736486 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:04:13.738409 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m17:04:13.740598 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m17:04:13.744389 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:04:13.742395 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:04:13.820487 [debug] [Thread-4 (]: SQL status: BEGIN in 0.076 seconds
[0m17:04:13.822705 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:04:13.825191 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m17:04:13.885752 [debug] [Thread-3 (]: SQL status: BEGIN in 0.143 seconds
[0m17:04:13.887337 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:04:13.890301 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m17:04:13.961853 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.124 seconds
[0m17:04:14.006500 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:04:14.012531 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m17:04:14.016500 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:04:14.047417 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:04:14.053325 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m17:04:14.056307 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:04:14.062708 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m17:04:14.073710 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:04:14.075774 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m17:04:14.109835 [debug] [Thread-4 (]: SQL status: COMMIT in 0.032 seconds
[0m17:04:14.127826 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m17:04:14.130219 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:04:14.132152 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m17:04:14.148655 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.015 seconds
[0m17:04:14.154609 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m17:04:14.163994 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ce0c71-ccff-4dfc-8ca6-0b57f43b04de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b8f7c75d60>]}
[0m17:04:14.167509 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 16[0m in 0.62s]
[0m17:04:14.170491 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m17:04:14.173618 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.276 seconds
[0m17:04:14.209908 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:04:14.212068 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m17:04:14.219716 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:04:14.247470 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:04:14.249160 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m17:04:14.253074 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:04:14.264453 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m17:04:14.266163 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:04:14.267803 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m17:04:14.279435 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m17:04:14.309757 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m17:04:14.319036 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:04:14.320940 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m17:04:14.335531 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.013 seconds
[0m17:04:14.341271 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m17:04:14.343666 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '93ce0c71-ccff-4dfc-8ca6-0b57f43b04de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b8f49bbe60>]}
[0m17:04:14.347169 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.79s]
[0m17:04:14.350271 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m17:04:14.378091 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:14.381685 [debug] [MainThread]: On master: BEGIN
[0m17:04:14.384322 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:04:14.516072 [debug] [MainThread]: SQL status: BEGIN in 0.132 seconds
[0m17:04:14.517669 [debug] [MainThread]: On master: COMMIT
[0m17:04:14.523417 [debug] [MainThread]: Using postgres connection "master"
[0m17:04:14.525023 [debug] [MainThread]: On master: COMMIT
[0m17:04:14.527249 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m17:04:14.542453 [debug] [MainThread]: On master: Close
[0m17:04:14.544662 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:04:14.548433 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m17:04:14.549704 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m17:04:14.551315 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m17:04:14.558449 [info ] [MainThread]: 
[0m17:04:14.560262 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 7.09 seconds (7.09s).
[0m17:04:14.575821 [debug] [MainThread]: Command end result
[0m17:04:14.829956 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:04:14.836995 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:04:14.895396 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m17:04:14.896733 [info ] [MainThread]: 
[0m17:04:14.898489 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:04:14.899991 [info ] [MainThread]: 
[0m17:04:14.909869 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:04:14.950365 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.85112, "process_in_blocks": "116368", "process_kernel_time": 10.966153, "process_mem_max_rss": "107260", "process_out_blocks": "3400", "process_user_time": 18.525518}
[0m17:04:14.953845 [debug] [MainThread]: Command `dbt run` succeeded at 17:04:14.953070 after 18.86 seconds
[0m17:04:14.955525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b8fa8025a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b8fdc228a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b8fa75b740>]}
[0m17:04:14.966077 [debug] [MainThread]: Flushing usage events
[0m17:04:16.107964 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:12:54.661179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b6c35a71a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b6c3bcec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b6c33945c0>]}


============================== 17:12:54.702062 | 971bcbd5-d66a-45aa-acb0-20020d5f96fc ==============================
[0m17:12:54.702062 [info ] [MainThread]: Running with dbt=1.9.0
[0m17:12:54.704483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:12:56.444601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '971bcbd5-d66a-45aa-acb0-20020d5f96fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b6c1786f30>]}
[0m17:12:56.921310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '971bcbd5-d66a-45aa-acb0-20020d5f96fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b6c3c7fe60>]}
[0m17:12:56.925245 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:12:57.481354 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m17:12:58.232511 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:12:58.234113 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:12:58.466386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '971bcbd5-d66a-45aa-acb0-20020d5f96fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b6c2fde8d0>]}
[0m17:12:58.931413 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:12:58.941810 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:12:59.075050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '971bcbd5-d66a-45aa-acb0-20020d5f96fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b6c1741a90>]}
[0m17:12:59.076799 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m17:12:59.078698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '971bcbd5-d66a-45aa-acb0-20020d5f96fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b6c14f7ce0>]}
[0m17:12:59.087247 [info ] [MainThread]: 
[0m17:12:59.089041 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:12:59.093432 [info ] [MainThread]: 
[0m17:12:59.096381 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:12:59.120240 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m17:12:59.520048 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m17:12:59.521849 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m17:12:59.524116 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:59.773487 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.249 seconds
[0m17:12:59.778733 [debug] [ThreadPool]: On list_db: Close
[0m17:12:59.785644 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m17:12:59.826494 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m17:12:59.828060 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m17:12:59.829747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:59.856767 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m17:12:59.860426 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m17:12:59.871210 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m17:12:59.936650 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.064 seconds
[0m17:12:59.941929 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m17:12:59.944058 [debug] [ThreadPool]: On list_db_dev: Close
[0m17:12:59.970227 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:59.971641 [debug] [MainThread]: On master: BEGIN
[0m17:12:59.973028 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:59.998901 [debug] [MainThread]: SQL status: BEGIN in 0.026 seconds
[0m17:13:00.000621 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:00.003213 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:13:00.089427 [debug] [MainThread]: SQL status: SELECT 0 in 0.083 seconds
[0m17:13:00.096929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '971bcbd5-d66a-45aa-acb0-20020d5f96fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b6c30bc0e0>]}
[0m17:13:00.100855 [debug] [MainThread]: On master: ROLLBACK
[0m17:13:00.104019 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:00.106135 [debug] [MainThread]: On master: BEGIN
[0m17:13:00.110672 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m17:13:00.112321 [debug] [MainThread]: On master: COMMIT
[0m17:13:00.114375 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:00.116034 [debug] [MainThread]: On master: COMMIT
[0m17:13:00.120137 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m17:13:00.127994 [debug] [MainThread]: On master: Close
[0m17:13:00.153624 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m17:13:00.157332 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m17:13:00.159972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m17:13:00.162148 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m17:13:00.207886 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m17:13:00.214645 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m17:13:00.441099 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m17:13:00.451474 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m17:13:00.453064 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m17:13:00.454785 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:13:00.505534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m17:13:00.507197 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m17:13:00.509202 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m17:13:00.590839 [debug] [Thread-1 (]: SQL status: SELECT 16 in 0.080 seconds
[0m17:13:00.627285 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m17:13:00.632266 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m17:13:00.635640 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:13:00.658915 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m17:13:00.666528 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m17:13:00.670126 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:13:00.759744 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m17:13:00.762121 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m17:13:00.763586 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m17:13:00.774307 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m17:13:00.820970 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m17:13:00.851744 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m17:13:00.853435 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m17:13:00.870028 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.014 seconds
[0m17:13:00.880193 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m17:13:00.889507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '971bcbd5-d66a-45aa-acb0-20020d5f96fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b6c4fba690>]}
[0m17:13:00.892359 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 16[0m in 0.72s]
[0m17:13:00.895567 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m17:13:00.900372 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m17:13:00.902887 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m17:13:00.905828 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m17:13:00.911188 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m17:13:00.916087 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m17:13:00.922098 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m17:13:00.919632 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m17:13:00.940871 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m17:13:00.945594 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m17:13:00.965329 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m17:13:00.970793 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m17:13:00.973530 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m17:13:00.986499 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m17:13:01.006946 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m17:13:01.010822 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:13:01.012932 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m17:13:01.014532 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:13:01.016301 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:13:01.017899 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m17:13:01.020062 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:13:01.040803 [debug] [Thread-4 (]: SQL status: BEGIN in 0.024 seconds
[0m17:13:01.042543 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:13:01.044292 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m17:13:01.047849 [debug] [Thread-3 (]: SQL status: BEGIN in 0.027 seconds
[0m17:13:01.053916 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:13:01.057009 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m17:13:01.075723 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.029 seconds
[0m17:13:01.103550 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:13:01.106717 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m17:13:01.113443 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:13:01.116792 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.057 seconds
[0m17:13:01.160002 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:13:01.163676 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:13:01.166057 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m17:13:01.169831 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m17:13:01.174673 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:13:01.189838 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.016 seconds
[0m17:13:01.192368 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m17:13:01.210460 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:13:01.220473 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:13:01.223639 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m17:13:01.226158 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m17:13:01.234657 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:13:01.243173 [debug] [Thread-4 (]: SQL status: COMMIT in 0.011 seconds
[0m17:13:01.263162 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m17:13:01.270907 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m17:13:01.273852 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:13:01.277813 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m17:13:01.281723 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m17:13:01.289138 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m17:13:01.298174 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m17:13:01.316151 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.023 seconds
[0m17:13:01.351471 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m17:13:01.354824 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m17:13:01.365341 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '971bcbd5-d66a-45aa-acb0-20020d5f96fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b6c072f1a0>]}
[0m17:13:01.373793 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m17:13:01.378787 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 16[0m in 0.45s]
[0m17:13:01.383350 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m17:13:01.387379 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m17:13:01.402224 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.012 seconds
[0m17:13:01.417670 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m17:13:01.426057 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '971bcbd5-d66a-45aa-acb0-20020d5f96fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b6c072e600>]}
[0m17:13:01.429158 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.51s]
[0m17:13:01.437014 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m17:13:01.449401 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:01.452299 [debug] [MainThread]: On master: BEGIN
[0m17:13:01.455094 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:13:01.517962 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m17:13:01.521533 [debug] [MainThread]: On master: COMMIT
[0m17:13:01.524164 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:01.526768 [debug] [MainThread]: On master: COMMIT
[0m17:13:01.540961 [debug] [MainThread]: SQL status: COMMIT in 0.012 seconds
[0m17:13:01.543835 [debug] [MainThread]: On master: Close
[0m17:13:01.546957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:13:01.549963 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m17:13:01.557848 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m17:13:01.559409 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m17:13:01.562125 [info ] [MainThread]: 
[0m17:13:01.565818 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 2.47 seconds (2.47s).
[0m17:13:01.583279 [debug] [MainThread]: Command end result
[0m17:13:01.761150 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m17:13:01.771128 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m17:13:01.834656 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m17:13:01.837874 [info ] [MainThread]: 
[0m17:13:01.840335 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:13:01.842654 [info ] [MainThread]: 
[0m17:13:01.844835 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:13:01.861780 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.5669136, "process_in_blocks": "114016", "process_kernel_time": 4.786042, "process_mem_max_rss": "107416", "process_out_blocks": "3392", "process_user_time": 13.416087}
[0m17:13:01.865489 [debug] [MainThread]: Command `dbt run` succeeded at 17:13:01.864640 after 7.57 seconds
[0m17:13:01.867783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b6c3341910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b6c1787140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b6c32c4ef0>]}
[0m17:13:01.875942 [debug] [MainThread]: Flushing usage events
[0m17:13:02.661281 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:30:09.524959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc6c8868e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc6ca092c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc6c81196a0>]}


============================== 11:30:10.204862 | 853886a5-0ee7-4545-833d-c3238b0ca84d ==============================
[0m11:30:10.204862 [info ] [MainThread]: Running with dbt=1.9.0
[0m11:30:10.293429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'version_check': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:30:15.301320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '853886a5-0ee7-4545-833d-c3238b0ca84d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc6c9bc3260>]}
[0m11:30:15.993413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '853886a5-0ee7-4545-833d-c3238b0ca84d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc6c7e9ab40>]}
[0m11:30:15.998299 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:30:17.279888 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m11:30:18.927746 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:30:18.946968 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:30:19.851401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '853886a5-0ee7-4545-833d-c3238b0ca84d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc6c643c110>]}
[0m11:30:21.011304 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:30:21.094508 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:30:21.711792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '853886a5-0ee7-4545-833d-c3238b0ca84d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc6c6349610>]}
[0m11:30:21.714774 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m11:30:21.726029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '853886a5-0ee7-4545-833d-c3238b0ca84d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc6c7d2fef0>]}
[0m11:30:21.751213 [info ] [MainThread]: 
[0m11:30:21.760109 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:30:21.770571 [info ] [MainThread]: 
[0m11:30:21.782672 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:30:21.853923 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m11:30:23.154855 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m11:30:23.158229 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m11:30:23.161556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:30:23.901285 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.740 seconds
[0m11:30:23.919289 [debug] [ThreadPool]: On list_db: Close
[0m11:30:23.935626 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m11:30:23.983206 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:30:23.985665 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m11:30:23.987654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:30:24.062987 [debug] [ThreadPool]: SQL status: BEGIN in 0.075 seconds
[0m11:30:24.064481 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m11:30:24.066470 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m11:30:24.492218 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.424 seconds
[0m11:30:24.505233 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m11:30:24.509049 [debug] [ThreadPool]: On list_db_dev: Close
[0m11:30:24.556020 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:24.557900 [debug] [MainThread]: On master: BEGIN
[0m11:30:24.559916 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:30:24.619411 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m11:30:24.628830 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:24.630623 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:30:24.802144 [debug] [MainThread]: SQL status: SELECT 0 in 0.170 seconds
[0m11:30:24.816913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '853886a5-0ee7-4545-833d-c3238b0ca84d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc6c7c0b440>]}
[0m11:30:24.818970 [debug] [MainThread]: On master: ROLLBACK
[0m11:30:24.826341 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:24.827656 [debug] [MainThread]: On master: BEGIN
[0m11:30:24.830573 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:30:24.832199 [debug] [MainThread]: On master: COMMIT
[0m11:30:24.833777 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:24.835169 [debug] [MainThread]: On master: COMMIT
[0m11:30:24.837493 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m11:30:24.846363 [debug] [MainThread]: On master: Close
[0m11:30:24.894149 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m11:30:24.909317 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m11:30:24.915048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m11:30:24.916723 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m11:30:25.018761 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m11:30:25.036422 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m11:30:25.422675 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m11:30:25.443999 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m11:30:25.446398 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m11:30:25.448133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:30:25.656793 [debug] [Thread-1 (]: SQL status: BEGIN in 0.208 seconds
[0m11:30:25.659137 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m11:30:25.661796 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m11:30:27.176144 [debug] [Thread-1 (]: SQL status: SELECT 16 in 1.502 seconds
[0m11:30:27.223120 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m11:30:27.228269 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m11:30:27.293652 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.063 seconds
[0m11:30:27.318469 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m11:30:27.320456 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m11:30:27.323946 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:30:27.439430 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m11:30:27.442950 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m11:30:27.448969 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m11:30:27.829218 [debug] [Thread-1 (]: SQL status: COMMIT in 0.378 seconds
[0m11:30:27.890334 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m11:30:27.945336 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m11:30:27.951843 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m11:30:28.001073 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.045 seconds
[0m11:30:28.023154 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m11:30:28.071753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '853886a5-0ee7-4545-833d-c3238b0ca84d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc6c87be360>]}
[0m11:30:28.075502 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 16[0m in 3.11s]
[0m11:30:28.079188 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m11:30:28.086989 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m11:30:28.091293 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m11:30:28.102048 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m11:30:28.105139 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m11:30:28.108066 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m11:30:28.110590 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m11:30:28.117854 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m11:30:28.120400 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m11:30:28.175890 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m11:30:28.196432 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m11:30:28.202154 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m11:30:28.211932 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m11:30:28.239503 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m11:30:28.253489 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m11:30:28.269091 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:30:28.271331 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m11:30:28.281170 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:30:28.274848 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:30:28.283629 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m11:30:28.287432 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:30:28.332828 [debug] [Thread-3 (]: SQL status: BEGIN in 0.050 seconds
[0m11:30:28.335577 [debug] [Thread-4 (]: SQL status: BEGIN in 0.048 seconds
[0m11:30:28.337496 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:30:28.350710 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:30:28.353642 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m11:30:28.356298 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m11:30:28.437477 [debug] [Thread-4 (]: SQL status: SELECT 16 in 0.078 seconds
[0m11:30:28.464558 [debug] [Thread-3 (]: SQL status: SELECT 2 in 0.106 seconds
[0m11:30:28.467776 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:30:28.491916 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:30:28.494282 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m11:30:28.496804 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m11:30:28.505566 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m11:30:28.518746 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m11:30:28.528348 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:30:28.551330 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m11:30:28.555278 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:30:28.558305 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:30:28.575329 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m11:30:28.574393 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:30:28.579233 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:30:28.581046 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m11:30:28.583216 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m11:30:28.599954 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m11:30:28.602185 [debug] [Thread-4 (]: SQL status: COMMIT in 0.007 seconds
[0m11:30:28.604120 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:30:28.617705 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m11:30:28.619193 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m11:30:28.633016 [debug] [Thread-3 (]: SQL status: COMMIT in 0.011 seconds
[0m11:30:28.634916 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m11:30:28.649443 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m11:30:28.656949 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m11:30:28.659809 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m11:30:28.661952 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m11:30:28.665095 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.012 seconds
[0m11:30:28.686413 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m11:30:28.692040 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.020 seconds
[0m11:30:28.694779 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '853886a5-0ee7-4545-833d-c3238b0ca84d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc6c532eba0>]}
[0m11:30:28.700564 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m11:30:28.711423 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 16[0m in 0.58s]
[0m11:30:28.715935 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m11:30:28.719675 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '853886a5-0ee7-4545-833d-c3238b0ca84d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc6c537c200>]}
[0m11:30:28.722292 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 2[0m in 0.61s]
[0m11:30:28.725446 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m11:30:28.756537 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:28.758685 [debug] [MainThread]: On master: BEGIN
[0m11:30:28.760693 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:30:28.803590 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m11:30:28.805434 [debug] [MainThread]: On master: COMMIT
[0m11:30:28.807480 [debug] [MainThread]: Using postgres connection "master"
[0m11:30:28.818338 [debug] [MainThread]: On master: COMMIT
[0m11:30:28.828454 [debug] [MainThread]: SQL status: COMMIT in 0.008 seconds
[0m11:30:28.832480 [debug] [MainThread]: On master: Close
[0m11:30:28.837931 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:30:28.840207 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m11:30:28.855828 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m11:30:28.857875 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m11:30:28.861040 [info ] [MainThread]: 
[0m11:30:28.863822 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 7.09 seconds (7.09s).
[0m11:30:28.883403 [debug] [MainThread]: Command end result
[0m11:30:29.138981 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m11:30:29.157555 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m11:30:29.216176 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m11:30:29.217959 [info ] [MainThread]: 
[0m11:30:29.222360 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:30:29.225397 [info ] [MainThread]: 
[0m11:30:29.228458 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m11:30:29.283954 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 21.727999, "process_in_blocks": "103120", "process_kernel_time": 28.534, "process_mem_max_rss": "107264", "process_out_blocks": "3256", "process_user_time": 32.17638}
[0m11:30:29.287106 [debug] [MainThread]: Command `dbt run` succeeded at 11:30:29.286321 after 21.73 seconds
[0m11:30:29.290780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc6c80ec530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc6c7e83d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc6c7ed0ec0>]}
[0m11:30:29.302607 [debug] [MainThread]: Flushing usage events
[0m11:30:30.260608 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:14:40.120365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ab7fda2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ab7e27bb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ab7e278e60>]}
[0m13:14:40.122723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bc2c99d310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bc2ab9dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bc2ab9f3b0>]}


============================== 13:14:40.252600 | c98d7a24-4b27-4f5b-9c0f-8d02c4fc5b92 ==============================
[0m13:14:40.252600 [info ] [MainThread]: Running with dbt=1.9.0


============================== 13:14:40.263578 | 87630deb-5805-4372-82dd-848ea5c447af ==============================
[0m13:14:40.263578 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:14:40.128172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04d0157f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04d03aa240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04d12fdb50>]}
[0m13:14:40.266801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/root/.dbt', 'log_path': '/usr/app/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}


============================== 13:14:40.268928 | 3b782f6b-580c-4c20-bdbb-293922ed99ef ==============================
[0m13:14:40.268928 [info ] [MainThread]: Running with dbt=1.9.0
[0m13:14:40.268569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/usr/app/logs', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:14:40.274104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/usr/app/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:14:43.836084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b782f6b-580c-4c20-bdbb-293922ed99ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04d13b3290>]}
[0m13:14:43.838807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '87630deb-5805-4372-82dd-848ea5c447af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ab7e17d1f0>]}
[0m13:14:44.476300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c98d7a24-4b27-4f5b-9c0f-8d02c4fc5b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bc2a5a7d70>]}
[0m13:14:44.709981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '87630deb-5805-4372-82dd-848ea5c447af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ab7dec7c50>]}
[0m13:14:44.719684 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:14:44.911206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b782f6b-580c-4c20-bdbb-293922ed99ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04cf518350>]}
[0m13:14:44.937096 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:14:45.524785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c98d7a24-4b27-4f5b-9c0f-8d02c4fc5b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bc2aa05820>]}
[0m13:14:45.532126 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:14:45.754030 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:14:46.074574 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:14:46.232779 [debug] [MainThread]: checksum: c99e828bba267739642b5a3ce85f17518764ea526e0e6c4fdc649171c1a66bff, vars: {}, profile: , target: , version: 1.9.0
[0m13:14:48.085740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:14:48.089928 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:14:48.106311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:14:48.109276 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:14:48.120802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:14:48.122878 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:14:48.500463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c98d7a24-4b27-4f5b-9c0f-8d02c4fc5b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bc28d9f740>]}
[0m13:14:48.540601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87630deb-5805-4372-82dd-848ea5c447af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ab7e1b71a0>]}
[0m13:14:48.950310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b782f6b-580c-4c20-bdbb-293922ed99ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04cdc0ba70>]}
[0m13:14:49.579246 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:14:49.587422 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:14:49.669140 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:14:49.669982 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:14:50.013767 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:14:50.047468 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:14:50.308416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87630deb-5805-4372-82dd-848ea5c447af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ab7c3af350>]}
[0m13:14:50.307098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c98d7a24-4b27-4f5b-9c0f-8d02c4fc5b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bc28ac4d10>]}
[0m13:14:50.313322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b782f6b-580c-4c20-bdbb-293922ed99ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04cd900c20>]}
[0m13:14:50.314168 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:14:50.316187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c98d7a24-4b27-4f5b-9c0f-8d02c4fc5b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bc28b924e0>]}
[0m13:14:50.315295 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:14:50.313189 [info ] [MainThread]: Found 3 models, 1 source, 429 macros
[0m13:14:50.330263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b782f6b-580c-4c20-bdbb-293922ed99ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04cdbd74a0>]}
[0m13:14:50.330722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87630deb-5805-4372-82dd-848ea5c447af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ab7c3d0950>]}
[0m13:14:50.395468 [info ] [MainThread]: 
[0m13:14:50.400957 [info ] [MainThread]: 
[0m13:14:50.397848 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:14:50.417443 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:14:50.403932 [info ] [MainThread]: 
[0m13:14:50.420503 [info ] [MainThread]: 
[0m13:14:50.437959 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:14:50.436579 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:14:50.444252 [info ] [MainThread]: 
[0m13:14:50.512219 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:14:50.532427 [info ] [MainThread]: 
[0m13:14:50.540201 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:14:50.578929 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:14:50.610144 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:14:50.778443 [debug] [ThreadPool]: Acquiring new postgres connection 'list_db'
[0m13:14:52.016857 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:14:52.020066 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:14:52.022297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:52.066974 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:14:52.077183 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:14:52.079064 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:52.164818 [debug] [ThreadPool]: Using postgres connection "list_db"
[0m13:14:52.170718 [debug] [ThreadPool]: On list_db: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db"} */

    select distinct nspname from pg_namespace
  
[0m13:14:52.172686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:14:53.799789 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.720 seconds
[0m13:14:53.806161 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.633 seconds
[0m13:14:53.811288 [debug] [ThreadPool]: On list_db: Close
[0m13:14:53.814465 [debug] [ThreadPool]: On list_db: Close
[0m13:14:53.824894 [debug] [ThreadPool]: SQL status: SELECT 5 in 1.802 seconds
[0m13:14:53.842737 [debug] [ThreadPool]: On list_db: Close
[0m13:14:53.859792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m13:14:53.865207 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m13:14:53.892224 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_db, now list_db_dev)
[0m13:14:53.917651 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:14:53.921459 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m13:14:53.923408 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:14:54.038274 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:14:54.039980 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m13:14:54.041787 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:14:54.057428 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:14:54.068519 [debug] [ThreadPool]: On list_db_dev: BEGIN
[0m13:14:54.070839 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:14:54.110124 [debug] [ThreadPool]: SQL status: BEGIN in 0.187 seconds
[0m13:14:54.112578 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:14:54.118435 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:14:54.162562 [debug] [ThreadPool]: SQL status: BEGIN in 0.121 seconds
[0m13:14:54.165126 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:14:54.177630 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:14:54.321958 [debug] [ThreadPool]: SQL status: BEGIN in 0.251 seconds
[0m13:14:54.324374 [debug] [ThreadPool]: Using postgres connection "list_db_dev"
[0m13:14:54.326513 [debug] [ThreadPool]: On list_db_dev: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "list_db_dev"} */
select
      'db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
    union all
    select
      'db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'dev'
  
[0m13:14:54.688112 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.563 seconds
[0m13:14:54.689846 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.346 seconds
[0m13:14:54.705064 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m13:14:54.707934 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m13:14:54.709253 [debug] [ThreadPool]: On list_db_dev: Close
[0m13:14:54.710160 [debug] [ThreadPool]: On list_db_dev: Close
[0m13:14:54.722324 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.542 seconds
[0m13:14:54.805905 [debug] [ThreadPool]: On list_db_dev: ROLLBACK
[0m13:14:54.820356 [debug] [ThreadPool]: On list_db_dev: Close
[0m13:14:54.840231 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:54.851203 [debug] [MainThread]: On master: BEGIN
[0m13:14:54.852964 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:14:54.854538 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:54.856617 [debug] [MainThread]: On master: BEGIN
[0m13:14:54.858417 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:14:54.952786 [debug] [MainThread]: SQL status: BEGIN in 0.092 seconds
[0m13:14:54.957972 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:54.963452 [debug] [MainThread]: SQL status: BEGIN in 0.110 seconds
[0m13:14:54.965918 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:54.973860 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:54.976596 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:14:54.980014 [debug] [MainThread]: On master: BEGIN
[0m13:14:54.986751 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:14:54.993112 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:14:55.066617 [debug] [MainThread]: SQL status: BEGIN in 0.073 seconds
[0m13:14:55.068732 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:55.076275 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:14:55.153722 [debug] [MainThread]: SQL status: SELECT 0 in 0.174 seconds
[0m13:14:55.155962 [debug] [MainThread]: SQL status: SELECT 0 in 0.072 seconds
[0m13:14:55.163809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b782f6b-580c-4c20-bdbb-293922ed99ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04cd8fe540>]}
[0m13:14:55.163233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c98d7a24-4b27-4f5b-9c0f-8d02c4fc5b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bc2c434470>]}
[0m13:14:55.171190 [debug] [MainThread]: On master: ROLLBACK
[0m13:14:55.173874 [debug] [MainThread]: On master: ROLLBACK
[0m13:14:55.174356 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:55.176172 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:55.180022 [debug] [MainThread]: On master: BEGIN
[0m13:14:55.183080 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:14:55.187902 [debug] [MainThread]: SQL status: SELECT 0 in 0.198 seconds
[0m13:14:55.187898 [debug] [MainThread]: On master: COMMIT
[0m13:14:55.189787 [debug] [MainThread]: On master: BEGIN
[0m13:14:55.211389 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m13:14:55.207114 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:55.217085 [debug] [MainThread]: On master: COMMIT
[0m13:14:55.218447 [debug] [MainThread]: On master: COMMIT
[0m13:14:55.220182 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:55.224321 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:14:55.226214 [debug] [MainThread]: On master: COMMIT
[0m13:14:55.226327 [debug] [MainThread]: On master: Close
[0m13:14:55.228766 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:14:55.230797 [debug] [MainThread]: On master: Close
[0m13:14:55.238944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87630deb-5805-4372-82dd-848ea5c447af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ab7c3af4d0>]}
[0m13:14:55.245081 [debug] [MainThread]: On master: ROLLBACK
[0m13:14:55.267500 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:55.269452 [debug] [MainThread]: On master: BEGIN
[0m13:14:55.281943 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:14:55.286526 [debug] [MainThread]: On master: COMMIT
[0m13:14:55.297306 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:55.307853 [debug] [MainThread]: On master: COMMIT
[0m13:14:55.312087 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:14:55.316103 [debug] [MainThread]: On master: Close
[0m13:14:55.321278 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m13:14:55.324683 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m13:14:55.326696 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m13:14:55.327210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m13:14:55.338330 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m13:14:55.342868 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m13:14:55.353382 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m13:14:55.368998 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m13:14:55.372899 [debug] [Thread-1 (]: Began running node model.my_project.stg_weather_data
[0m13:14:55.375321 [info ] [Thread-1 (]: 1 of 3 START sql table model dev.stg_weather_data .............................. [RUN]
[0m13:14:55.393436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_db_dev, now model.my_project.stg_weather_data)
[0m13:14:55.396526 [debug] [Thread-1 (]: Began compiling node model.my_project.stg_weather_data
[0m13:14:55.463311 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m13:14:55.471996 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m13:14:55.485772 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_project.stg_weather_data"
[0m13:14:55.510607 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m13:14:55.517155 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m13:14:55.508326 [debug] [Thread-1 (]: Began executing node model.my_project.stg_weather_data
[0m13:14:55.870232 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m13:14:55.937007 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:14:55.938637 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m13:14:55.943650 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m13:14:55.945075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:55.948495 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:14:55.950339 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m13:14:55.952432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:56.063238 [debug] [Thread-1 (]: SQL status: BEGIN in 0.100 seconds
[0m13:14:56.066781 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:14:56.068888 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m13:14:56.094826 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_project.stg_weather_data"
[0m13:14:56.106084 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:14:56.115422 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: BEGIN
[0m13:14:56.121745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:14:56.125510 [debug] [Thread-1 (]: SQL status: BEGIN in 0.185 seconds
[0m13:14:56.162219 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:14:56.172983 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m13:14:56.193758 [debug] [Thread-1 (]: SQL status: BEGIN in 0.072 seconds
[0m13:14:56.196009 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:14:56.198264 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */

  
    

  create  table "db"."dev"."stg_weather_data__dbt_tmp"
  
  
    as
  
  (
    

with source as (SELECT *
FROM "db"."dev"."raw_weather_data"),

de_dup AS (
    SELECT 
    *,
    row_number() OVER(PARTITION BY TIME ORDER BY inserted_at) AS rn
    FROM source
)


SELECT
    id,
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    TIME AS weather_time_local,
    (inserted_at + (utc_offset || 'hours')::interval) AS inserted_at_local
FROM de_dup 
WHERE rn = 1
  );
  
[0m13:14:56.889082 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.706 seconds
[0m13:14:57.009691 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:14:57.016663 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m13:14:57.063246 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.041 seconds
[0m13:14:57.111014 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:14:57.115158 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m13:14:57.129605 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m13:14:57.324833 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:14:57.327835 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:14:57.338984 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:14:57.363757 [debug] [Thread-1 (]: SQL status: COMMIT in 0.022 seconds
[0m13:14:57.448279 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m13:14:57.489819 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:14:57.490996 [debug] [Thread-1 (]: SQL status: SELECT 17 in 1.272 seconds
[0m13:14:57.491728 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m13:14:57.606428 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:14:57.611484 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m13:14:57.827322 [debug] [Thread-1 (]: SQL status: SELECT 17 in 1.756 seconds
[0m13:14:56.653356 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:14:56.656528 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data" rename to "stg_weather_data__dbt_backup"
[0m13:14:56.685495 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m13:14:56.751157 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.615 seconds
[0m13:14:56.746253 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "stg_weather_data__dbt_backup" already exists

[0m13:14:56.762570 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: ROLLBACK
[0m13:14:56.799891 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m13:14:56.802163 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m13:14:56.804613 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m13:14:56.829991 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:14:56.836448 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
alter table "db"."dev"."stg_weather_data__dbt_tmp" rename to "stg_weather_data"
[0m13:14:56.838194 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m13:14:56.871749 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m13:14:57.004205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87630deb-5805-4372-82dd-848ea5c447af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ab78454140>]}
[0m13:14:57.023220 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 17[0m in 1.45s]
[0m13:14:57.074683 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m13:14:57.169799 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m13:14:57.244904 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m13:14:57.233256 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m13:14:57.250485 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m13:14:57.290749 [debug] [Thread-1 (]: Database Error in model stg_weather_data (models/staging/stg_weather_data.sql)
  relation "stg_weather_data__dbt_backup" already exists
  compiled code at target/run/my_project/models/staging/stg_weather_data.sql
[0m13:14:57.293127 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m13:14:57.294877 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m13:14:57.309703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b782f6b-580c-4c20-bdbb-293922ed99ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04ccb73c20>]}
[0m13:14:57.323609 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model dev.stg_weather_data ..................... [[31mERROR[0m in 1.97s]
[0m13:14:57.273109 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m13:14:57.338883 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m13:14:57.339932 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m13:14:57.359203 [debug] [Thread-7 (]: Marking all children of 'model.my_project.stg_weather_data' to be skipped because of status 'error'.  Reason: Database Error in model stg_weather_data (models/staging/stg_weather_data.sql)
  relation "stg_weather_data__dbt_backup" already exists
  compiled code at target/run/my_project/models/staging/stg_weather_data.sql.
[0m13:14:57.370184 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m13:14:57.377912 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m13:14:57.393651 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m13:14:57.396854 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m13:14:57.406686 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m13:14:57.399076 [info ] [Thread-3 (]: 2 of 3 SKIP relation dev.daily_average ......................................... [[33mSKIP[0m]
[0m13:14:57.420821 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m13:14:57.423901 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m13:14:57.414803 [info ] [Thread-4 (]: 3 of 3 SKIP relation dev.weather_report ........................................ [[33mSKIP[0m]
[0m13:14:57.432908 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m13:14:57.449477 [debug] [MainThread]: Using postgres connection "master"
[0m13:14:57.451473 [debug] [MainThread]: On master: BEGIN
[0m13:14:57.454513 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:14:57.493923 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m13:14:57.540601 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m13:14:57.601852 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:14:57.673276 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:14:57.678838 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m13:14:57.749841 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:14:57.700867 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m13:14:57.765114 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:14:57.784256 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:14:57.785955 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:14:57.787827 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: COMMIT
[0m13:14:57.868366 [debug] [Thread-1 (]: SQL status: COMMIT in 0.079 seconds
[0m13:14:58.189924 [debug] [Thread-1 (]: Applying DROP to: "db"."dev"."stg_weather_data__dbt_backup"
[0m13:14:58.428843 [debug] [Thread-1 (]: Using postgres connection "model.my_project.stg_weather_data"
[0m13:14:58.430919 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.stg_weather_data"} */
drop table if exists "db"."dev"."stg_weather_data__dbt_backup" cascade
[0m13:14:58.551222 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.082 seconds
[0m13:14:58.612756 [debug] [Thread-1 (]: On model.my_project.stg_weather_data: Close
[0m13:14:58.659156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c98d7a24-4b27-4f5b-9c0f-8d02c4fc5b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bc2b156930>]}
[0m13:14:58.662344 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dev.stg_weather_data ......................... [[32mSELECT 17[0m in 3.28s]
[0m13:14:58.677980 [debug] [Thread-1 (]: Finished running node model.my_project.stg_weather_data
[0m13:14:58.692454 [debug] [Thread-3 (]: Began running node model.my_project.daily_average
[0m13:14:58.712754 [info ] [Thread-3 (]: 2 of 3 START sql table model dev.daily_average ................................. [RUN]
[0m13:14:58.695201 [debug] [Thread-4 (]: Began running node model.my_project.weather_report
[0m13:14:58.725679 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.my_project.daily_average'
[0m13:14:58.754402 [debug] [Thread-3 (]: Began compiling node model.my_project.daily_average
[0m13:14:58.740826 [info ] [Thread-4 (]: 3 of 3 START sql table model dev.weather_report ................................ [RUN]
[0m13:14:58.793028 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.my_project.weather_report'
[0m13:14:58.824597 [debug] [Thread-4 (]: Began compiling node model.my_project.weather_report
[0m13:14:58.822410 [debug] [Thread-3 (]: Writing injected SQL for node "model.my_project.daily_average"
[0m13:14:58.855203 [debug] [Thread-3 (]: Began executing node model.my_project.daily_average
[0m13:14:58.906277 [debug] [Thread-4 (]: Writing injected SQL for node "model.my_project.weather_report"
[0m13:14:58.922009 [debug] [Thread-4 (]: Began executing node model.my_project.weather_report
[0m13:14:58.924533 [debug] [Thread-3 (]: Writing runtime sql for node "model.my_project.daily_average"
[0m13:14:58.941097 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:14:58.944507 [debug] [Thread-3 (]: On model.my_project.daily_average: BEGIN
[0m13:14:58.952992 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:14:58.949683 [debug] [Thread-4 (]: Writing runtime sql for node "model.my_project.weather_report"
[0m13:14:58.965383 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:14:58.968025 [debug] [Thread-4 (]: On model.my_project.weather_report: BEGIN
[0m13:14:58.973413 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:15:00.365519 [debug] [Thread-4 (]: SQL status: BEGIN in 2.601 seconds
[0m13:15:00.368768 [debug] [Thread-4 (]: SQL status: BEGIN in 1.395 seconds
[0m13:15:00.371148 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:15:00.371436 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:15:00.363680 [debug] [MainThread]: SQL status: BEGIN in 2.910 seconds
[0m13:15:00.369114 [debug] [Thread-3 (]: SQL status: BEGIN in 2.619 seconds
[0m13:15:00.374247 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m13:15:00.378640 [debug] [MainThread]: On master: COMMIT
[0m13:15:00.383362 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:15:00.381560 [debug] [Thread-3 (]: SQL status: BEGIN in 1.428 seconds
[0m13:15:00.392255 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:15:00.376275 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */

  
    

  create  table "db"."dev"."weather_report__dbt_tmp"
  
  
    as
  
  (
    

SELECT 
    city,
    temperature,
    weather_descriptions,
    wind_speed,
    weather_time_local  
FROM "db"."dev"."stg_weather_data"
  );
  
[0m13:15:00.396061 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m13:15:00.396063 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */

  
    

  create  table "db"."dev"."daily_average__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    city,
    DATE(weather_time_local) AS DATE,
    ROUND(AVG(temperature)::numeric,2) AS avg_temperature,
    ROUND(AVG(wind_speed)::numeric,2) AS avg_wind_speed
FROM "db"."dev"."stg_weather_data"
GROUP BY
    city,
    DATE(weather_time_local)
ORDER BY
    city,
    DATE(weather_time_local)
  );
  
[0m13:15:00.381293 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:00.415675 [debug] [MainThread]: On master: COMMIT
[0m13:15:00.419249 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:15:00.422017 [debug] [MainThread]: On master: Close
[0m13:15:00.444787 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:00.446629 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m13:15:00.481149 [info ] [MainThread]: 
[0m13:15:00.490588 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 10.02 seconds (10.02s).
[0m13:15:00.528752 [debug] [MainThread]: Command end result
[0m13:15:00.626512 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.240 seconds
[0m13:15:00.675061 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:15:00.686449 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m13:15:00.711131 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.019 seconds
[0m13:15:00.732181 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:15:00.735013 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m13:15:00.742992 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m13:15:00.818394 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.416 seconds
[0m13:15:00.822049 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:15:00.848484 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:15:00.851027 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:15:00.869757 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:15:00.883873 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m13:15:00.887713 [debug] [Thread-4 (]: SQL status: COMMIT in 0.018 seconds
[0m13:15:00.893444 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m13:15:00.926618 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:15:00.926968 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m13:15:00.928404 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average__dbt_tmp" rename to "daily_average"
[0m13:15:00.943719 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:15:00.944301 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:15:00.946377 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m13:15:00.961740 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:15:00.975335 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:15:00.977042 [debug] [Thread-3 (]: On model.my_project.daily_average: COMMIT
[0m13:15:01.032967 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:15:01.049763 [debug] [Thread-3 (]: SQL status: COMMIT in 0.071 seconds
[0m13:15:01.052362 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.091 seconds
[0m13:15:01.077364 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m13:15:01.089399 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:15:01.091287 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c98d7a24-4b27-4f5b-9c0f-8d02c4fc5b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bc27d465d0>]}
[0m13:15:01.093301 [debug] [Thread-4 (]: SQL status: SELECT 17 in 0.694 seconds
[0m13:15:01.125163 [debug] [Thread-3 (]: Applying DROP to: "db"."dev"."daily_average__dbt_backup"
[0m13:15:01.126235 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 17[0m in 2.30s]
[0m13:15:01.149685 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:15:01.141942 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m13:15:01.176699 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.766 seconds
[0m13:15:01.153066 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
drop table if exists "db"."dev"."daily_average__dbt_backup" cascade
[0m13:15:01.214120 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:15:01.219713 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:15:01.221514 [info ] [MainThread]: 
[0m13:15:01.234584 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:15:01.237127 [info ] [MainThread]: 
[0m13:15:01.229317 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report" rename to "weather_report__dbt_backup"
[0m13:15:01.248042 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:15:01.248973 [debug] [Thread-3 (]: Using postgres connection "model.my_project.daily_average"
[0m13:15:01.250654 [error] [MainThread]:   Database Error in model stg_weather_data (models/staging/stg_weather_data.sql)
  relation "stg_weather_data__dbt_backup" already exists
  compiled code at target/run/my_project/models/staging/stg_weather_data.sql
[0m13:15:01.251295 [debug] [Thread-3 (]: On model.my_project.daily_average: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.daily_average"} */
alter table "db"."dev"."daily_average" rename to "daily_average__dbt_backup"
[0m13:15:01.253375 [info ] [MainThread]: 
[0m13:15:01.266843 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m13:15:01.292569 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:15:01.295429 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "daily_average__dbt_backup" already exists

[0m13:15:01.321187 [debug] [Thread-3 (]: On model.my_project.daily_average: ROLLBACK
[0m13:15:01.336043 [debug] [Thread-3 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m13:15:01.338090 [debug] [Thread-3 (]: Postgres adapter: Rolling back transaction.
[0m13:15:01.340365 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m13:15:01.336480 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.134 seconds
[0m13:15:01.294521 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
alter table "db"."dev"."weather_report__dbt_tmp" rename to "weather_report"
[0m13:15:01.377452 [debug] [Thread-3 (]: On model.my_project.daily_average: Close
[0m13:15:01.380218 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:15:01.396070 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87630deb-5805-4372-82dd-848ea5c447af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ab7b603830>]}
[0m13:15:01.412664 [info ] [Thread-3 (]: 2 of 3 OK created sql table model dev.daily_average ............................ [[32mSELECT 3[0m in 4.12s]
[0m13:15:01.409097 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:15:01.422577 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m13:15:01.444483 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:15:01.462438 [debug] [Thread-4 (]: On model.my_project.weather_report: COMMIT
[0m13:15:01.516007 [debug] [Thread-4 (]: SQL status: COMMIT in 0.025 seconds
[0m13:15:01.544463 [debug] [Thread-4 (]: Applying DROP to: "db"."dev"."weather_report__dbt_backup"
[0m13:15:01.557779 [debug] [Thread-4 (]: Using postgres connection "model.my_project.weather_report"
[0m13:15:01.559807 [debug] [Thread-4 (]: On model.my_project.weather_report: /* {"app": "dbt", "dbt_version": "1.9.0", "profile_name": "my_project", "target_name": "dev", "node_id": "model.my_project.weather_report"} */
drop table if exists "db"."dev"."weather_report__dbt_backup" cascade
[0m13:15:01.578495 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 23.544865, "process_in_blocks": "52704", "process_kernel_time": 8.060698, "process_mem_max_rss": "95540", "process_out_blocks": "3352", "process_user_time": 17.984505}
[0m13:15:01.600821 [debug] [Thread-3 (]: Database Error in model daily_average (models/mart/daily_average.sql)
  relation "daily_average__dbt_backup" already exists
  compiled code at target/run/my_project/models/mart/daily_average.sql
[0m13:15:01.604142 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c98d7a24-4b27-4f5b-9c0f-8d02c4fc5b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bc27cfbdd0>]}
[0m13:15:01.615842 [error] [Thread-3 (]: 2 of 3 ERROR creating sql table model dev.daily_average ........................ [[31mERROR[0m in 2.88s]
[0m13:15:01.620957 [debug] [Thread-3 (]: Finished running node model.my_project.daily_average
[0m13:15:01.624310 [debug] [Thread-7 (]: Marking all children of 'model.my_project.daily_average' to be skipped because of status 'error'.  Reason: Database Error in model daily_average (models/mart/daily_average.sql)
  relation "daily_average__dbt_backup" already exists
  compiled code at target/run/my_project/models/mart/daily_average.sql.
[0m13:15:01.628601 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.052 seconds
[0m13:15:01.693731 [debug] [Thread-4 (]: On model.my_project.weather_report: Close
[0m13:15:01.733653 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87630deb-5805-4372-82dd-848ea5c447af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ab78434e30>]}
[0m13:15:01.742737 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:01.759664 [debug] [MainThread]: On master: BEGIN
[0m13:15:01.761558 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:15:01.760872 [info ] [Thread-4 (]: 3 of 3 OK created sql table model dev.weather_report ........................... [[32mSELECT 17[0m in 4.44s]
[0m13:15:01.733661 [debug] [MainThread]: Command `dbt run` failed at 13:15:01.732610 after 23.80 seconds
[0m13:15:01.764864 [debug] [Thread-4 (]: Finished running node model.my_project.weather_report
[0m13:15:01.770560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04cd8c67e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04cdb87b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e04cf3c0cb0>]}
[0m13:15:01.808924 [debug] [MainThread]: Flushing usage events
[0m13:15:01.808001 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:01.840658 [debug] [MainThread]: On master: BEGIN
[0m13:15:01.844060 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:15:02.084565 [debug] [MainThread]: SQL status: BEGIN in 0.310 seconds
[0m13:15:02.086430 [debug] [MainThread]: On master: COMMIT
[0m13:15:02.085997 [debug] [MainThread]: SQL status: BEGIN in 0.242 seconds
[0m13:15:02.097506 [debug] [MainThread]: On master: COMMIT
[0m13:15:02.100077 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:02.102181 [debug] [MainThread]: On master: COMMIT
[0m13:15:02.110862 [debug] [MainThread]: SQL status: COMMIT in 0.007 seconds
[0m13:15:02.114610 [debug] [MainThread]: On master: Close
[0m13:15:02.116603 [debug] [MainThread]: Using postgres connection "master"
[0m13:15:02.117320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:02.118135 [debug] [MainThread]: On master: COMMIT
[0m13:15:02.118740 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m13:15:02.136180 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:15:02.138361 [debug] [MainThread]: On master: Close
[0m13:15:02.152809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:02.154336 [debug] [MainThread]: Connection 'model.my_project.stg_weather_data' was properly closed.
[0m13:15:02.126828 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m13:15:02.169089 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m13:15:02.155818 [debug] [MainThread]: Connection 'model.my_project.daily_average' was properly closed.
[0m13:15:02.188814 [debug] [MainThread]: Connection 'model.my_project.weather_report' was properly closed.
[0m13:15:02.188438 [info ] [MainThread]: 
[0m13:15:02.203625 [info ] [MainThread]: 
[0m13:15:02.196650 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 11.63 seconds (11.63s).
[0m13:15:02.210334 [debug] [MainThread]: Command end result
[0m13:15:02.206282 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 11.76 seconds (11.76s).
[0m13:15:02.257472 [debug] [MainThread]: Command end result
[0m13:15:02.451889 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:15:02.492659 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:15:02.616413 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:15:02.617852 [info ] [MainThread]: 
[0m13:15:02.620157 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:15:02.651979 [info ] [MainThread]: 
[0m13:15:02.654114 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:15:02.681265 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 24.59626, "process_in_blocks": "48976", "process_kernel_time": 7.490674, "process_mem_max_rss": "95408", "process_out_blocks": "3408", "process_user_time": 18.677622}
[0m13:15:02.710901 [debug] [MainThread]: Command `dbt run` succeeded at 13:15:02.710062 after 24.63 seconds
[0m13:15:02.700909 [debug] [MainThread]: Wrote artifact WritableManifest to /usr/app/target/manifest.json
[0m13:15:02.730007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ab7e203ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ab7e8cd6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ab7e17d670>]}
[0m13:15:02.743899 [debug] [MainThread]: Flushing usage events
[0m13:15:02.747243 [debug] [MainThread]: Wrote artifact SemanticManifest to /usr/app/target/semantic_manifest.json
[0m13:15:02.851236 [debug] [MainThread]: Wrote artifact RunExecutionResult to /usr/app/target/run_results.json
[0m13:15:02.853649 [info ] [MainThread]: 
[0m13:15:02.866715 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:15:02.868984 [info ] [MainThread]: 
[0m13:15:02.882219 [error] [MainThread]:   Database Error in model daily_average (models/mart/daily_average.sql)
  relation "daily_average__dbt_backup" already exists
  compiled code at target/run/my_project/models/mart/daily_average.sql
[0m13:15:02.885232 [info ] [MainThread]: 
[0m13:15:02.899706 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:15:02.917082 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 24.906435, "process_in_blocks": "44520", "process_kernel_time": 8.03858, "process_mem_max_rss": "95344", "process_out_blocks": "2736", "process_user_time": 18.847439}
[0m13:15:02.942349 [debug] [MainThread]: Command `dbt run` failed at 13:15:02.941407 after 24.93 seconds
[0m13:15:02.947781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bc2aa2d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bc2a823830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79bc2b1742c0>]}
[0m13:15:02.949919 [debug] [MainThread]: Flushing usage events
[0m13:15:08.775365 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:15:08.775365 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:15:08.775798 [debug] [MainThread]: An error was encountered while trying to flush usage events
